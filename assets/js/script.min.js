$(document).ready(function(){var e=$(".work"),i=($(".hire"),!0),n=null;$(this).on("mousewheel DOMMouseScroll",function(e){if(!$(".outer-nav").hasClass("is-vis")){e.preventDefault();var t=e.originalEvent.wheelDelta?-e.originalEvent.wheelDelta:20*e.originalEvent.detail;t>50&&i?(i=!1,clearTimeout(n),n=setTimeout(function(){i=!0},1e3),d(1)):t<-50&&i&&(i=!1,clearTimeout(n),n=setTimeout(function(){i=!0},1e3),d(-1))}}),$(".side-nav li, .outer-nav li").click(function(){if(!$(this).hasClass("is-active")){var e=$(this),i=e.parent().find(".is-active"),n=e.parent().children().index(i),t=e.parent().children().index(e),r=$(this).parent().children().length-1;c(t),v(n,t,r)}}),$(".cta").click(function(){var e=$(".side-nav").find(".is-active"),i=$(".side-nav").children().index(e),n=$(".side-nav").children().length-1,t=n;c(n),v(i,t,n)});var t,r,o,s,a=document.getElementById("viewport"),l=new Hammer(a);function d(e){var i=$(".side-nav").find(".is-active"),n=$(".side-nav").children().index(i),t=$(".side-nav").children().length-1,r=0;"swipeup"===e.type||40===e.keyCode||e>0?n!==t?(c(r=n+1),v(n,r,t)):(c(r),v(n,r,t)):("swipedown"===e.type||38===e.keyCode||e<0)&&(0!==n?(c(r=n-1),v(n,r,t)):(c(r=t),v(n,r,t)))}function c(e){$(".side-nav, .outer-nav").children().removeClass("is-active"),$(".side-nav").children().eq(e).addClass("is-active"),$(".outer-nav").children().eq(e).addClass("is-active")}function v(e,i,n){$(".main-content").children().removeClass("section--is-active"),$(".main-content").children().eq(i).addClass("section--is-active"),$(".main-content .section").children().removeClass("section--next section--prev"),e===n&&0===i||0===e&&i===n?$(".main-content .section").children().removeClass("section--next section--prev"):e<i?$(".main-content").children().eq(e).children().addClass("section--next"):$(".main-content").children().eq(e).children().addClass("section--prev"),0!==i&&i!==n?$(".header--cta").addClass("is-active"):$(".header--cta").removeClass("is-active")}l.get("swipe").set({direction:Hammer.DIRECTION_VERTICAL}),l.on("swipeup swipedown",function(e){d(e)}),$(document).keyup(function(e){$(".outer-nav").hasClass("is-vis")||(e.preventDefault(),d(e))}),$(".header--nav-toggle").click(function(){$(".perspective").addClass("perspective--modalview"),setTimeout(function(){$(".perspective").addClass("effect-rotate-left--animate")},25),$(".outer-nav, .outer-nav li, .outer-nav--return").addClass("is-vis")}),$(".outer-nav--return, .outer-nav li").click(function(){$(".perspective").removeClass("effect-rotate-left--animate"),setTimeout(function(){$(".perspective").removeClass("perspective--modalview")},400),$(".outer-nav, .outer-nav li, .outer-nav--return").removeClass("is-vis")}),function(){var i,n=e.find(".outer-slider"),t=e.find(".inner-slider"),r=e.find(".inner-slider__nav--prev"),o=e.find(".inner-slider__nav--next"),s=e.find(".outer-slider__controls"),a=e.find(".outer-slider__nav--prev"),l=e.find(".outer-slider__nav--next"),d=new Swiper(n,{init:!1,loop:!0,loopedSlides:4,slidesPerView:"auto",centeredSlides:!0,normalizeSlideIndex:!0,direction:"vertical",allowTouchMove:!1,effect:"slide",normalizeSlideIndex:!0,controller:{by:"slide"}});d.on("init",function(){console.log("swiper initialized"),i=d.activeIndex,console.log("currentInnerSwiperIndex: "+i)}),d.init();var c,v,u=new Swiper(s,{effect:"slide",normalizeSlideIndex:!0,direction:"horizontal",centeredSlides:!0,loop:!0,loopedSlides:4,slidesPerView:"auto",spaceBetween:35,touchRatio:.2,slideToClickedSlide:!0,normalizeSlideIndex:!0,navigation:{nextEl:l,prevEl:a},controller:{by:"slide"},breakpoints:{700:{slidesPerView:"auto",spaceBetween:0}}});u.controller.control=d,d.controller.control=u,new Swiper(t,{direction:"horizontal",loop:!0,spaceBetween:0,slidesPerView:"auto",loopedSlides:7,loopAdditionalSlides:10,centeredSlides:!0,spaceBetween:0,effect:"coverflow",coverflowEffect:{rotate:40,stretch:0,depth:100,modifier:1,slideShadows:!0},normalizeSlideIndex:!0,slideToClickedSlide:!0}),o.add(r).on("click touchstart",function(e){var n=$(this);if("touchstart"==e.type&&(c=!0,setTimeout(function(){c=!1},400)),!c||"click"!=e.type){var t=d.slides[i],r=$(t).find(".inner-slider")[0];r.swiper,n.hasClass("inner-slider__prev")?r.swiper.slidePrev(400):r.swiper.slideNext(400)}}),d.on("transitionEnd",function(){v||(v=!0,console.log("changed"),i=d.activeIndex,console.log("currentInnerSwiperIndex: "+i),window.setTimeout(function(){v=void 0},200))})}(),$(".work-request--information input").focusout(function(){""===$(this).val()?$(this).removeClass("has-value"):$(this).addClass("has-value"),window.scrollTo(0,0)}),t=$("#startProjectForm"),$("#nameSP"),r=$("#emailSP"),o=$("#service-web"),s=o.closest(".work-request--services"),t.parsley({requiredMessage:"This field is required"}),r.parsley({typeMessage:"Enter a valid e-mail address"}),o.parsley({requiredMessage:"Please select the digital service/s you want us to work on",errorsContainer:function(e){return s},classHandler:function(e){return s}}),t.parsley().on("form:error",function(){alert("validation errors")}).on("form:submit",function(e){return console.log("Form Submitted"),!1})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyJdLCJuYW1lcyI6WyIkIiwiZG9jdW1lbnQiLCJyZWFkeSIsIndvcmsiLCJjYW5TY3JvbGwiLCJzY3JvbGxDb250cm9sbGVyIiwidGhpcyIsIm9uIiwiZSIsImhhc0NsYXNzIiwicHJldmVudERlZmF1bHQiLCJkZWx0YSIsIm9yaWdpbmFsRXZlbnQiLCJ3aGVlbERlbHRhIiwiZGV0YWlsIiwiY2xlYXJUaW1lb3V0Iiwic2V0VGltZW91dCIsInVwZGF0ZUhlbHBlciIsImNsaWNrIiwiJHRoaXMiLCJjdXJBY3RpdmUiLCJwYXJlbnQiLCJmaW5kIiwiY3VyUG9zIiwiY2hpbGRyZW4iLCJpbmRleCIsIm5leHRQb3MiLCJsYXN0SXRlbSIsImxlbmd0aCIsInVwZGF0ZU5hdnMiLCJ1cGRhdGVDb250ZW50Iiwic3RhcnRQcm9qZWN0Rm9ybSIsImVtYWlsRmllbGQiLCJ3ZWJTZXJ2aWNlRmllbGQiLCJzZXJ2aWNlc0NvbnQiLCJ0YXJnZXRFbGVtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJtYyIsIkhhbW1lciIsInBhcmFtIiwidHlwZSIsImtleUNvZGUiLCJyZW1vdmVDbGFzcyIsImVxIiwiYWRkQ2xhc3MiLCJnZXQiLCJzZXQiLCJkaXJlY3Rpb24iLCJESVJFQ1RJT05fVkVSVElDQUwiLCJrZXl1cCIsImN1cnJlbnRJbm5lclN3aXBlckluZGV4Iiwib3V0ZXJTbGlkZXIiLCJpbm5lclNsaWRlciIsImlubmVyU2xpZGVyUHJldkJ0biIsImlubmVyU2xpZGVyTmV4dEJ0biIsIm91dGVyU2xpZGVyQ29udHJvbHMiLCJvdXRlclNsaWRlclByZXZCdG4iLCJvdXRlclNsaWRlck5leHRCdG4iLCJvdXRlclN3aXBlciIsIlN3aXBlciIsImluaXQiLCJsb29wIiwibG9vcGVkU2xpZGVzIiwic2xpZGVzUGVyVmlldyIsImNlbnRlcmVkU2xpZGVzIiwibm9ybWFsaXplU2xpZGVJbmRleCIsImFsbG93VG91Y2hNb3ZlIiwiZWZmZWN0IiwiY29udHJvbGxlciIsImJ5IiwiY29uc29sZSIsImxvZyIsImFjdGl2ZUluZGV4IiwidG91Y2giLCJvdXRlclN3aXBlclRyaWdnZXIiLCJvdXRlclN3aXBlckNvbnRyb2xzIiwic3BhY2VCZXR3ZWVuIiwidG91Y2hSYXRpbyIsInNsaWRlVG9DbGlja2VkU2xpZGUiLCJuYXZpZ2F0aW9uIiwibmV4dEVsIiwicHJldkVsIiwiYnJlYWtwb2ludHMiLCI3MDAiLCJjb250cm9sIiwibG9vcEFkZGl0aW9uYWxTbGlkZXMiLCJjb3ZlcmZsb3dFZmZlY3QiLCJyb3RhdGUiLCJzdHJldGNoIiwiZGVwdGgiLCJtb2RpZmllciIsInNsaWRlU2hhZG93cyIsImFkZCIsImN1cklubmVyU3dpcGVyQ29udCIsInNsaWRlcyIsImN1cklubmVyU3dpcGVyIiwic3dpcGVyIiwic2xpZGVQcmV2Iiwic2xpZGVOZXh0Iiwid2luZG93IiwidW5kZWZpbmVkIiwid29ya1NsaWRlciIsImZvY3Vzb3V0IiwidmFsIiwic2Nyb2xsVG8iLCJjbG9zZXN0IiwicGFyc2xleSIsInJlcXVpcmVkTWVzc2FnZSIsInR5cGVNZXNzYWdlIiwiZXJyb3JzQ29udGFpbmVyIiwiRmllbGQiLCJjbGFzc0hhbmRsZXIiLCJhbGVydCJdLCJtYXBwaW5ncyI6IkFBRUFBLEVBQUFDLFVBQUFDLE1BQUEsV0FFQSxJQUFBQyxFQUFBSCxFQUFBLFNBSUFJLEdBSEFKLEVBQUEsVUFHQSxHQUNBSyxFQUFBLEtBQ0FMLEVBQUFNLE1BQUFDLEdBQUEsNEJBQUEsU0FBQUMsR0FFQSxJQUFBUixFQUFBLGNBQUFTLFNBQUEsVUFBQSxDQUVBRCxFQUFBRSxpQkFFQSxJQUFBQyxFQUFBSCxFQUFBSSxjQUFBLFlBQUFKLEVBQUFJLGNBQUFDLFdBQUEsR0FBQUwsRUFBQUksY0FBQUUsT0FFQUgsRUFBQSxJQUFBUCxHQUNBQSxHQUFBLEVBQ0FXLGFBQUFWLEdBQ0FBLEVBQUFXLFdBQUEsV0FDQVosR0FBQSxHQUNBLEtBQ0FhLEVBQUEsSUFFQU4sR0FBQSxJQUFBUCxJQUNBQSxHQUFBLEVBQ0FXLGFBQUFWLEdBQ0FBLEVBQUFXLFdBQUEsV0FDQVosR0FBQSxHQUNBLEtBQ0FhLEdBQUEsT0FPQWpCLEVBQUEsK0JBQUFrQixNQUFBLFdBRUEsSUFBQWxCLEVBQUFNLE1BQUFHLFNBQUEsYUFBQSxDQUVBLElBQUFVLEVBQUFuQixFQUFBTSxNQUNBYyxFQUFBRCxFQUFBRSxTQUFBQyxLQUFBLGNBQ0FDLEVBQUFKLEVBQUFFLFNBQUFHLFdBQUFDLE1BQUFMLEdBQ0FNLEVBQUFQLEVBQUFFLFNBQUFHLFdBQUFDLE1BQUFOLEdBQ0FRLEVBQUEzQixFQUFBTSxNQUFBZSxTQUFBRyxXQUFBSSxPQUFBLEVBRUFDLEVBQUFILEdBQ0FJLEVBQUFQLEVBQUFHLEVBQUFDLE1BTUEzQixFQUFBLFFBQUFrQixNQUFBLFdBRUEsSUFBQUUsRUFBQXBCLEVBQUEsYUFBQXNCLEtBQUEsY0FDQUMsRUFBQXZCLEVBQUEsYUFBQXdCLFdBQUFDLE1BQUFMLEdBQ0FPLEVBQUEzQixFQUFBLGFBQUF3QixXQUFBSSxPQUFBLEVBQ0FGLEVBQUFDLEVBRUFFLEVBQUFGLEdBQ0FHLEVBQUFQLEVBQUFHLEVBQUFDLEtBS0EsSUErVEFJLEVBR0FDLEVBQ0FDLEVBQ0FDLEVBcFVBQyxFQUFBbEMsU0FBQW1DLGVBQUEsWUFDQUMsRUFBQSxJQUFBQyxPQUFBSCxHQWtCQSxTQUFBbEIsRUFBQXNCLEdBRUEsSUFBQW5CLEVBQUFwQixFQUFBLGFBQUFzQixLQUFBLGNBQ0FDLEVBQUF2QixFQUFBLGFBQUF3QixXQUFBQyxNQUFBTCxHQUNBTyxFQUFBM0IsRUFBQSxhQUFBd0IsV0FBQUksT0FBQSxFQUNBRixFQUFBLEVBRUEsWUFBQWEsRUFBQUMsTUFBQSxLQUFBRCxFQUFBRSxTQUFBRixFQUFBLEVBQ0FoQixJQUFBSSxHQUVBRSxFQURBSCxFQUFBSCxFQUFBLEdBRUFPLEVBQUFQLEVBQUFHLEVBQUFDLEtBR0FFLEVBQUFILEdBQ0FJLEVBQUFQLEVBQUFHLEVBQUFDLEtBR0EsY0FBQVksRUFBQUMsTUFBQSxLQUFBRCxFQUFBRSxTQUFBRixFQUFBLEtBQ0EsSUFBQWhCLEdBRUFNLEVBREFILEVBQUFILEVBQUEsR0FFQU8sRUFBQVAsRUFBQUcsRUFBQUMsS0FJQUUsRUFEQUgsRUFBQUMsR0FFQUcsRUFBQVAsRUFBQUcsRUFBQUMsS0FPQSxTQUFBRSxFQUFBSCxHQUVBMUIsRUFBQSx5QkFBQXdCLFdBQUFrQixZQUFBLGFBQ0ExQyxFQUFBLGFBQUF3QixXQUFBbUIsR0FBQWpCLEdBQUFrQixTQUFBLGFBQ0E1QyxFQUFBLGNBQUF3QixXQUFBbUIsR0FBQWpCLEdBQUFrQixTQUFBLGFBS0EsU0FBQWQsRUFBQVAsRUFBQUcsRUFBQUMsR0FFQTNCLEVBQUEsaUJBQUF3QixXQUFBa0IsWUFBQSxzQkFDQTFDLEVBQUEsaUJBQUF3QixXQUFBbUIsR0FBQWpCLEdBQUFrQixTQUFBLHNCQUNBNUMsRUFBQSwwQkFBQXdCLFdBQUFrQixZQUFBLCtCQUVBbkIsSUFBQUksR0FBQSxJQUFBRCxHQUFBLElBQUFILEdBQUFHLElBQUFDLEVBQ0EzQixFQUFBLDBCQUFBd0IsV0FBQWtCLFlBQUEsK0JBRUFuQixFQUFBRyxFQUNBMUIsRUFBQSxpQkFBQXdCLFdBQUFtQixHQUFBcEIsR0FBQUMsV0FBQW9CLFNBQUEsaUJBR0E1QyxFQUFBLGlCQUFBd0IsV0FBQW1CLEdBQUFwQixHQUFBQyxXQUFBb0IsU0FBQSxpQkFHQSxJQUFBbEIsR0FBQUEsSUFBQUMsRUFDQTNCLEVBQUEsZ0JBQUE0QyxTQUFBLGFBR0E1QyxFQUFBLGdCQUFBMEMsWUFBQSxhQWhGQUwsRUFBQVEsSUFBQSxTQUFBQyxLQUFBQyxVQUFBVCxPQUFBVSxxQkFDQVgsRUFBQTlCLEdBQUEsb0JBQUEsU0FBQUMsR0FFQVMsRUFBQVQsS0FJQVIsRUFBQUMsVUFBQWdELE1BQUEsU0FBQXpDLEdBRUFSLEVBQUEsY0FBQVMsU0FBQSxZQUNBRCxFQUFBRSxpQkFDQU8sRUFBQVQsTUE0RUFSLEVBQUEsdUJBQUFrQixNQUFBLFdBRUFsQixFQUFBLGdCQUFBNEMsU0FBQSwwQkFDQTVCLFdBQUEsV0FDQWhCLEVBQUEsZ0JBQUE0QyxTQUFBLGdDQUNBLElBQ0E1QyxFQUFBLGlEQUFBNEMsU0FBQSxZQUlBNUMsRUFBQSxxQ0FBQWtCLE1BQUEsV0FFQWxCLEVBQUEsZ0JBQUEwQyxZQUFBLCtCQUNBMUIsV0FBQSxXQUNBaEIsRUFBQSxnQkFBQTBDLFlBQUEsMkJBQ0EsS0FDQTFDLEVBQUEsaURBQUEwQyxZQUFBLFlBTUEsV0FDQSxJQTZDQVEsRUEzQ0FDLEVBQUFoRCxFQUFBbUIsS0FBQSxpQkFJQThCLEVBQUFqRCxFQUFBbUIsS0FBQSxpQkFFQStCLEVBQUFsRCxFQUFBbUIsS0FBQSw0QkFDQWdDLEVBQUFuRCxFQUFBbUIsS0FBQSw0QkFFQWlDLEVBQUFwRCxFQUFBbUIsS0FBQSwyQkFFQWtDLEVBQUFyRCxFQUFBbUIsS0FBQSw0QkFDQW1DLEVBQUF0RCxFQUFBbUIsS0FBQSw0QkFLQW9DLEVBQUEsSUFBQUMsT0FBQVIsR0FDQVMsTUFBQSxFQUNBQyxNQUFBLEVBQ0FDLGFBQUEsRUFDQUMsY0FBQSxPQUNBQyxnQkFBQSxFQUNBQyxxQkFBQSxFQUNBbEIsVUFBQSxXQUNBbUIsZ0JBQUEsRUFDQUMsT0FBQSxRQUNBRixxQkFBQSxFQUlBRyxZQUNBQyxHQUFBLFdBWUFYLEVBQUFuRCxHQUFBLE9BQUEsV0FDQStELFFBQUFDLElBQUEsc0JBQ0FyQixFQUFBUSxFQUFBYyxZQUNBRixRQUFBQyxJQUFBLDRCQUFBckIsS0FHQVEsRUFBQUUsT0FFQSxJQW9FQWEsRUFxQ0FDLEVBekdBQyxFQUFBLElBQUFoQixPQUFBSixHQUNBWSxPQUFBLFFBQ0FGLHFCQUFBLEVBQ0FsQixVQUFBLGFBQ0FpQixnQkFBQSxFQUNBSCxNQUFBLEVBQ0FDLGFBQUEsRUFDQUMsY0FBQSxPQUNBYSxhQUFBLEdBQ0FDLFdBQUEsR0FDQUMscUJBQUEsRUFDQWIscUJBQUEsRUFDQWMsWUFDQUMsT0FBQXZCLEVBQ0F3QixPQUFBekIsR0FFQVksWUFDQUMsR0FBQSxTQUVBYSxhQUNBQyxLQUNBcEIsY0FBQSxPQUNBYSxhQUFBLE1BU0FELEVBQUFQLFdBQUFnQixRQUFBMUIsRUFDQUEsRUFBQVUsV0FBQWdCLFFBQUFULEVBSUEsSUFBQWhCLE9BQUFQLEdBRUFMLFVBQUEsYUFDQWMsTUFBQSxFQUNBZSxhQUFBLEVBRUFiLGNBQUEsT0FDQUQsYUFBQSxFQUNBdUIscUJBQUEsR0FDQXJCLGdCQUFBLEVBQ0FZLGFBQUEsRUFFQVQsT0FBQSxZQUVBbUIsaUJBQ0FDLE9BQUEsR0FDQUMsUUFBQSxFQUNBQyxNQUFBLElBQ0FDLFNBQUEsRUFDQUMsY0FBQSxHQUVBMUIscUJBQUEsRUFDQWEscUJBQUEsSUFXQXhCLEVBQUFzQyxJQUFBdkMsR0FBQTlDLEdBQUEsbUJBQUEsU0FBQUMsR0FDQSxJQUFBVyxFQUFBbkIsRUFBQU0sTUFXQSxHQVRBLGNBQUFFLEVBQUFnQyxPQUNBaUMsR0FBQSxFQUVBekQsV0FBQSxXQUNBeUQsR0FBQSxHQUNBLE9BSUFBLEdBQUEsU0FBQWpFLEVBQUFnQyxLQUFBLENBSUEsSUFBQXFELEVBQUFuQyxFQUFBb0MsT0FBQTVDLEdBQ0E2QyxFQUFBL0YsRUFBQTZGLEdBQUF2RSxLQUFBLGlCQUFBLEdBQ0F5RSxFQUFBQyxPQUVBN0UsRUFBQVYsU0FBQSxzQkFDQXNGLEVBQUFDLE9BQUFDLFVBQUEsS0FFQUYsRUFBQUMsT0FBQUUsVUFBQSxRQWNBeEMsRUFBQW5ELEdBQUEsZ0JBQUEsV0FFQW1FLElBR0FBLEdBQUEsRUFHQUosUUFBQUMsSUFBQSxXQUVBckIsRUFBQVEsRUFBQWMsWUFDQUYsUUFBQUMsSUFBQSw0QkFBQXJCLEdBR0FpRCxPQUFBbkYsV0FBQSxXQUNBMEQsT0FBQTBCLEdBaEJBLFFBc0dBQyxHQXpFQXJHLEVBQUEsb0NBQUFzRyxTQUFBLFdBSUEsS0FGQXRHLEVBQUFNLE1BQUFpRyxNQUdBdkcsRUFBQU0sTUFBQW9DLFlBQUEsYUFHQTFDLEVBQUFNLE1BQUFzQyxTQUFBLGFBSUF1RCxPQUFBSyxTQUFBLEVBQUEsS0FPQXpFLEVBQUEvQixFQUFBLHFCQUVBQSxFQUFBLFdBQ0FnQyxFQUFBaEMsRUFBQSxZQUNBaUMsRUFBQWpDLEVBQUEsZ0JBQ0FrQyxFQUFBRCxFQUFBd0UsUUFBQSwyQkFLQTFFLEVBQUEyRSxTQUNBQyxnQkFBQSwyQkFJQTNFLEVBQUEwRSxTQUNBRSxZQUFBLGlDQUdBM0UsRUFBQXlFLFNBQ0FDLGdCQUFBLDZEQUNBRSxnQkFBQSxTQUFBQyxHQUVBLE9BQUE1RSxHQUVBNkUsYUFBQSxTQUFBRCxHQUNBLE9BQUE1RSxLQU9BSCxFQUFBMkUsVUFBQW5HLEdBQUEsYUFBQSxXQUVBeUcsTUFBQSx1QkFFQXpHLEdBQUEsY0FBQSxTQUFBQyxHQVFBLE9BTkE4RCxRQUFBQyxJQUFBLG1CQU1BIiwiZmlsZSI6InNjcmlwdC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBAY29kZWtpdC1wcmVwZW5kIFwiL3ZlbmRvci9oYW1tZXItMi4wLjguanNcIjtcclxuXHJcbiQoIGRvY3VtZW50ICkucmVhZHkoZnVuY3Rpb24oKSB7XHJcblxyXG4gIHZhciB3b3JrID0gJCgnLndvcmsnKTtcclxuICB2YXIgaGlyZSA9ICQoJy5oaXJlJyk7XHJcblxyXG4gIC8vIERPTU1vdXNlU2Nyb2xsIGluY2x1ZGVkIGZvciBmaXJlZm94IHN1cHBvcnRcclxuICB2YXIgY2FuU2Nyb2xsID0gdHJ1ZSxcclxuICAgICAgc2Nyb2xsQ29udHJvbGxlciA9IG51bGw7XHJcbiAgJCh0aGlzKS5vbignbW91c2V3aGVlbCBET01Nb3VzZVNjcm9sbCcsIGZ1bmN0aW9uKGUpe1xyXG5cclxuICAgIGlmICghKCQoJy5vdXRlci1uYXYnKS5oYXNDbGFzcygnaXMtdmlzJykpKSB7XHJcblxyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgICB2YXIgZGVsdGEgPSAoZS5vcmlnaW5hbEV2ZW50LndoZWVsRGVsdGEpID8gLWUub3JpZ2luYWxFdmVudC53aGVlbERlbHRhIDogZS5vcmlnaW5hbEV2ZW50LmRldGFpbCAqIDIwO1xyXG5cclxuICAgICAgaWYgKGRlbHRhID4gNTAgJiYgY2FuU2Nyb2xsKSB7XHJcbiAgICAgICAgY2FuU2Nyb2xsID0gZmFsc2U7XHJcbiAgICAgICAgY2xlYXJUaW1lb3V0KHNjcm9sbENvbnRyb2xsZXIpO1xyXG4gICAgICAgIHNjcm9sbENvbnRyb2xsZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICBjYW5TY3JvbGwgPSB0cnVlO1xyXG4gICAgICAgIH0sIDEwMDApO1xyXG4gICAgICAgIHVwZGF0ZUhlbHBlcigxKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIGlmIChkZWx0YSA8IC01MCAmJiBjYW5TY3JvbGwpIHtcclxuICAgICAgICBjYW5TY3JvbGwgPSBmYWxzZTtcclxuICAgICAgICBjbGVhclRpbWVvdXQoc2Nyb2xsQ29udHJvbGxlcik7XHJcbiAgICAgICAgc2Nyb2xsQ29udHJvbGxlciA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgIGNhblNjcm9sbCA9IHRydWU7XHJcbiAgICAgICAgfSwgMTAwMCk7XHJcbiAgICAgICAgdXBkYXRlSGVscGVyKC0xKTtcclxuICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgfSk7XHJcblxyXG4gICQoJy5zaWRlLW5hdiBsaSwgLm91dGVyLW5hdiBsaScpLmNsaWNrKGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgaWYgKCEoJCh0aGlzKS5oYXNDbGFzcygnaXMtYWN0aXZlJykpKSB7XHJcblxyXG4gICAgICB2YXIgJHRoaXMgPSAkKHRoaXMpLFxyXG4gICAgICAgICAgY3VyQWN0aXZlID0gJHRoaXMucGFyZW50KCkuZmluZCgnLmlzLWFjdGl2ZScpLFxyXG4gICAgICAgICAgY3VyUG9zID0gJHRoaXMucGFyZW50KCkuY2hpbGRyZW4oKS5pbmRleChjdXJBY3RpdmUpLFxyXG4gICAgICAgICAgbmV4dFBvcyA9ICR0aGlzLnBhcmVudCgpLmNoaWxkcmVuKCkuaW5kZXgoJHRoaXMpLFxyXG4gICAgICAgICAgbGFzdEl0ZW0gPSAkKHRoaXMpLnBhcmVudCgpLmNoaWxkcmVuKCkubGVuZ3RoIC0gMTtcclxuXHJcbiAgICAgIHVwZGF0ZU5hdnMobmV4dFBvcyk7XHJcbiAgICAgIHVwZGF0ZUNvbnRlbnQoY3VyUG9zLCBuZXh0UG9zLCBsYXN0SXRlbSk7XHJcblxyXG4gICAgfVxyXG5cclxuICB9KTtcclxuXHJcbiAgJCgnLmN0YScpLmNsaWNrKGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgdmFyIGN1ckFjdGl2ZSA9ICQoJy5zaWRlLW5hdicpLmZpbmQoJy5pcy1hY3RpdmUnKSxcclxuICAgICAgICBjdXJQb3MgPSAkKCcuc2lkZS1uYXYnKS5jaGlsZHJlbigpLmluZGV4KGN1ckFjdGl2ZSksXHJcbiAgICAgICAgbGFzdEl0ZW0gPSAkKCcuc2lkZS1uYXYnKS5jaGlsZHJlbigpLmxlbmd0aCAtIDEsXHJcbiAgICAgICAgbmV4dFBvcyA9IGxhc3RJdGVtO1xyXG5cclxuICAgIHVwZGF0ZU5hdnMobGFzdEl0ZW0pO1xyXG4gICAgdXBkYXRlQ29udGVudChjdXJQb3MsIG5leHRQb3MsIGxhc3RJdGVtKTtcclxuXHJcbiAgfSk7XHJcblxyXG4gIC8vIHN3aXBlIHN1cHBvcnQgZm9yIHRvdWNoIGRldmljZXNcclxuICB2YXIgdGFyZ2V0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2aWV3cG9ydCcpLFxyXG4gICAgICBtYyA9IG5ldyBIYW1tZXIodGFyZ2V0RWxlbWVudCk7XHJcbiAgbWMuZ2V0KCdzd2lwZScpLnNldCh7IGRpcmVjdGlvbjogSGFtbWVyLkRJUkVDVElPTl9WRVJUSUNBTCB9KTtcclxuICBtYy5vbignc3dpcGV1cCBzd2lwZWRvd24nLCBmdW5jdGlvbihlKSB7XHJcblxyXG4gICAgdXBkYXRlSGVscGVyKGUpO1xyXG5cclxuICB9KTtcclxuXHJcbiAgJChkb2N1bWVudCkua2V5dXAoZnVuY3Rpb24oZSl7XHJcblxyXG4gICAgaWYgKCEoJCgnLm91dGVyLW5hdicpLmhhc0NsYXNzKCdpcy12aXMnKSkpIHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB1cGRhdGVIZWxwZXIoZSk7XHJcbiAgICB9XHJcblxyXG4gIH0pO1xyXG5cclxuICAvLyBkZXRlcm1pbmUgc2Nyb2xsLCBzd2lwZSwgYW5kIGFycm93IGtleSBkaXJlY3Rpb25cclxuICBmdW5jdGlvbiB1cGRhdGVIZWxwZXIocGFyYW0pIHtcclxuXHJcbiAgICB2YXIgY3VyQWN0aXZlID0gJCgnLnNpZGUtbmF2JykuZmluZCgnLmlzLWFjdGl2ZScpLFxyXG4gICAgICAgIGN1clBvcyA9ICQoJy5zaWRlLW5hdicpLmNoaWxkcmVuKCkuaW5kZXgoY3VyQWN0aXZlKSxcclxuICAgICAgICBsYXN0SXRlbSA9ICQoJy5zaWRlLW5hdicpLmNoaWxkcmVuKCkubGVuZ3RoIC0gMSxcclxuICAgICAgICBuZXh0UG9zID0gMDtcclxuXHJcbiAgICBpZiAocGFyYW0udHlwZSA9PT0gXCJzd2lwZXVwXCIgfHwgcGFyYW0ua2V5Q29kZSA9PT0gNDAgfHwgcGFyYW0gPiAwKSB7XHJcbiAgICAgIGlmIChjdXJQb3MgIT09IGxhc3RJdGVtKSB7XHJcbiAgICAgICAgbmV4dFBvcyA9IGN1clBvcyArIDE7XHJcbiAgICAgICAgdXBkYXRlTmF2cyhuZXh0UG9zKTtcclxuICAgICAgICB1cGRhdGVDb250ZW50KGN1clBvcywgbmV4dFBvcywgbGFzdEl0ZW0pO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgIHVwZGF0ZU5hdnMobmV4dFBvcyk7XHJcbiAgICAgICAgdXBkYXRlQ29udGVudChjdXJQb3MsIG5leHRQb3MsIGxhc3RJdGVtKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAocGFyYW0udHlwZSA9PT0gXCJzd2lwZWRvd25cIiB8fCBwYXJhbS5rZXlDb2RlID09PSAzOCB8fCBwYXJhbSA8IDApe1xyXG4gICAgICBpZiAoY3VyUG9zICE9PSAwKXtcclxuICAgICAgICBuZXh0UG9zID0gY3VyUG9zIC0gMTtcclxuICAgICAgICB1cGRhdGVOYXZzKG5leHRQb3MpO1xyXG4gICAgICAgIHVwZGF0ZUNvbnRlbnQoY3VyUG9zLCBuZXh0UG9zLCBsYXN0SXRlbSk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgbmV4dFBvcyA9IGxhc3RJdGVtO1xyXG4gICAgICAgIHVwZGF0ZU5hdnMobmV4dFBvcyk7XHJcbiAgICAgICAgdXBkYXRlQ29udGVudChjdXJQb3MsIG5leHRQb3MsIGxhc3RJdGVtKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICB9XHJcblxyXG4gIC8vIHN5bmMgc2lkZSBhbmQgb3V0ZXIgbmF2aWdhdGlvbnNcclxuICBmdW5jdGlvbiB1cGRhdGVOYXZzKG5leHRQb3MpIHtcclxuXHJcbiAgICAkKCcuc2lkZS1uYXYsIC5vdXRlci1uYXYnKS5jaGlsZHJlbigpLnJlbW92ZUNsYXNzKCdpcy1hY3RpdmUnKTtcclxuICAgICQoJy5zaWRlLW5hdicpLmNoaWxkcmVuKCkuZXEobmV4dFBvcykuYWRkQ2xhc3MoJ2lzLWFjdGl2ZScpO1xyXG4gICAgJCgnLm91dGVyLW5hdicpLmNoaWxkcmVuKCkuZXEobmV4dFBvcykuYWRkQ2xhc3MoJ2lzLWFjdGl2ZScpO1xyXG5cclxuICB9XHJcblxyXG4gIC8vIHVwZGF0ZSBtYWluIGNvbnRlbnQgYXJlYVxyXG4gIGZ1bmN0aW9uIHVwZGF0ZUNvbnRlbnQoY3VyUG9zLCBuZXh0UG9zLCBsYXN0SXRlbSkge1xyXG5cclxuICAgICQoJy5tYWluLWNvbnRlbnQnKS5jaGlsZHJlbigpLnJlbW92ZUNsYXNzKCdzZWN0aW9uLS1pcy1hY3RpdmUnKTtcclxuICAgICQoJy5tYWluLWNvbnRlbnQnKS5jaGlsZHJlbigpLmVxKG5leHRQb3MpLmFkZENsYXNzKCdzZWN0aW9uLS1pcy1hY3RpdmUnKTtcclxuICAgICQoJy5tYWluLWNvbnRlbnQgLnNlY3Rpb24nKS5jaGlsZHJlbigpLnJlbW92ZUNsYXNzKCdzZWN0aW9uLS1uZXh0IHNlY3Rpb24tLXByZXYnKTtcclxuXHJcbiAgICBpZiAoY3VyUG9zID09PSBsYXN0SXRlbSAmJiBuZXh0UG9zID09PSAwIHx8IGN1clBvcyA9PT0gMCAmJiBuZXh0UG9zID09PSBsYXN0SXRlbSkge1xyXG4gICAgICAkKCcubWFpbi1jb250ZW50IC5zZWN0aW9uJykuY2hpbGRyZW4oKS5yZW1vdmVDbGFzcygnc2VjdGlvbi0tbmV4dCBzZWN0aW9uLS1wcmV2Jyk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChjdXJQb3MgPCBuZXh0UG9zKSB7XHJcbiAgICAgICQoJy5tYWluLWNvbnRlbnQnKS5jaGlsZHJlbigpLmVxKGN1clBvcykuY2hpbGRyZW4oKS5hZGRDbGFzcygnc2VjdGlvbi0tbmV4dCcpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICQoJy5tYWluLWNvbnRlbnQnKS5jaGlsZHJlbigpLmVxKGN1clBvcykuY2hpbGRyZW4oKS5hZGRDbGFzcygnc2VjdGlvbi0tcHJldicpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChuZXh0UG9zICE9PSAwICYmIG5leHRQb3MgIT09IGxhc3RJdGVtKSB7XHJcbiAgICAgICQoJy5oZWFkZXItLWN0YScpLmFkZENsYXNzKCdpcy1hY3RpdmUnKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAkKCcuaGVhZGVyLS1jdGEnKS5yZW1vdmVDbGFzcygnaXMtYWN0aXZlJyk7XHJcbiAgICB9XHJcblxyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gb3V0ZXJOYXYoKSB7XHJcblxyXG4gICAgJCgnLmhlYWRlci0tbmF2LXRvZ2dsZScpLmNsaWNrKGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgICAkKCcucGVyc3BlY3RpdmUnKS5hZGRDbGFzcygncGVyc3BlY3RpdmUtLW1vZGFsdmlldycpO1xyXG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgJCgnLnBlcnNwZWN0aXZlJykuYWRkQ2xhc3MoJ2VmZmVjdC1yb3RhdGUtbGVmdC0tYW5pbWF0ZScpO1xyXG4gICAgICB9LCAyNSk7XHJcbiAgICAgICQoJy5vdXRlci1uYXYsIC5vdXRlci1uYXYgbGksIC5vdXRlci1uYXYtLXJldHVybicpLmFkZENsYXNzKCdpcy12aXMnKTtcclxuXHJcbiAgICB9KTtcclxuXHJcbiAgICAkKCcub3V0ZXItbmF2LS1yZXR1cm4sIC5vdXRlci1uYXYgbGknKS5jbGljayhmdW5jdGlvbigpe1xyXG5cclxuICAgICAgJCgnLnBlcnNwZWN0aXZlJykucmVtb3ZlQ2xhc3MoJ2VmZmVjdC1yb3RhdGUtbGVmdC0tYW5pbWF0ZScpO1xyXG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgJCgnLnBlcnNwZWN0aXZlJykucmVtb3ZlQ2xhc3MoJ3BlcnNwZWN0aXZlLS1tb2RhbHZpZXcnKTtcclxuICAgICAgfSwgNDAwKTtcclxuICAgICAgJCgnLm91dGVyLW5hdiwgLm91dGVyLW5hdiBsaSwgLm91dGVyLW5hdi0tcmV0dXJuJykucmVtb3ZlQ2xhc3MoJ2lzLXZpcycpO1xyXG5cclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHdvcmtTbGlkZXIoKSB7XHJcbiAgICB2YXIgYWN0aXZlSW5uZXJTbGlkZXI7XHJcblxyXG4gICAgdmFyIG91dGVyU2xpZGVyID0gd29yay5maW5kKCcub3V0ZXItc2xpZGVyJyk7XHJcbiAgICAgIC8qdmFyIG91dGVyU2xpZGVyUHJldkJ0biA9IG91dGVyU2xpZGVyLnNpYmxpbmdzKCcuc2xpZGVyLS1wcmV2Jyk7XHJcbiAgICAgIHZhciBvdXRlclNsaWRlck5leHRCdG4gPSBvdXRlclNsaWRlci5zaWJsaW5ncygnLnNsaWRlci0tbmV4dCcpO1xyXG4gICAgICAqL1xyXG4gICAgdmFyIGlubmVyU2xpZGVyID0gd29yay5maW5kKCcuaW5uZXItc2xpZGVyJyk7XHJcblxyXG4gICAgdmFyIGlubmVyU2xpZGVyUHJldkJ0biA9IHdvcmsuZmluZCgnLmlubmVyLXNsaWRlcl9fbmF2LS1wcmV2Jyk7XHJcbiAgICB2YXIgaW5uZXJTbGlkZXJOZXh0QnRuID0gd29yay5maW5kKCcuaW5uZXItc2xpZGVyX19uYXYtLW5leHQnKTtcclxuXHJcbiAgICB2YXIgb3V0ZXJTbGlkZXJDb250cm9scyA9IHdvcmsuZmluZCgnLm91dGVyLXNsaWRlcl9fY29udHJvbHMnKTtcclxuXHJcbiAgICB2YXIgb3V0ZXJTbGlkZXJQcmV2QnRuID0gd29yay5maW5kKCcub3V0ZXItc2xpZGVyX19uYXYtLXByZXYnKTtcclxuICAgIHZhciBvdXRlclNsaWRlck5leHRCdG4gPSB3b3JrLmZpbmQoJy5vdXRlci1zbGlkZXJfX25hdi0tbmV4dCcpO1xyXG5cclxuICAgIFxyXG5cclxuICAgIC8vIGluaXQgc3dpcGVyIHNsaWRlciBmb3Igb3V0ZXIgc2xpZGVzXHJcbiAgICB2YXIgb3V0ZXJTd2lwZXIgPSBuZXcgU3dpcGVyIChvdXRlclNsaWRlciwge1xyXG4gICAgICBpbml0OiBmYWxzZSxcclxuICAgICAgbG9vcDogdHJ1ZSxcclxuICAgICAgbG9vcGVkU2xpZGVzOiA0LFxyXG4gICAgICBzbGlkZXNQZXJWaWV3OiAnYXV0bycsXHJcbiAgICAgIGNlbnRlcmVkU2xpZGVzOiB0cnVlLFxyXG4gICAgICBub3JtYWxpemVTbGlkZUluZGV4OiB0cnVlLFxyXG4gICAgICBkaXJlY3Rpb246ICd2ZXJ0aWNhbCcsXHJcbiAgICAgIGFsbG93VG91Y2hNb3ZlOiBmYWxzZSxcclxuICAgICAgZWZmZWN0OiAnc2xpZGUnLFxyXG4gICAgICBub3JtYWxpemVTbGlkZUluZGV4OiB0cnVlLFxyXG4gICAgICAvKmZhZGVFZmZlY3Q6IHtcclxuICAgICAgICBjcm9zc0ZhZGU6IHRydWVcclxuICAgICAgfSwqL1xyXG4gICAgICBjb250cm9sbGVyOntcclxuICAgICAgICBieTogJ3NsaWRlJ1xyXG4gICAgICB9XHJcbiAgICAgIC8qLFxyXG4gICAgICBoYXNoTmF2aWdhdGlvbjogdHJ1ZSxcclxuICAgICAgaGFzaE5hdmlnYXRpb246IHtcclxuICAgICAgICB3YXRjaFN0YXRlOiB0cnVlXHJcbiAgICAgIH0qL1xyXG4gICAgfSk7XHJcblxyXG5cclxuICAgIC8vIGRldGVybWluaW5nIGN1cnJlbnQgaW5uZXIgc3dpcGVyIGluZGV4XHJcbiAgICB2YXIgY3VycmVudElubmVyU3dpcGVySW5kZXg7XHJcbiAgICBvdXRlclN3aXBlci5vbignaW5pdCcsZnVuY3Rpb24gKCkge1xyXG4gICAgICBjb25zb2xlLmxvZygnc3dpcGVyIGluaXRpYWxpemVkJyk7XHJcbiAgICAgIGN1cnJlbnRJbm5lclN3aXBlckluZGV4ID0gb3V0ZXJTd2lwZXIuYWN0aXZlSW5kZXg7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdjdXJyZW50SW5uZXJTd2lwZXJJbmRleDogJysgY3VycmVudElubmVyU3dpcGVySW5kZXgpO1xyXG4gICAgfSksXHJcblxyXG4gICAgb3V0ZXJTd2lwZXIuaW5pdCgpOyAvLyBpbml0IG91dGVyU3dpcGVyXHJcblxyXG4gICAgdmFyIG91dGVyU3dpcGVyQ29udHJvbHMgPSBuZXcgU3dpcGVyKG91dGVyU2xpZGVyQ29udHJvbHMsIHtcclxuICAgICAgZWZmZWN0OiAnc2xpZGUnLFxyXG4gICAgICBub3JtYWxpemVTbGlkZUluZGV4OiB0cnVlLFxyXG4gICAgICBkaXJlY3Rpb246ICdob3Jpem9udGFsJyxcclxuICAgICAgY2VudGVyZWRTbGlkZXM6IHRydWUsXHJcbiAgICAgIGxvb3A6IHRydWUsXHJcbiAgICAgIGxvb3BlZFNsaWRlczogNCxcclxuICAgICAgc2xpZGVzUGVyVmlldzogJ2F1dG8nLFxyXG4gICAgICBzcGFjZUJldHdlZW46IDM1LFxyXG4gICAgICB0b3VjaFJhdGlvOiAwLjIsXHJcbiAgICAgIHNsaWRlVG9DbGlja2VkU2xpZGU6IHRydWUsXHJcbiAgICAgIG5vcm1hbGl6ZVNsaWRlSW5kZXg6IHRydWUsXHJcbiAgICAgIG5hdmlnYXRpb246IHtcclxuICAgICAgICBuZXh0RWw6IG91dGVyU2xpZGVyTmV4dEJ0bixcclxuICAgICAgICBwcmV2RWw6IG91dGVyU2xpZGVyUHJldkJ0blxyXG4gICAgICB9LFxyXG4gICAgICBjb250cm9sbGVyOntcclxuICAgICAgICBieTogJ3NsaWRlJ1xyXG4gICAgICB9LFxyXG4gICAgICBicmVha3BvaW50czp7XHJcbiAgICAgICAgNzAwOntcclxuICAgICAgICAgIHNsaWRlc1BlclZpZXc6ICdhdXRvJyxcclxuICAgICAgICAgIHNwYWNlQmV0d2VlbjogMFxyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICB9XHJcblxyXG4gICAgfSk7XHJcblxyXG5cclxuICAgIG91dGVyU3dpcGVyQ29udHJvbHMuY29udHJvbGxlci5jb250cm9sID0gb3V0ZXJTd2lwZXI7XHJcbiAgICBvdXRlclN3aXBlci5jb250cm9sbGVyLmNvbnRyb2wgPSBvdXRlclN3aXBlckNvbnRyb2xzO1xyXG5cclxuXHJcbiAgICAvLyBpbml0IHN3aXBlciBzbGlkZXIgZm9yIG91dGVyIHNsaWRlc1xyXG4gICAgdmFyIGlubmVyU3dpcGVyID0gbmV3IFN3aXBlciAoaW5uZXJTbGlkZXIsIHtcclxuICAgICAgXHJcbiAgICAgIGRpcmVjdGlvbjogJ2hvcml6b250YWwnLFxyXG4gICAgICBsb29wOiB0cnVlLFxyXG4gICAgICBzcGFjZUJldHdlZW46IDAsXHJcbiAgICAgIC8vIHNsaWRlc1BlclZpZXc6IDMsXHJcbiAgICAgIHNsaWRlc1BlclZpZXc6ICdhdXRvJyxcclxuICAgICAgbG9vcGVkU2xpZGVzOiA3LFxyXG4gICAgICBsb29wQWRkaXRpb25hbFNsaWRlczogMTAsXHJcbiAgICAgIGNlbnRlcmVkU2xpZGVzOiB0cnVlLFxyXG4gICAgICBzcGFjZUJldHdlZW46IDAsXHJcblxyXG4gICAgICBlZmZlY3Q6ICdjb3ZlcmZsb3cnLFxyXG4gICAgICAvLyBncmFiQ3Vyc29yOiB0cnVlLFxyXG4gICAgICBjb3ZlcmZsb3dFZmZlY3Q6IHtcclxuICAgICAgICByb3RhdGU6IDQwLFxyXG4gICAgICAgIHN0cmV0Y2g6IDAsXHJcbiAgICAgICAgZGVwdGg6IDEwMCxcclxuICAgICAgICBtb2RpZmllcjogMSxcclxuICAgICAgICBzbGlkZVNoYWRvd3MgOiB0cnVlXHJcbiAgICAgIH0sXHJcbiAgICAgIG5vcm1hbGl6ZVNsaWRlSW5kZXg6IHRydWUsXHJcbiAgICAgIHNsaWRlVG9DbGlja2VkU2xpZGU6IHRydWVcclxuXHJcbiAgICB9KTtcclxuXHJcblxyXG5cclxuXHJcbiAgICAvLyBzd2lwaW5nIGN1cnJlbnQgaW5uZXJTd2lwZXIgb24gY2xpY2tzXHJcbiAgICBcclxuICAgIHZhciBzcGVlZCA9IDQwMDtcclxuICAgIHZhciB0b3VjaDtcclxuICAgIGlubmVyU2xpZGVyTmV4dEJ0bi5hZGQoaW5uZXJTbGlkZXJQcmV2QnRuKS5vbignY2xpY2sgdG91Y2hzdGFydCcsZnVuY3Rpb24oZSl7XHJcbiAgICAgIHZhciAkdGhpcyA9ICQodGhpcyk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoZS50eXBlPT0ndG91Y2hzdGFydCcpIHtcclxuICAgICAgICB0b3VjaCA9IHRydWU7XHJcblxyXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgIHRvdWNoID0gZmFsc2U7XHJcbiAgICAgICAgfSw0MDApO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyByZXR1cm4gaWYgY2xpY2sgZmlyZWQgd2l0aGluIDQwMCBtcyBhZnRlciB0b3VjaFxyXG4gICAgICBpZiAodG91Y2ggJiYgZS50eXBlPT0nY2xpY2snKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcblxyXG4gICAgICB2YXIgY3VySW5uZXJTd2lwZXJDb250ID0gb3V0ZXJTd2lwZXIuc2xpZGVzW2N1cnJlbnRJbm5lclN3aXBlckluZGV4XTtcclxuICAgICAgdmFyIGN1cklubmVyU3dpcGVyID0gJChjdXJJbm5lclN3aXBlckNvbnQpLmZpbmQoJy5pbm5lci1zbGlkZXInKVswXTtcclxuICAgICAgdmFyIGN1clN3aXBlckluc3RhbmNlID0gY3VySW5uZXJTd2lwZXIuc3dpcGVyO1xyXG5cclxuICAgICAgaWYgKCR0aGlzLmhhc0NsYXNzKCdpbm5lci1zbGlkZXJfX3ByZXYnKSkge1xyXG4gICAgICAgICAgY3VySW5uZXJTd2lwZXIuc3dpcGVyLnNsaWRlUHJldig0MDApO1xyXG4gICAgICB9ZWxzZXtcclxuICAgICAgICAgIGN1cklubmVyU3dpcGVyLnN3aXBlci5zbGlkZU5leHQoNDAwKTtcclxuICAgICAgfVxyXG5cclxuICAgIH0pXHJcblxyXG4gICAgXHJcblxyXG5cclxuXHJcblxyXG5cclxuICAgIC8vIGRldGVjdGluZyBvdXRlclN3aXBlciB0cmFuc2l0aW9uRW5kIHRvIGNoYW5nZSBjdXJyZW50SW5uZXJTd2lwZXJJbmRleFxyXG5cclxuICAgIHZhciBvdXRlclN3aXBlclRyaWdnZXIgLCBpbW1GaXJlVGltZW91dCA9IDIwMDtcclxuICAgIG91dGVyU3dpcGVyLm9uKCd0cmFuc2l0aW9uRW5kJyxmdW5jdGlvbigpe1xyXG4gICAgICAvLyBzdG9wcGluZyBpdCB0byBleGVjdXRlIG11bHRpcGxlIHRpbWVzIGNvbnNlY3V0aXZlbHlcclxuICAgICAgaWYgKG91dGVyU3dpcGVyVHJpZ2dlcikge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfWVsc2V7XHJcbiAgICAgICAgb3V0ZXJTd2lwZXJUcmlnZ2VyID0gdHJ1ZTtcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc29sZS5sb2coJ2NoYW5nZWQnKTtcclxuXHJcbiAgICAgIGN1cnJlbnRJbm5lclN3aXBlckluZGV4ID0gb3V0ZXJTd2lwZXIuYWN0aXZlSW5kZXg7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdjdXJyZW50SW5uZXJTd2lwZXJJbmRleDogJysgY3VycmVudElubmVyU3dpcGVySW5kZXgpO1xyXG5cclxuXHJcbiAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgb3V0ZXJTd2lwZXJUcmlnZ2VyID0gdW5kZWZpbmVkO1xyXG4gICAgICB9LGltbUZpcmVUaW1lb3V0KTsgLy8gYWxsb3dpbmcgdGhlIGNhbGxiYWNrIHRvIHJ1biBhZnRlciBhIGNlcnRhaW4gdGltZVxyXG5cclxuICAgIH0pO1xyXG5cclxuXHJcblxyXG4gIH0gLy8gRU5EIG9mIHdvcmtTbGlkZXIgRnVuY1xyXG5cclxuICBcclxuXHJcbiAgZnVuY3Rpb24gdHJhbnNpdGlvbkxhYmVscygpIHtcclxuXHJcbiAgICAkKCcud29yay1yZXF1ZXN0LS1pbmZvcm1hdGlvbiBpbnB1dCcpLmZvY3Vzb3V0KGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgICB2YXIgdGV4dFZhbCA9ICQodGhpcykudmFsKCk7XHJcblxyXG4gICAgICBpZiAodGV4dFZhbCA9PT0gXCJcIikge1xyXG4gICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoJ2hhcy12YWx1ZScpO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICQodGhpcykuYWRkQ2xhc3MoJ2hhcy12YWx1ZScpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBjb3JyZWN0IG1vYmlsZSBkZXZpY2Ugd2luZG93IHBvc2l0aW9uXHJcbiAgICAgIHdpbmRvdy5zY3JvbGxUbygwLCAwKTtcclxuXHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBzdGFydFByb2plY3RGb3JtKCl7XHJcbiAgICAgIHZhciBzdGFydFByb2plY3RGb3JtID0gJCgnI3N0YXJ0UHJvamVjdEZvcm0nKTtcclxuXHJcbiAgICAgIHZhciBuYW1lRmllbGQgPSAkKCcjbmFtZVNQJyk7XHJcbiAgICAgIHZhciBlbWFpbEZpZWxkID0gJCgnI2VtYWlsU1AnKTtcclxuICAgICAgdmFyIHdlYlNlcnZpY2VGaWVsZCA9ICQoJyNzZXJ2aWNlLXdlYicpO1xyXG4gICAgICB2YXIgc2VydmljZXNDb250ID0gd2ViU2VydmljZUZpZWxkLmNsb3Nlc3QoJy53b3JrLXJlcXVlc3QtLXNlcnZpY2VzJyk7XHJcblxyXG5cclxuICAgICAgLy8gY2hhbmdlIHZhbGlkYXRpb24gbWVzc2FnZXMgYW5kIGN1c3RvbWl6ZSBvcHRpb25zXHJcblxyXG4gICAgICBzdGFydFByb2plY3RGb3JtLnBhcnNsZXkoe1xyXG4gICAgICAgIHJlcXVpcmVkTWVzc2FnZTogJ1RoaXMgZmllbGQgaXMgcmVxdWlyZWQnXHJcbiAgICAgICAgXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgZW1haWxGaWVsZC5wYXJzbGV5KHtcclxuICAgICAgICB0eXBlTWVzc2FnZTogXCJFbnRlciBhIHZhbGlkIGUtbWFpbCBhZGRyZXNzXCJcclxuICAgICAgfSk7XHJcblxyXG4gICAgICB3ZWJTZXJ2aWNlRmllbGQucGFyc2xleSh7XHJcbiAgICAgICAgcmVxdWlyZWRNZXNzYWdlOiBcIlBsZWFzZSBzZWxlY3QgdGhlIGRpZ2l0YWwgc2VydmljZS9zIHlvdSB3YW50IHVzIHRvIHdvcmsgb25cIiwgLy8gb25seSB3b3JrcyB3aGVuIHVzaW5nIHRoZSBmaXJzdCBjaGVja2JveCBpbiB0aGUgZ3JvdXBcclxuICAgICAgICBlcnJvcnNDb250YWluZXI6IGZ1bmN0aW9uIChGaWVsZCkge1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICByZXR1cm4gc2VydmljZXNDb250O1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgY2xhc3NIYW5kbGVyOiBmdW5jdGlvbiAoRmllbGQpIHtcclxuICAgICAgICAgIHJldHVybiBzZXJ2aWNlc0NvbnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuXHJcblxyXG4gICAgICAvLyBhY3QgdG8gdmFsaWRhdGlvbiBlcnJvcnMgYW5kIHN1Y2Nlc3MgXHJcblxyXG4gICAgICBzdGFydFByb2plY3RGb3JtLnBhcnNsZXkoKS5vbignZm9ybTplcnJvcicsZnVuY3Rpb24oKXtcclxuXHJcbiAgICAgICAgICBhbGVydCgndmFsaWRhdGlvbiBlcnJvcnMnKTsgIFxyXG5cclxuICAgICAgfSkub24oJ2Zvcm06c3VibWl0JyxmdW5jdGlvbihlKXtcclxuXHJcbiAgICAgICAgICBjb25zb2xlLmxvZygnRm9ybSBTdWJtaXR0ZWQnKTtcclxuXHJcbiAgICAgICAgICAvLyB3cml0ZSBjb2RlIGhlcmUgdG8gc3VibWl0IHRvIERCXHJcblxyXG4gICAgICAgICAgXHJcblxyXG4gICAgICAgICAgcmV0dXJuIGZhbHNlOyAgXHJcbiAgICAgIH0pO1xyXG5cclxuXHJcblxyXG5cclxuICB9XHJcblxyXG4gIG91dGVyTmF2KCk7XHJcbiAgd29ya1NsaWRlcigpO1xyXG4gIHRyYW5zaXRpb25MYWJlbHMoKTtcclxuXHJcbiAgc3RhcnRQcm9qZWN0Rm9ybSgpO1xyXG5cclxufSk7XHJcblxyXG5cclxuXHJcblxyXG5cclxuLyogXHJcblxyXG4gJCgnLnNsaWRlci0tcHJldiwgLnNsaWRlci0tbmV4dCcpLmNsaWNrKGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgdmFyICR0aGlzID0gJCh0aGlzKSxcclxuICAgICAgICAgIGN1ckxlZnQgPSAkKCcuc2xpZGVyJykuZmluZCgnLnNsaWRlci0taXRlbS1sZWZ0JyksXHJcbiAgICAgICAgICBjdXJMZWZ0UG9zID0gJCgnLnNsaWRlcicpLmNoaWxkcmVuKCkuaW5kZXgoY3VyTGVmdCksXHJcbiAgICAgICAgICBjdXJDZW50ZXIgPSAkKCcuc2xpZGVyJykuZmluZCgnLnNsaWRlci0taXRlbS1jZW50ZXInKSxcclxuICAgICAgICAgIGN1ckNlbnRlclBvcyA9ICQoJy5zbGlkZXInKS5jaGlsZHJlbigpLmluZGV4KGN1ckNlbnRlciksXHJcbiAgICAgICAgICBjdXJSaWdodCA9ICQoJy5zbGlkZXInKS5maW5kKCcuc2xpZGVyLS1pdGVtLXJpZ2h0JyksXHJcbiAgICAgICAgICBjdXJSaWdodFBvcyA9ICQoJy5zbGlkZXInKS5jaGlsZHJlbigpLmluZGV4KGN1clJpZ2h0KSxcclxuICAgICAgICAgIHRvdGFsV29ya3MgPSAkKCcuc2xpZGVyJykuY2hpbGRyZW4oKS5sZW5ndGgsXHJcbiAgICAgICAgICAkbGVmdCA9ICQoJy5zbGlkZXItLWl0ZW0tbGVmdCcpLFxyXG4gICAgICAgICAgJGNlbnRlciA9ICQoJy5zbGlkZXItLWl0ZW0tY2VudGVyJyksXHJcbiAgICAgICAgICAkcmlnaHQgPSAkKCcuc2xpZGVyLS1pdGVtLXJpZ2h0JyksXHJcbiAgICAgICAgICAkaXRlbSA9ICQoJy5zbGlkZXItLWl0ZW0nKTtcclxuXHJcbiAgICAgICQoJy5zbGlkZXInKS5hbmltYXRlKHsgb3BhY2l0eSA6IDAgfSwgNDAwKTtcclxuXHJcbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuXHJcbiAgICAgIGlmICgkdGhpcy5oYXNDbGFzcygnc2xpZGVyLS1uZXh0JykpIHtcclxuICAgICAgICBpZiAoY3VyTGVmdFBvcyA8IHRvdGFsV29ya3MgLSAxICYmIGN1ckNlbnRlclBvcyA8IHRvdGFsV29ya3MgLSAxICYmIGN1clJpZ2h0UG9zIDwgdG90YWxXb3JrcyAtIDEpIHtcclxuICAgICAgICAgICRsZWZ0LnJlbW92ZUNsYXNzKCdzbGlkZXItLWl0ZW0tbGVmdCcpLm5leHQoKS5hZGRDbGFzcygnc2xpZGVyLS1pdGVtLWxlZnQnKTtcclxuICAgICAgICAgICRjZW50ZXIucmVtb3ZlQ2xhc3MoJ3NsaWRlci0taXRlbS1jZW50ZXInKS5uZXh0KCkuYWRkQ2xhc3MoJ3NsaWRlci0taXRlbS1jZW50ZXInKTtcclxuICAgICAgICAgICRyaWdodC5yZW1vdmVDbGFzcygnc2xpZGVyLS1pdGVtLXJpZ2h0JykubmV4dCgpLmFkZENsYXNzKCdzbGlkZXItLWl0ZW0tcmlnaHQnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICBpZiAoY3VyTGVmdFBvcyA9PT0gdG90YWxXb3JrcyAtIDEpIHtcclxuICAgICAgICAgICAgJGl0ZW0ucmVtb3ZlQ2xhc3MoJ3NsaWRlci0taXRlbS1sZWZ0JykuZmlyc3QoKS5hZGRDbGFzcygnc2xpZGVyLS1pdGVtLWxlZnQnKTtcclxuICAgICAgICAgICAgJGNlbnRlci5yZW1vdmVDbGFzcygnc2xpZGVyLS1pdGVtLWNlbnRlcicpLm5leHQoKS5hZGRDbGFzcygnc2xpZGVyLS1pdGVtLWNlbnRlcicpO1xyXG4gICAgICAgICAgICAkcmlnaHQucmVtb3ZlQ2xhc3MoJ3NsaWRlci0taXRlbS1yaWdodCcpLm5leHQoKS5hZGRDbGFzcygnc2xpZGVyLS1pdGVtLXJpZ2h0Jyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBlbHNlIGlmIChjdXJDZW50ZXJQb3MgPT09IHRvdGFsV29ya3MgLSAxKSB7XHJcbiAgICAgICAgICAgICRsZWZ0LnJlbW92ZUNsYXNzKCdzbGlkZXItLWl0ZW0tbGVmdCcpLm5leHQoKS5hZGRDbGFzcygnc2xpZGVyLS1pdGVtLWxlZnQnKTtcclxuICAgICAgICAgICAgJGl0ZW0ucmVtb3ZlQ2xhc3MoJ3NsaWRlci0taXRlbS1jZW50ZXInKS5maXJzdCgpLmFkZENsYXNzKCdzbGlkZXItLWl0ZW0tY2VudGVyJyk7XHJcbiAgICAgICAgICAgICRyaWdodC5yZW1vdmVDbGFzcygnc2xpZGVyLS1pdGVtLXJpZ2h0JykubmV4dCgpLmFkZENsYXNzKCdzbGlkZXItLWl0ZW0tcmlnaHQnKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAkbGVmdC5yZW1vdmVDbGFzcygnc2xpZGVyLS1pdGVtLWxlZnQnKS5uZXh0KCkuYWRkQ2xhc3MoJ3NsaWRlci0taXRlbS1sZWZ0Jyk7XHJcbiAgICAgICAgICAgICRjZW50ZXIucmVtb3ZlQ2xhc3MoJ3NsaWRlci0taXRlbS1jZW50ZXInKS5uZXh0KCkuYWRkQ2xhc3MoJ3NsaWRlci0taXRlbS1jZW50ZXInKTtcclxuICAgICAgICAgICAgJGl0ZW0ucmVtb3ZlQ2xhc3MoJ3NsaWRlci0taXRlbS1yaWdodCcpLmZpcnN0KCkuYWRkQ2xhc3MoJ3NsaWRlci0taXRlbS1yaWdodCcpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICBpZiAoY3VyTGVmdFBvcyAhPT0gMCAmJiBjdXJDZW50ZXJQb3MgIT09IDAgJiYgY3VyUmlnaHRQb3MgIT09IDApIHtcclxuICAgICAgICAgICRsZWZ0LnJlbW92ZUNsYXNzKCdzbGlkZXItLWl0ZW0tbGVmdCcpLnByZXYoKS5hZGRDbGFzcygnc2xpZGVyLS1pdGVtLWxlZnQnKTtcclxuICAgICAgICAgICRjZW50ZXIucmVtb3ZlQ2xhc3MoJ3NsaWRlci0taXRlbS1jZW50ZXInKS5wcmV2KCkuYWRkQ2xhc3MoJ3NsaWRlci0taXRlbS1jZW50ZXInKTtcclxuICAgICAgICAgICRyaWdodC5yZW1vdmVDbGFzcygnc2xpZGVyLS1pdGVtLXJpZ2h0JykucHJldigpLmFkZENsYXNzKCdzbGlkZXItLWl0ZW0tcmlnaHQnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICBpZiAoY3VyTGVmdFBvcyA9PT0gMCkge1xyXG4gICAgICAgICAgICAkaXRlbS5yZW1vdmVDbGFzcygnc2xpZGVyLS1pdGVtLWxlZnQnKS5sYXN0KCkuYWRkQ2xhc3MoJ3NsaWRlci0taXRlbS1sZWZ0Jyk7XHJcbiAgICAgICAgICAgICRjZW50ZXIucmVtb3ZlQ2xhc3MoJ3NsaWRlci0taXRlbS1jZW50ZXInKS5wcmV2KCkuYWRkQ2xhc3MoJ3NsaWRlci0taXRlbS1jZW50ZXInKTtcclxuICAgICAgICAgICAgJHJpZ2h0LnJlbW92ZUNsYXNzKCdzbGlkZXItLWl0ZW0tcmlnaHQnKS5wcmV2KCkuYWRkQ2xhc3MoJ3NsaWRlci0taXRlbS1yaWdodCcpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgZWxzZSBpZiAoY3VyQ2VudGVyUG9zID09PSAwKSB7XHJcbiAgICAgICAgICAgICRsZWZ0LnJlbW92ZUNsYXNzKCdzbGlkZXItLWl0ZW0tbGVmdCcpLnByZXYoKS5hZGRDbGFzcygnc2xpZGVyLS1pdGVtLWxlZnQnKTtcclxuICAgICAgICAgICAgJGl0ZW0ucmVtb3ZlQ2xhc3MoJ3NsaWRlci0taXRlbS1jZW50ZXInKS5sYXN0KCkuYWRkQ2xhc3MoJ3NsaWRlci0taXRlbS1jZW50ZXInKTtcclxuICAgICAgICAgICAgJHJpZ2h0LnJlbW92ZUNsYXNzKCdzbGlkZXItLWl0ZW0tcmlnaHQnKS5wcmV2KCkuYWRkQ2xhc3MoJ3NsaWRlci0taXRlbS1yaWdodCcpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICRsZWZ0LnJlbW92ZUNsYXNzKCdzbGlkZXItLWl0ZW0tbGVmdCcpLnByZXYoKS5hZGRDbGFzcygnc2xpZGVyLS1pdGVtLWxlZnQnKTtcclxuICAgICAgICAgICAgJGNlbnRlci5yZW1vdmVDbGFzcygnc2xpZGVyLS1pdGVtLWNlbnRlcicpLnByZXYoKS5hZGRDbGFzcygnc2xpZGVyLS1pdGVtLWNlbnRlcicpO1xyXG4gICAgICAgICAgICAkaXRlbS5yZW1vdmVDbGFzcygnc2xpZGVyLS1pdGVtLXJpZ2h0JykubGFzdCgpLmFkZENsYXNzKCdzbGlkZXItLWl0ZW0tcmlnaHQnKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICB9LCA0MDApO1xyXG5cclxuICAgICQoJy5zbGlkZXInKS5hbmltYXRlKHsgb3BhY2l0eSA6IDEgfSwgNDAwKTtcclxuXHJcbiAgICB9KTtcclxuXHJcblxyXG5cclxuKi8iXX0=
