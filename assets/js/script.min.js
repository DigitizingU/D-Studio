$(document).ready(function(){var e=this,i=$("body");function n(){window.vh=e.documentElement.clientHeight,window.vw=e.documentElement.clientWidth,window.wh=$(window).height(),window.ww=$(window).width(),window.dh=$(document).height(),window.dw=$(document).width(),window.vmin=vh>vw?vw:vh,window.vmax=vh<vw?vw:vh,vw<1024?i.addClass("mobile"):i.removeClass("mobile")}e.ontouchstart?(window.touchAvail=!0,i.addClass("touch")):(window.touchAvail=!1,i.removeClass("touch")),n(),function(){var e=sessionStorage.getItem("activeSectionClass");if(!+e)return;var i=$(".side-nav").children().length-1,n=e;x(n),y(0,n,i)}();var o=i.find(".work"),t=i.find(".hire"),s=t.children(".hire__wrapper"),r=i.find(".about"),a=(i.find(".contact"),i.find("input, textarea")),l=$("#contact__popup");$(".side-nav li, .outer-nav li").click(function(){if(!$(this).hasClass("is-active")){var e=$(this),i=e.parent().find(".is-active"),n=e.parent().children().index(i),o=e.parent().children().index(e),t=$(this).parent().children().length-1;x(o),y(n,o,t)}}),$(".cta").click(function(){var e=$(this);e.hasClass("cta--contact")?l.removeClass("off"):e.hasClass("cta--about")?I(2):e.hasClass("cta--hire")&&I(4)});var d=!0,c=null;$(this).on("mousewheel DOMMouseScroll",function(e){if(!$(".outer-nav").hasClass("is-vis")){e.preventDefault();var i=e.originalEvent.wheelDelta?-e.originalEvent.wheelDelta:20*e.originalEvent.detail;i>50&&d?(d=!1,clearTimeout(c),c=setTimeout(function(){d=!0},1e3),S(1)):i<-50&&d&&(d=!1,clearTimeout(c),c=setTimeout(function(){d=!0},1e3),S(-1))}});var u,v,f,h,w,p,m,g=document.getElementById("viewport"),C=new Hammer(g);function S(e){var i=$(".side-nav").find(".is-active"),n=$(".side-nav").children().index(i),o=$(".side-nav").children().length-1,t=0;"swipeup"===e.type||40===e.keyCode||e>0?n!==o?(x(t=n+1),y(n,t,o)):(x(t),y(n,t,o)):("swipedown"===e.type||38===e.keyCode||e<0)&&(0!==n?(x(t=n-1),y(n,t,o)):(x(t=o),y(n,t,o)))}function x(e){$(".side-nav, .outer-nav").children().removeClass("is-active"),$(".side-nav").children().eq(e).addClass("is-active"),$(".outer-nav").children().eq(e).addClass("is-active")}function y(e,i,n){sessionStorage.setItem("activeSectionClass",i),$(".main-content").children().removeClass("section--is-active"),$(".main-content").children().eq(i).addClass("section--is-active"),$(".main-content .section").children().removeClass("section--next section--prev"),e===n&&0===i||0===e&&i===n?$(".main-content .section").children().removeClass("section--next section--prev"):e<i?$(".main-content").children().eq(e).children().addClass("section--next"):$(".main-content").children().eq(e).children().addClass("section--prev"),0!==i&&i!==n?$(".header--cta").addClass("is-active"):$(".header--cta").removeClass("is-active")}function I(e){var i=$(".side-nav").find(".is-active"),n=$(".side-nav").children().index(i),o=$(".side-nav").children().length-1,t=e;x(e),y(n,t,o)}function _(e,i){return e/100*window[i]}function k(){var e=i.find(".l-viewport"),n=o.find(".work__lockup"),t=n.find(".outer-slider"),s=n.find(".inner-slider__item-image-container");e.css({height:_(100,"vh")+"px"}),t.css({height:_(75,"vmin")+"px"}),s.css({height:_(40,"vmin")+"px"}),vw>767&&s.css({height:_(25,"vmin")+"px"}),vw,vw>1199&&t.css({height:_(55,"vmin")+"px"}),vw<400&&s.css({height:_(35,"vmin")+"px"}),vw>vh&&(s.css({"min-height":"auto"}),vw<1200&&vw>vh&&s.css({height:_(30,"vmin")+"px"}))}C.get("swipe").set({direction:Hammer.DIRECTION_VERTICAL}),C.on("swipeup swipedown",function(e){S(e)}),$(document).keyup(function(e){$(".outer-nav").hasClass("is-vis")||(e.preventDefault(),S(e))}),$(window).on("resize",function(){n(),k()}),$(window).on("load",function(){window.hireWrapperHeight=s.height(),window.setInterval(function(){console.log(hireWrapperHeight)},3e3)}),$(".header--nav-toggle").click(function(){$(".perspective").addClass("perspective--modalview"),setTimeout(function(){$(".perspective").addClass("effect-rotate-left--animate")},25),$(".outer-nav, .outer-nav li, .outer-nav--return").addClass("is-vis")}),$(".outer-nav--return, .outer-nav li").click(function(){$(".perspective").removeClass("effect-rotate-left--animate"),setTimeout(function(){$(".perspective").removeClass("perspective--modalview")},400),$(".outer-nav, .outer-nav li, .outer-nav--return").removeClass("is-vis")}),u=r.find(".slider"),v=r.find(".about--options a"),f=new Swiper(u,{init:!0,loop:!0,loopedSlides:4,speed:1500,slidesPerView:"auto",centeredSlides:!0,normalizeSlideIndex:!0,direction:"horizontal",effect:"fade",normalizeSlideIndex:!0,fadeEffect:{crossFade:!0},controller:{by:"slide"}}),v.on("click",function(){var e=$(this).data("slide");f.slideTo(Number(e),1500)}),function(){var e,i=o.find(".outer-slider"),n=o.find(".inner-slider"),t=o.find(".inner-slider__nav--prev"),s=o.find(".inner-slider__nav--next"),r=o.find(".outer-slider__controls"),a=o.find(".outer-slider__nav--prev"),l=o.find(".outer-slider__nav--next"),d=new Swiper(i,{init:!1,loop:!0,loopedSlides:4,slidesPerView:"auto",centeredSlides:!0,normalizeSlideIndex:!0,direction:"vertical",allowTouchMove:!1,effect:"slide",normalizeSlideIndex:!0,controller:{by:"slide"}});d.on("init",function(){console.log("swiper initialized"),e=d.activeIndex,console.log("currentInnerSwiperIndex: "+e)}),d.init();var c,u,v=new Swiper(r,{effect:"slide",normalizeSlideIndex:!0,direction:"horizontal",centeredSlides:!0,loop:!0,loopedSlides:4,slidesPerView:"auto",spaceBetween:35,touchRatio:.2,slideToClickedSlide:!0,normalizeSlideIndex:!0,navigation:{nextEl:l,prevEl:a},controller:{by:"slide"},breakpoints:{700:{slidesPerView:"auto",spaceBetween:0}}});v.controller.control=d,d.controller.control=v,new Swiper(n,{direction:"horizontal",loop:!0,spaceBetween:0,slidesPerView:"auto",loopedSlides:7,loopAdditionalSlides:10,centeredSlides:!0,spaceBetween:0,effect:"coverflow",coverflowEffect:{rotate:40,stretch:0,depth:100,modifier:1,slideShadows:!0},normalizeSlideIndex:!0,slideToClickedSlide:!0}),s.add(t).on("click touchstart",function(i){var n=$(this);if("touchstart"==i.type&&(c=!0,setTimeout(function(){c=!1},400)),!c||"click"!=i.type){var o=d.slides[e],t=$(o).find(".inner-slider")[0];t.swiper,n.hasClass("inner-slider__prev")?t.swiper.slidePrev(400):t.swiper.slideNext(400)}}),d.on("transitionEnd",function(){u||(u=!0,console.log("changed"),e=d.activeIndex,console.log("currentInnerSwiperIndex: "+e),window.setTimeout(function(){u=void 0},200))})}(),a.focusout(function(){""===$(this).val()?$(this).removeClass("has-value"):$(this).addClass("has-value"),window.scrollTo(0,0)}),a.on("focusin",function(){console.log("focusin"),i.addClass("form-field-focused"),s.css({minHeight:hireWrapperHeight+"px"}),t.on("mousewheel DOMMouseScroll",function(e){e.stopPropagation()})}),a.on("focusout",function(){console.log("focusout"),i.removeClass("form-field-focused"),s.css({minHeight:"auto"}),t.off("mousewheel DOMMouseScroll")}),h=$("#startProjectForm"),$("#nameSP"),w=$("#emailSP"),p=$("#service-web"),m=p.closest(".work-request--services"),h.parsley({requiredMessage:"This field is required"}),w.parsley({typeMessage:"Enter a valid e-mail address"}),p.parsley({requiredMessage:"Please select the digital service/s you want us to work on",errorsContainer:function(e){return m},classHandler:function(e){return m}}),h.parsley().on("form:error",function(){alert("validation errors")}).on("form:submit",function(e){return console.log("Hire Form Submitted"),!1}),function(){var e=l,i=e.find("#close-contact-form"),n=e.find("form"),o=e.find("#emailCF");console.log(e),e.on("mousewheel DOMMouseScroll",function(e){console.log(e),e.stopPropagation()});var t=document.getElementById("viewport"),s=new Hammer(t);s.get("swipe").set({direction:Hammer.DIRECTION_VERTICAL}),s.on("swipeup swipedown",function(e){console.log(e)}),i.on("click",function(){e.toggleClass("off")}),n.parsley({requiredMessage:"This field is required"}),o.parsley({typeMessage:"Enter a valid e-mail address"}),n.parsley().on("form:error",function(){alert("validation errors")}).on("form:submit",function(e){return console.log("Contact Form Submitted"),!1})}(),k()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyJdLCJuYW1lcyI6WyIkIiwiZG9jdW1lbnQiLCJyZWFkeSIsIiRkb2N1bWVudCIsInRoaXMiLCJib2R5Iiwidmlld3BvcnREaW1lbnNpb25zIiwid2luZG93IiwidmgiLCJkb2N1bWVudEVsZW1lbnQiLCJjbGllbnRIZWlnaHQiLCJ2dyIsImNsaWVudFdpZHRoIiwid2giLCJoZWlnaHQiLCJ3dyIsIndpZHRoIiwiZGgiLCJkdyIsInZtaW4iLCJ2bWF4IiwiYWRkQ2xhc3MiLCJyZW1vdmVDbGFzcyIsIm9udG91Y2hzdGFydCIsInRvdWNoQXZhaWwiLCJsYXN0S25vd25Qb3MiLCJzZXNzaW9uU3RvcmFnZSIsImdldEl0ZW0iLCJsYXN0SXRlbSIsImNoaWxkcmVuIiwibGVuZ3RoIiwibmV4dFBvcyIsInVwZGF0ZU5hdnMiLCJ1cGRhdGVDb250ZW50IiwidXBkYXRlVG9MYXN0UG9zIiwid29yayIsImZpbmQiLCJoaXJlIiwiaGlyZVdyYXBwZXIiLCJhYm91dCIsImZvcm1GaWVsZHMiLCJjb250YWN0UG9wdXAiLCJjbGljayIsImhhc0NsYXNzIiwiJHRoaXMiLCJjdXJBY3RpdmUiLCJwYXJlbnQiLCJjdXJQb3MiLCJpbmRleCIsImNoYW5nZVNsaWRlVG8iLCJjYW5TY3JvbGwiLCJzY3JvbGxDb250cm9sbGVyIiwib24iLCJlIiwicHJldmVudERlZmF1bHQiLCJkZWx0YSIsIm9yaWdpbmFsRXZlbnQiLCJ3aGVlbERlbHRhIiwiZGV0YWlsIiwiY2xlYXJUaW1lb3V0Iiwic2V0VGltZW91dCIsInVwZGF0ZUhlbHBlciIsImFib3V0U2xpZGVyIiwib3B0aW9ucyIsInN3aXBlciIsInN0YXJ0UHJvamVjdEZvcm0iLCJlbWFpbEZpZWxkIiwid2ViU2VydmljZUZpZWxkIiwic2VydmljZXNDb250IiwidGFyZ2V0RWxlbWVudCIsImdldEVsZW1lbnRCeUlkIiwibWMiLCJIYW1tZXIiLCJwYXJhbSIsInR5cGUiLCJrZXlDb2RlIiwiZXEiLCJzZXRJdGVtIiwidXBkYXRlVG8iLCJnZXRWaWV3cG9ydEJhc2VkSFciLCJwZXJjZW50YWdlIiwidW5pdCIsImFwcGx5Vmlld3BvcnRIZWlnaHRzIiwibF92aWV3cG9ydCIsIndvcmtfX2xvY2t1cCIsIm91dGVyU2xpZGVyIiwiaW5uZXJTbGlkZXJJdGVtSW1hZ2VDb250YWluZXIiLCJjc3MiLCJtaW4taGVpZ2h0IiwiZ2V0Iiwic2V0IiwiZGlyZWN0aW9uIiwiRElSRUNUSU9OX1ZFUlRJQ0FMIiwia2V5dXAiLCJoaXJlV3JhcHBlckhlaWdodCIsInNldEludGVydmFsIiwiY29uc29sZSIsImxvZyIsIlN3aXBlciIsImluaXQiLCJsb29wIiwibG9vcGVkU2xpZGVzIiwic3BlZWQiLCJzbGlkZXNQZXJWaWV3IiwiY2VudGVyZWRTbGlkZXMiLCJub3JtYWxpemVTbGlkZUluZGV4IiwiZWZmZWN0IiwiZmFkZUVmZmVjdCIsImNyb3NzRmFkZSIsImNvbnRyb2xsZXIiLCJieSIsInNsaWRlIiwiZGF0YSIsInNsaWRlVG8iLCJOdW1iZXIiLCJjdXJyZW50SW5uZXJTd2lwZXJJbmRleCIsImlubmVyU2xpZGVyIiwiaW5uZXJTbGlkZXJQcmV2QnRuIiwiaW5uZXJTbGlkZXJOZXh0QnRuIiwib3V0ZXJTbGlkZXJDb250cm9scyIsIm91dGVyU2xpZGVyUHJldkJ0biIsIm91dGVyU2xpZGVyTmV4dEJ0biIsIm91dGVyU3dpcGVyIiwiYWxsb3dUb3VjaE1vdmUiLCJhY3RpdmVJbmRleCIsInRvdWNoIiwib3V0ZXJTd2lwZXJUcmlnZ2VyIiwib3V0ZXJTd2lwZXJDb250cm9scyIsInNwYWNlQmV0d2VlbiIsInRvdWNoUmF0aW8iLCJzbGlkZVRvQ2xpY2tlZFNsaWRlIiwibmF2aWdhdGlvbiIsIm5leHRFbCIsInByZXZFbCIsImJyZWFrcG9pbnRzIiwiNzAwIiwiY29udHJvbCIsImxvb3BBZGRpdGlvbmFsU2xpZGVzIiwiY292ZXJmbG93RWZmZWN0Iiwicm90YXRlIiwic3RyZXRjaCIsImRlcHRoIiwibW9kaWZpZXIiLCJzbGlkZVNoYWRvd3MiLCJhZGQiLCJjdXJJbm5lclN3aXBlckNvbnQiLCJzbGlkZXMiLCJjdXJJbm5lclN3aXBlciIsInNsaWRlUHJldiIsInNsaWRlTmV4dCIsInVuZGVmaW5lZCIsIndvcmtTbGlkZXIiLCJmb2N1c291dCIsInZhbCIsInNjcm9sbFRvIiwibWluSGVpZ2h0Iiwic3RvcFByb3BhZ2F0aW9uIiwib2ZmIiwiY2xvc2VzdCIsInBhcnNsZXkiLCJyZXF1aXJlZE1lc3NhZ2UiLCJ0eXBlTWVzc2FnZSIsImVycm9yc0NvbnRhaW5lciIsIkZpZWxkIiwiY2xhc3NIYW5kbGVyIiwiYWxlcnQiLCJwb3B1cCIsImNsb3NlIiwiY29udGFjdEZvcm0iLCJ0b2dnbGVDbGFzcyJdLCJtYXBwaW5ncyI6IkFBRUFBLEVBQUFDLFVBQUFDLE1BQUEsV0FFQSxJQUFBQyxFQUFBQyxLQUNBQyxFQUFBTCxFQUFBLFFBeUJBLFNBQUFNLElBRUFDLE9BQUFDLEdBQUFMLEVBQUFNLGdCQUFBQyxhQUNBSCxPQUFBSSxHQUFBUixFQUFBTSxnQkFBQUcsWUFDQUwsT0FBQU0sR0FBQWIsRUFBQU8sUUFBQU8sU0FDQVAsT0FBQVEsR0FBQWYsRUFBQU8sUUFBQVMsUUFDQVQsT0FBQVUsR0FBQWpCLEVBQUFDLFVBQUFhLFNBQ0FQLE9BQUFXLEdBQUFsQixFQUFBQyxVQUFBZSxRQUNBVCxPQUFBWSxLQUFBWCxHQUFBRyxHQUFBQSxHQUFBSCxHQUNBRCxPQUFBYSxLQUFBWixHQUFBRyxHQUFBQSxHQUFBSCxHQUlBRyxHQUFBLEtBQ0FOLEVBQUFnQixTQUFBLFVBRUFoQixFQUFBaUIsWUFBQSxVQXZDQW5CLEVBQUFvQixjQUNBaEIsT0FBQWlCLFlBQUEsRUFDQW5CLEVBQUFnQixTQUFBLFdBR0FkLE9BQUFpQixZQUFBLEVBQ0FuQixFQUFBaUIsWUFBQSxVQXNDQWhCLElBK0dBLFdBRUEsSUFBQW1CLEVBQUFDLGVBQUFDLFFBQUEsc0JBRUEsS0FBQUYsRUFBQSxPQUNBLElBQ0FHLEVBQUE1QixFQUFBLGFBQUE2QixXQUFBQyxPQUFBLEVBQ0FDLEVB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QWlCQU8sRUFBQVQsVUFBQTNHLEdBQUEsYUFBQSxXQUVBaUgsTUFBQSx1QkFFQWpILEdBQUEsY0FBQSxTQUFBQyxHQVdBLE9BVEEyQyxRQUFBQyxJQUFBLDJCQVNBLElBbUtBdUUsR0FFQXRGIiwiZmlsZSI6InNjcmlwdC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBAY29kZWtpdC1wcmVwZW5kIFwiL3ZlbmRvci9oYW1tZXItMi4wLjguanNcIjtcclxuXHJcbiQoIGRvY3VtZW50ICkucmVhZHkoZnVuY3Rpb24oKSB7XHJcblxyXG4gIHZhciAkZG9jdW1lbnQgPSB0aGlzO1xyXG4gIHZhciBib2R5ID0gJCgnYm9keScpO1xyXG5cclxuICBpZigkZG9jdW1lbnQub250b3VjaHN0YXJ0KXtcclxuICAgIHdpbmRvdy50b3VjaEF2YWlsID0gdHJ1ZTtcclxuICAgIGJvZHkuYWRkQ2xhc3MoJ3RvdWNoJyk7XHJcblxyXG4gIH1lbHNle1xyXG4gICAgd2luZG93LnRvdWNoQXZhaWwgPSBmYWxzZTtcclxuICAgIGJvZHkucmVtb3ZlQ2xhc3MoJ3RvdWNoJyk7XHJcblxyXG4gIH1cclxuXHJcblxyXG5cclxuLypcclxuXHJcbnNldEludGVydmFsKGZ1bmN0aW9uKCl7XHJcbiAgYWxlcnQoXCIkKGRvY3VtZW50KS5jbGllbnRIZWlnaHQ6IFwiICsgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCk7XHJcbiAgYWxlcnQoXCIkKGRvY3VtZW50KS5pbm5lckhlaWdodDogXCIgKyAkKGRvY3VtZW50KS5pbm5lckhlaWdodCgpKTtcclxufSw1MDAwKTtcclxuXHJcbiovXHJcblxyXG5cclxuXHJcbiAgZnVuY3Rpb24gdmlld3BvcnREaW1lbnNpb25zKCl7XHJcblxyXG4gICAgd2luZG93LnZoID0gJGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQ7XHJcbiAgICB3aW5kb3cudncgPSAkZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoO1xyXG4gICAgd2luZG93LndoID0gJCh3aW5kb3cpLmhlaWdodCgpO1xyXG4gICAgd2luZG93Lnd3ID0gJCh3aW5kb3cpLndpZHRoKCk7XHJcbiAgICB3aW5kb3cuZGggPSAkKGRvY3VtZW50KS5oZWlnaHQoKTtcclxuICAgIHdpbmRvdy5kdyA9ICQoZG9jdW1lbnQpLndpZHRoKCk7XHJcbiAgICB3aW5kb3cudm1pbiA9IHZoID4gdncgPyB2dyA6IHZoO1xyXG4gICAgd2luZG93LnZtYXggPSB2aCA8IHZ3ID8gdncgOiB2aDtcclxuXHJcblxyXG5cclxuICAgIGlmKHZ3PCAxMDI0KXtcclxuICAgICAgYm9keS5hZGRDbGFzcygnbW9iaWxlJyk7XHJcbiAgICB9ZWxzZXtcclxuICAgICAgYm9keS5yZW1vdmVDbGFzcygnbW9iaWxlJyk7XHJcbiAgICB9XHJcblxyXG4gIH1cclxuXHJcbiAgdmlld3BvcnREaW1lbnNpb25zKCk7XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbiAgdXBkYXRlVG9MYXN0UG9zKCk7IC8vIHVwZGF0ZSB0byB0aGUgbGFzdCBrbm93biBzZWN0aW9uXHJcblxyXG4gIFxyXG4gIHZhciB3b3JrID0gYm9keS5maW5kKCcud29yaycpO1xyXG4gIHZhciBoaXJlID0gYm9keS5maW5kKCcuaGlyZScpO1xyXG5cclxuICB2YXIgaGlyZVdyYXBwZXIgPSBoaXJlLmNoaWxkcmVuKCcuaGlyZV9fd3JhcHBlcicpO1xyXG5cclxuXHJcbiAgdmFyIGFib3V0ID0gYm9keS5maW5kKCcuYWJvdXQnKTtcclxuICB2YXIgY29udGFjdCA9IGJvZHkuZmluZCgnLmNvbnRhY3QnKTtcclxuICB2YXIgZm9ybUZpZWxkcyA9IGJvZHkuZmluZCgnaW5wdXQsIHRleHRhcmVhJyk7XHJcbiAgdmFyIGNvbnRhY3RQb3B1cCA9ICQoJyNjb250YWN0X19wb3B1cCcpO1xyXG5cclxuICAvLyBuYXYgbWVudSBsaW5rcyBjbGljayBoYW5kbGVyXHJcbiAgJCgnLnNpZGUtbmF2IGxpLCAub3V0ZXItbmF2IGxpJykuY2xpY2soZnVuY3Rpb24oKXtcclxuXHJcbiAgICBpZiAoISgkKHRoaXMpLmhhc0NsYXNzKCdpcy1hY3RpdmUnKSkpIHtcclxuXHJcbiAgICAgIHZhciAkdGhpcyA9ICQodGhpcyksXHJcbiAgICAgICAgICBjdXJBY3RpdmUgPSAkdGhpcy5wYXJlbnQoKS5maW5kKCcuaXMtYWN0aXZlJyksXHJcbiAgICAgICAgICBjdXJQb3MgPSAkdGhpcy5wYXJlbnQoKS5jaGlsZHJlbigpLmluZGV4KGN1ckFjdGl2ZSksXHJcbiAgICAgICAgICBuZXh0UG9zID0gJHRoaXMucGFyZW50KCkuY2hpbGRyZW4oKS5pbmRleCgkdGhpcyksXHJcbiAgICAgICAgICBsYXN0SXRlbSA9ICQodGhpcykucGFyZW50KCkuY2hpbGRyZW4oKS5sZW5ndGggLSAxO1xyXG5cclxuICAgICAgdXBkYXRlTmF2cyhuZXh0UG9zKTtcclxuICAgICAgdXBkYXRlQ29udGVudChjdXJQb3MsIG5leHRQb3MsIGxhc3RJdGVtKTtcclxuXHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIC8vIGN0YSBidXR0b25zXHJcbiAgJCgnLmN0YScpLmNsaWNrKGZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgJHRoaXMgPSAkKHRoaXMpO1xyXG5cclxuICAgIGlmICgkdGhpcy5oYXNDbGFzcygnY3RhLS1jb250YWN0JykpIHtcclxuICAgIFxyXG4gICAgICBjb250YWN0UG9wdXAucmVtb3ZlQ2xhc3MoJ29mZicpO1xyXG5cclxuICAgIH1lbHNlIGlmKCR0aGlzLmhhc0NsYXNzKCdjdGEtLWFib3V0Jykpe1xyXG4gICAgICBjaGFuZ2VTbGlkZVRvKDIpOyAvLyBhYm91dCBzZWN0aW9uIGlzIG9uIGluZGV4IC0gMlxyXG4gICAgfWVsc2UgaWYoJHRoaXMuaGFzQ2xhc3MoJ2N0YS0taGlyZScpKXtcclxuICAgICAgY2hhbmdlU2xpZGVUbyg0KTsgLy8gaGlyZSB1cyBzZWN0aW9uIGlzIG9uIGluZGV4IC0gNFxyXG4gICAgfVxyXG5cclxuICB9KTtcclxuXHJcblxyXG4gIC8qIFNUQVJUIC0gZnVuY3Rpb25zIGZvciBuYXZpZ2F0aW5nIHRocm91Z2ggc2xpZGVzICovXHJcblxyXG4gIC8vIERPTU1vdXNlU2Nyb2xsIGluY2x1ZGVkIGZvciBmaXJlZm94IHN1cHBvcnRcclxuICB2YXIgY2FuU2Nyb2xsID0gdHJ1ZSxcclxuICAgICAgc2Nyb2xsQ29udHJvbGxlciA9IG51bGw7XHJcblxyXG4gICQodGhpcykub24oJ21vdXNld2hlZWwgRE9NTW91c2VTY3JvbGwnLCBmdW5jdGlvbihlKXtcclxuXHJcbiAgICBpZiAoISgkKCcub3V0ZXItbmF2JykuaGFzQ2xhc3MoJ2lzLXZpcycpKSkge1xyXG5cclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgdmFyIGRlbHRhID0gKGUub3JpZ2luYWxFdmVudC53aGVlbERlbHRhKSA/IC1lLm9yaWdpbmFsRXZlbnQud2hlZWxEZWx0YSA6IGUub3JpZ2luYWxFdmVudC5kZXRhaWwgKiAyMDtcclxuXHJcbiAgICAgIGlmIChkZWx0YSA+IDUwICYmIGNhblNjcm9sbCkge1xyXG4gICAgICAgIGNhblNjcm9sbCA9IGZhbHNlO1xyXG4gICAgICAgIGNsZWFyVGltZW91dChzY3JvbGxDb250cm9sbGVyKTtcclxuICAgICAgICBzY3JvbGxDb250cm9sbGVyID0gc2V0VGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgY2FuU2Nyb2xsID0gdHJ1ZTtcclxuICAgICAgICB9LCAxMDAwKTtcclxuICAgICAgICB1cGRhdGVIZWxwZXIoMSk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSBpZiAoZGVsdGEgPCAtNTAgJiYgY2FuU2Nyb2xsKSB7XHJcbiAgICAgICAgY2FuU2Nyb2xsID0gZmFsc2U7XHJcbiAgICAgICAgY2xlYXJUaW1lb3V0KHNjcm9sbENvbnRyb2xsZXIpO1xyXG4gICAgICAgIHNjcm9sbENvbnRyb2xsZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICBjYW5TY3JvbGwgPSB0cnVlO1xyXG4gICAgICAgIH0sIDEwMDApO1xyXG4gICAgICAgIHVwZGF0ZUhlbHBlcigtMSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICB9XHJcbiAgXHJcbiAgfSk7XHJcbiAgXHJcblxyXG5cclxuICAvLyBzd2lwZSBzdXBwb3J0IGZvciB0b3VjaCBkZXZpY2VzXHJcbiAgdmFyIHRhcmdldEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndmlld3BvcnQnKSxcclxuICAgICAgbWMgPSBuZXcgSGFtbWVyKHRhcmdldEVsZW1lbnQpO1xyXG4gIG1jLmdldCgnc3dpcGUnKS5zZXQoeyBkaXJlY3Rpb246IEhhbW1lci5ESVJFQ1RJT05fVkVSVElDQUwgfSk7XHJcbiAgbWMub24oJ3N3aXBldXAgc3dpcGVkb3duJywgZnVuY3Rpb24oZSkge1xyXG5cclxuICAgIHVwZGF0ZUhlbHBlcihlKTtcclxuXHJcbiAgfSk7XHJcblxyXG4gICQoZG9jdW1lbnQpLmtleXVwKGZ1bmN0aW9uKGUpe1xyXG5cclxuICAgIGlmICghKCQoJy5vdXRlci1uYXYnKS5oYXNDbGFzcygnaXMtdmlzJykpKSB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdXBkYXRlSGVscGVyKGUpO1xyXG4gICAgfVxyXG5cclxuICB9KTtcclxuXHJcbiAgZnVuY3Rpb24gdXBkYXRlVG9MYXN0UG9zKCl7XHJcbiAgICBcclxuICAgIHZhciBsYXN0S25vd25Qb3MgPSBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCdhY3RpdmVTZWN0aW9uQ2xhc3MnKTtcclxuICAgIFxyXG4gICAgaWYgKCEoK2xhc3RLbm93blBvcykpIHJldHVybjtcclxuICAgIHZhciBjdXJQb3MgPSAwLFxyXG4gICAgICAgIGxhc3RJdGVtID0gJCgnLnNpZGUtbmF2JykuY2hpbGRyZW4oKS5sZW5ndGggLSAxLFxyXG4gICAgICAgIG5leHRQb3MgPSBsYXN0S25vd25Qb3M7XHJcblxyXG4gICAgICAvKmlmIChjdXJQb3MgPT0gMCl7XHJcbiAgICAgICAgbmV4dFBvcyA9IGN1clBvcyAtIDE7Ki9cclxuICAgICAgICB1cGRhdGVOYXZzKG5leHRQb3MpO1xyXG4gICAgICAgIHVwZGF0ZUNvbnRlbnQoY3VyUG9zLCBuZXh0UG9zLCBsYXN0SXRlbSk7XHJcbiAgICAgIC8qfVxyXG4gICAgICBlbHNlIGlmIChjdXJQb3MgIT09IGxhc3RJdGVtKSB7XHJcbiAgICAgICAgbmV4dFBvcyA9IGN1clBvcyArIDE7XHJcbiAgICAgICAgdXBkYXRlTmF2cyhuZXh0UG9zKTtcclxuICAgICAgICB1cGRhdGVDb250ZW50KGN1clBvcywgbmV4dFBvcywgbGFzdEl0ZW0pO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgIHVwZGF0ZU5hdnMobmV4dFBvcyk7XHJcbiAgICAgICAgdXBkYXRlQ29udGVudChjdXJQb3MsIG5leHRQb3MsIGxhc3RJdGVtKTtcclxuICAgICAgfSovXHJcbiAgICAgICBcclxuICB9XHJcblxyXG4gIC8vIGRldGVybWluZSBzY3JvbGwsIHN3aXBlLCBhbmQgYXJyb3cga2V5IGRpcmVjdGlvblxyXG4gIGZ1bmN0aW9uIHVwZGF0ZUhlbHBlcihwYXJhbSkge1xyXG5cclxuICAgIHZhciBjdXJBY3RpdmUgPSAkKCcuc2lkZS1uYXYnKS5maW5kKCcuaXMtYWN0aXZlJyksXHJcbiAgICAgICAgY3VyUG9zID0gJCgnLnNpZGUtbmF2JykuY2hpbGRyZW4oKS5pbmRleChjdXJBY3RpdmUpLFxyXG4gICAgICAgIGxhc3RJdGVtID0gJCgnLnNpZGUtbmF2JykuY2hpbGRyZW4oKS5sZW5ndGggLSAxLFxyXG4gICAgICAgIG5leHRQb3MgPSAwO1xyXG5cclxuICAgIGlmIChwYXJhbS50eXBlID09PSBcInN3aXBldXBcIiB8fCBwYXJhbS5rZXlDb2RlID09PSA0MCB8fCBwYXJhbSA+IDApIHtcclxuICAgICAgaWYgKGN1clBvcyAhPT0gbGFzdEl0ZW0pIHtcclxuICAgICAgICBuZXh0UG9zID0gY3VyUG9zICsgMTtcclxuICAgICAgICB1cGRhdGVOYXZzKG5leHRQb3MpO1xyXG4gICAgICAgIHVwZGF0ZUNvbnRlbnQoY3VyUG9zLCBuZXh0UG9zLCBsYXN0SXRlbSk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgdXBkYXRlTmF2cyhuZXh0UG9zKTtcclxuICAgICAgICB1cGRhdGVDb250ZW50KGN1clBvcywgbmV4dFBvcywgbGFzdEl0ZW0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChwYXJhbS50eXBlID09PSBcInN3aXBlZG93blwiIHx8IHBhcmFtLmtleUNvZGUgPT09IDM4IHx8IHBhcmFtIDwgMCl7XHJcbiAgICAgIGlmIChjdXJQb3MgIT09IDApe1xyXG4gICAgICAgIG5leHRQb3MgPSBjdXJQb3MgLSAxO1xyXG4gICAgICAgIHVwZGF0ZU5hdnMobmV4dFBvcyk7XHJcbiAgICAgICAgdXBkYXRlQ29udGVudChjdXJQb3MsIG5leHRQb3MsIGxhc3RJdGVtKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICBuZXh0UG9zID0gbGFzdEl0ZW07XHJcbiAgICAgICAgdXBkYXRlTmF2cyhuZXh0UG9zKTtcclxuICAgICAgICB1cGRhdGVDb250ZW50KGN1clBvcywgbmV4dFBvcywgbGFzdEl0ZW0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gIH1cclxuXHJcblxyXG5cclxuICAvLyBzeW5jIHNpZGUgYW5kIG91dGVyIG5hdmlnYXRpb25zXHJcbiAgZnVuY3Rpb24gdXBkYXRlTmF2cyhuZXh0UG9zKSB7ICAgICAgXHJcblxyXG4gICAgJCgnLnNpZGUtbmF2LCAub3V0ZXItbmF2JykuY2hpbGRyZW4oKS5yZW1vdmVDbGFzcygnaXMtYWN0aXZlJyk7XHJcbiAgICAkKCcuc2lkZS1uYXYnKS5jaGlsZHJlbigpLmVxKG5leHRQb3MpLmFkZENsYXNzKCdpcy1hY3RpdmUnKTtcclxuICAgICQoJy5vdXRlci1uYXYnKS5jaGlsZHJlbigpLmVxKG5leHRQb3MpLmFkZENsYXNzKCdpcy1hY3RpdmUnKTtcclxuXHJcbiAgfVxyXG5cclxuXHJcbiAgLy8gdXBkYXRlIG1haW4gY29udGVudCBhcmVhXHJcbiAgZnVuY3Rpb24gdXBkYXRlQ29udGVudChjdXJQb3MsIG5leHRQb3MsIGxhc3RJdGVtKSB7XHJcblxyXG4gICAgLy8gc2F2ZSB0aGUgbmV4dCBhY3RpdmUgc2VjdGlvbiBmb3IgdGhlIHNlc3Npb24gdG8gcmVzdG9yZSBvbiByZWxvYWRcclxuICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oJ2FjdGl2ZVNlY3Rpb25DbGFzcycsbmV4dFBvcyk7IFxyXG5cclxuICAgICQoJy5tYWluLWNvbnRlbnQnKS5jaGlsZHJlbigpLnJlbW92ZUNsYXNzKCdzZWN0aW9uLS1pcy1hY3RpdmUnKTtcclxuICAgICQoJy5tYWluLWNvbnRlbnQnKS5jaGlsZHJlbigpLmVxKG5leHRQb3MpLmFkZENsYXNzKCdzZWN0aW9uLS1pcy1hY3RpdmUnKTtcclxuICAgICQoJy5tYWluLWNvbnRlbnQgLnNlY3Rpb24nKS5jaGlsZHJlbigpLnJlbW92ZUNsYXNzKCdzZWN0aW9uLS1uZXh0IHNlY3Rpb24tLXByZXYnKTtcclxuXHJcbiAgICBpZiAoY3VyUG9zID09PSBsYXN0SXRlbSAmJiBuZXh0UG9zID09PSAwIHx8IGN1clBvcyA9PT0gMCAmJiBuZXh0UG9zID09PSBsYXN0SXRlbSkge1xyXG4gICAgICAkKCcubWFpbi1jb250ZW50IC5zZWN0aW9uJykuY2hpbGRyZW4oKS5yZW1vdmVDbGFzcygnc2VjdGlvbi0tbmV4dCBzZWN0aW9uLS1wcmV2Jyk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChjdXJQb3MgPCBuZXh0UG9zKSB7XHJcbiAgICAgICQoJy5tYWluLWNvbnRlbnQnKS5jaGlsZHJlbigpLmVxKGN1clBvcykuY2hpbGRyZW4oKS5hZGRDbGFzcygnc2VjdGlvbi0tbmV4dCcpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICQoJy5tYWluLWNvbnRlbnQnKS5jaGlsZHJlbigpLmVxKGN1clBvcykuY2hpbGRyZW4oKS5hZGRDbGFzcygnc2VjdGlvbi0tcHJldicpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChuZXh0UG9zICE9PSAwICYmIG5leHRQb3MgIT09IGxhc3RJdGVtKSB7XHJcbiAgICAgICQoJy5oZWFkZXItLWN0YScpLmFkZENsYXNzKCdpcy1hY3RpdmUnKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAkKCcuaGVhZGVyLS1jdGEnKS5yZW1vdmVDbGFzcygnaXMtYWN0aXZlJyk7XHJcbiAgICB9XHJcblxyXG4gIH1cclxuXHJcblxyXG4gIGZ1bmN0aW9uIG91dGVyTmF2KCkge1xyXG5cclxuICAgIC8qIE9wZW5zIHRoZSBuYXZpZ2F0aW9uIG1lbnUgKi9cclxuICAgICQoJy5oZWFkZXItLW5hdi10b2dnbGUnKS5jbGljayhmdW5jdGlvbigpe1xyXG5cclxuICAgICAgJCgnLnBlcnNwZWN0aXZlJykuYWRkQ2xhc3MoJ3BlcnNwZWN0aXZlLS1tb2RhbHZpZXcnKTtcclxuICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgICQoJy5wZXJzcGVjdGl2ZScpLmFkZENsYXNzKCdlZmZlY3Qtcm90YXRlLWxlZnQtLWFuaW1hdGUnKTtcclxuICAgICAgfSwgMjUpO1xyXG4gICAgICAkKCcub3V0ZXItbmF2LCAub3V0ZXItbmF2IGxpLCAub3V0ZXItbmF2LS1yZXR1cm4nKS5hZGRDbGFzcygnaXMtdmlzJyk7XHJcblxyXG4gICAgfSk7XHJcblxyXG4gICAgLyogQ2xvc2VzIHRoZSBuYXZpZ2F0aW9uIG1lbnUgb24gY2xpY2sgb2YgYW4gaXRlbSovICAgIFxyXG4gICAgJCgnLm91dGVyLW5hdi0tcmV0dXJuLCAub3V0ZXItbmF2IGxpJykuY2xpY2soZnVuY3Rpb24oKXtcclxuXHJcbiAgICAgICQoJy5wZXJzcGVjdGl2ZScpLnJlbW92ZUNsYXNzKCdlZmZlY3Qtcm90YXRlLWxlZnQtLWFuaW1hdGUnKTtcclxuICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgICQoJy5wZXJzcGVjdGl2ZScpLnJlbW92ZUNsYXNzKCdwZXJzcGVjdGl2ZS0tbW9kYWx2aWV3Jyk7XHJcbiAgICAgIH0sIDQwMCk7XHJcbiAgICAgICQoJy5vdXRlci1uYXYsIC5vdXRlci1uYXYgbGksIC5vdXRlci1uYXYtLXJldHVybicpLnJlbW92ZUNsYXNzKCdpcy12aXMnKTtcclxuXHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBjaGFuZ2VTbGlkZVRvKHVwZGF0ZVRvKXtcclxuXHJcbiAgICAgIHZhciBjdXJBY3RpdmUgPSAkKCcuc2lkZS1uYXYnKS5maW5kKCcuaXMtYWN0aXZlJyksXHJcbiAgICAgICAgICBjdXJQb3MgPSAkKCcuc2lkZS1uYXYnKS5jaGlsZHJlbigpLmluZGV4KGN1ckFjdGl2ZSksXHJcbiAgICAgICAgICBsYXN0SXRlbSA9ICQoJy5zaWRlLW5hdicpLmNoaWxkcmVuKCkubGVuZ3RoIC0gMSxcclxuICAgICAgICAgIG5leHRQb3MgPSB1cGRhdGVUbztcclxuXHJcbiAgICAgIC8qY29uc29sZS5sb2coJ2N1ckFjdGl2ZTogJyArIGN1ckFjdGl2ZSk7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdjdXJQb3M6ICcrY3VyUG9zKTtcclxuICAgICAgY29uc29sZS5sb2coJ2xhc3RJdGVtOiAnK2xhc3RJdGVtKTtcclxuICAgICAgY29uc29sZS5sb2coJ25leHRQb3M6ICcrbmV4dFBvcyk7Ki9cclxuICAgICAgdXBkYXRlTmF2cyh1cGRhdGVUbyk7XHJcbiAgICAgIHVwZGF0ZUNvbnRlbnQoY3VyUG9zLCBuZXh0UG9zLCBsYXN0SXRlbSk7XHJcblxyXG4gIH1cclxuXHJcblxyXG4gIC8qIEVORCAtICBmdW5jdGlvbnMgZm9yIG5hdmlnYXRpbmcgdGhyb3VnaCBzbGlkZXMgKi9cclxuXHJcblxyXG4gIGZ1bmN0aW9uIGFib3V0U2xpZGVyKCkge1xyXG5cclxuICAgIHZhciBhYm91dFNsaWRlciA9IGFib3V0LmZpbmQoJy5zbGlkZXInKTtcclxuICAgIHZhciBvcHRpb25zID0gYWJvdXQuZmluZCgnLmFib3V0LS1vcHRpb25zIGEnKTtcclxuXHJcbiAgICB2YXIgc2xpZGluZ1NwZWVkID0gMTUwMDtcclxuXHJcbiAgICAvKlxyXG4gICAgdmFyIG91dGVyU2xpZGVyUHJldkJ0biA9IG91dGVyU2xpZGVyLnNpYmxpbmdzKCcuc2xpZGVyLS1wcmV2Jyk7XHJcbiAgICB2YXIgb3V0ZXJTbGlkZXJOZXh0QnRuID0gb3V0ZXJTbGlkZXIuc2libGluZ3MoJy5zbGlkZXItLW5leHQnKTtcclxuICAgICovXHJcblxyXG4gICAgLyogdmFyIGlubmVyU2xpZGVyID0gd29yay5maW5kKCcuaW5uZXItc2xpZGVyJyk7XHJcblxyXG4gICAgdmFyIGlubmVyU2xpZGVyUHJldkJ0biA9IHdvcmsuZmluZCgnLmlubmVyLXNsaWRlcl9fbmF2LS1wcmV2Jyk7XHJcbiAgICB2YXIgaW5uZXJTbGlkZXJOZXh0QnRuID0gd29yay5maW5kKCcuaW5uZXItc2xpZGVyX19uYXYtLW5leHQnKTtcclxuXHJcbiAgICB2YXIgb3V0ZXJTbGlkZXJDb250cm9scyA9IHdvcmsuZmluZCgnLm91dGVyLXNsaWRlcl9fY29udHJvbHMnKTtcclxuXHJcbiAgICB2YXIgb3V0ZXJTbGlkZXJQcmV2QnRuID0gd29yay5maW5kKCcub3V0ZXItc2xpZGVyX19uYXYtLXByZXYnKTtcclxuICAgIHZhciBvdXRlclNsaWRlck5leHRCdG4gPSB3b3JrLmZpbmQoJy5vdXRlci1zbGlkZXJfX25hdi0tbmV4dCcpO1xyXG5cclxuICAgICovXHJcblxyXG4gICAgLy8gaW5pdCBzd2lwZXIgc2xpZGVyIGZvciBvdXRlciBzbGlkZXNcclxuICAgIHZhciBzd2lwZXIgPSBuZXcgU3dpcGVyIChhYm91dFNsaWRlciwge1xyXG4gICAgICBpbml0OiB0cnVlLFxyXG4gICAgICBsb29wOiB0cnVlLFxyXG4gICAgICBsb29wZWRTbGlkZXM6IDQsXHJcbiAgICAgIHNwZWVkOiBzbGlkaW5nU3BlZWQsXHJcbiAgICAgIHNsaWRlc1BlclZpZXc6ICdhdXRvJyxcclxuICAgICAgY2VudGVyZWRTbGlkZXM6IHRydWUsXHJcbiAgICAgIG5vcm1hbGl6ZVNsaWRlSW5kZXg6IHRydWUsXHJcbiAgICAgIGRpcmVjdGlvbjogJ2hvcml6b250YWwnLFxyXG4gICAgICBlZmZlY3Q6ICdmYWRlJyxcclxuICAgICAgbm9ybWFsaXplU2xpZGVJbmRleDogdHJ1ZSxcclxuICAgICAgZmFkZUVmZmVjdDoge1xyXG4gICAgICAgIGNyb3NzRmFkZTogdHJ1ZVxyXG4gICAgICB9LFxyXG4gICAgICBjb250cm9sbGVyOntcclxuICAgICAgICBieTogJ3NsaWRlJ1xyXG4gICAgICB9XHJcbiAgICAgIC8qLFxyXG4gICAgICBoYXNoTmF2aWdhdGlvbjogdHJ1ZSxcclxuICAgICAgaGFzaE5hdmlnYXRpb246IHtcclxuICAgICAgICB3YXRjaFN0YXRlOiB0cnVlXHJcbiAgICAgIH0qL1xyXG4gICAgfSk7XHJcblxyXG5cclxuICAgIG9wdGlvbnMub24oJ2NsaWNrJyxmdW5jdGlvbigpe1xyXG4gICAgICB2YXIgJHRoaXMgPSAkKHRoaXMpO1xyXG4gICAgICB2YXIgc2xpZGUgPSAkdGhpcy5kYXRhKCdzbGlkZScpO1xyXG5cclxuICAgICAgc3dpcGVyLnNsaWRlVG8oTnVtYmVyKHNsaWRlKSwgc2xpZGluZ1NwZWVkKTtcclxuXHJcblxyXG4gICAgfSk7XHJcblxyXG4gIH0gLy8gRU5EIG9mIGFib3V0U2xpZGVyIEZ1bmNcclxuXHJcblxyXG5cclxuXHJcbiAgZnVuY3Rpb24gd29ya1NsaWRlcigpIHtcclxuICAgIHZhciBhY3RpdmVJbm5lclNsaWRlcjtcclxuXHJcbiAgICB2YXIgb3V0ZXJTbGlkZXIgPSB3b3JrLmZpbmQoJy5vdXRlci1zbGlkZXInKTtcclxuICAgICAgLyp2YXIgb3V0ZXJTbGlkZXJQcmV2QnRuID0gb3V0ZXJTbGlkZXIuc2libGluZ3MoJy5zbGlkZXItLXByZXYnKTtcclxuICAgICAgdmFyIG91dGVyU2xpZGVyTmV4dEJ0biA9IG91dGVyU2xpZGVyLnNpYmxpbmdzKCcuc2xpZGVyLS1uZXh0Jyk7XHJcbiAgICAgICovXHJcbiAgICB2YXIgaW5uZXJTbGlkZXIgPSB3b3JrLmZpbmQoJy5pbm5lci1zbGlkZXInKTtcclxuXHJcbiAgICB2YXIgaW5uZXJTbGlkZXJQcmV2QnRuID0gd29yay5maW5kKCcuaW5uZXItc2xpZGVyX19uYXYtLXByZXYnKTtcclxuICAgIHZhciBpbm5lclNsaWRlck5leHRCdG4gPSB3b3JrLmZpbmQoJy5pbm5lci1zbGlkZXJfX25hdi0tbmV4dCcpO1xyXG5cclxuICAgIHZhciBvdXRlclNsaWRlckNvbnRyb2xzID0gd29yay5maW5kKCcub3V0ZXItc2xpZGVyX19jb250cm9scycpO1xyXG5cclxuICAgIHZhciBvdXRlclNsaWRlclByZXZCdG4gPSB3b3JrLmZpbmQoJy5vdXRlci1zbGlkZXJfX25hdi0tcHJldicpO1xyXG4gICAgdmFyIG91dGVyU2xpZGVyTmV4dEJ0biA9IHdvcmsuZmluZCgnLm91dGVyLXNsaWRlcl9fbmF2LS1uZXh0Jyk7XHJcblxyXG4gICAgXHJcblxyXG4gICAgLy8gaW5pdCBzd2lwZXIgc2xpZGVyIGZvciBvdXRlciBzbGlkZXNcclxuICAgIHZhciBvdXRlclN3aXBlciA9IG5ldyBTd2lwZXIgKG91dGVyU2xpZGVyLCB7XHJcbiAgICAgIGluaXQ6IGZhbHNlLFxyXG4gICAgICBsb29wOiB0cnVlLFxyXG4gICAgICBsb29wZWRTbGlkZXM6IDQsXHJcbiAgICAgIHNsaWRlc1BlclZpZXc6ICdhdXRvJyxcclxuICAgICAgY2VudGVyZWRTbGlkZXM6IHRydWUsXHJcbiAgICAgIG5vcm1hbGl6ZVNsaWRlSW5kZXg6IHRydWUsXHJcbiAgICAgIGRpcmVjdGlvbjogJ3ZlcnRpY2FsJyxcclxuICAgICAgYWxsb3dUb3VjaE1vdmU6IGZhbHNlLFxyXG4gICAgICBlZmZlY3Q6ICdzbGlkZScsXHJcbiAgICAgIG5vcm1hbGl6ZVNsaWRlSW5kZXg6IHRydWUsXHJcbiAgICAgIC8qZmFkZUVmZmVjdDoge1xyXG4gICAgICAgIGNyb3NzRmFkZTogdHJ1ZVxyXG4gICAgICB9LCovXHJcbiAgICAgIGNvbnRyb2xsZXI6e1xyXG4gICAgICAgIGJ5OiAnc2xpZGUnXHJcbiAgICAgIH1cclxuICAgICAgLyosXHJcbiAgICAgIGhhc2hOYXZpZ2F0aW9uOiB0cnVlLFxyXG4gICAgICBoYXNoTmF2aWdhdGlvbjoge1xyXG4gICAgICAgIHdhdGNoU3RhdGU6IHRydWVcclxuICAgICAgfSovXHJcbiAgICB9KTtcclxuXHJcblxyXG4gICAgLy8gZGV0ZXJtaW5pbmcgY3VycmVudCBpbm5lciBzd2lwZXIgaW5kZXhcclxuICAgIHZhciBjdXJyZW50SW5uZXJTd2lwZXJJbmRleDtcclxuICAgIG91dGVyU3dpcGVyLm9uKCdpbml0JyxmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdzd2lwZXIgaW5pdGlhbGl6ZWQnKTtcclxuICAgICAgY3VycmVudElubmVyU3dpcGVySW5kZXggPSBvdXRlclN3aXBlci5hY3RpdmVJbmRleDtcclxuICAgICAgY29uc29sZS5sb2coJ2N1cnJlbnRJbm5lclN3aXBlckluZGV4OiAnKyBjdXJyZW50SW5uZXJTd2lwZXJJbmRleCk7XHJcbiAgICB9KSxcclxuXHJcbiAgICBvdXRlclN3aXBlci5pbml0KCk7IC8vIGluaXQgb3V0ZXJTd2lwZXJcclxuXHJcbiAgICB2YXIgb3V0ZXJTd2lwZXJDb250cm9scyA9IG5ldyBTd2lwZXIob3V0ZXJTbGlkZXJDb250cm9scywge1xyXG4gICAgICBlZmZlY3Q6ICdzbGlkZScsXHJcbiAgICAgIG5vcm1hbGl6ZVNsaWRlSW5kZXg6IHRydWUsXHJcbiAgICAgIGRpcmVjdGlvbjogJ2hvcml6b250YWwnLFxyXG4gICAgICBjZW50ZXJlZFNsaWRlczogdHJ1ZSxcclxuICAgICAgbG9vcDogdHJ1ZSxcclxuICAgICAgbG9vcGVkU2xpZGVzOiA0LFxyXG4gICAgICBzbGlkZXNQZXJWaWV3OiAnYXV0bycsXHJcbiAgICAgIHNwYWNlQmV0d2VlbjogMzUsXHJcbiAgICAgIHRvdWNoUmF0aW86IDAuMixcclxuICAgICAgc2xpZGVUb0NsaWNrZWRTbGlkZTogdHJ1ZSxcclxuICAgICAgbm9ybWFsaXplU2xpZGVJbmRleDogdHJ1ZSxcclxuICAgICAgbmF2aWdhdGlvbjoge1xyXG4gICAgICAgIG5leHRFbDogb3V0ZXJTbGlkZXJOZXh0QnRuLFxyXG4gICAgICAgIHByZXZFbDogb3V0ZXJTbGlkZXJQcmV2QnRuXHJcbiAgICAgIH0sXHJcbiAgICAgIGNvbnRyb2xsZXI6e1xyXG4gICAgICAgIGJ5OiAnc2xpZGUnXHJcbiAgICAgIH0sXHJcbiAgICAgIGJyZWFrcG9pbnRzOntcclxuICAgICAgICA3MDA6e1xyXG4gICAgICAgICAgc2xpZGVzUGVyVmlldzogJ2F1dG8nLFxyXG4gICAgICAgICAgc3BhY2VCZXR3ZWVuOiAwXHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgIH1cclxuXHJcbiAgICB9KTtcclxuXHJcblxyXG4gICAgb3V0ZXJTd2lwZXJDb250cm9scy5jb250cm9sbGVyLmNvbnRyb2wgPSBvdXRlclN3aXBlcjtcclxuICAgIG91dGVyU3dpcGVyLmNvbnRyb2xsZXIuY29udHJvbCA9IG91dGVyU3dpcGVyQ29udHJvbHM7XHJcblxyXG5cclxuICAgIC8vIGluaXQgc3dpcGVyIHNsaWRlciBmb3Igb3V0ZXIgc2xpZGVzXHJcbiAgICB2YXIgaW5uZXJTd2lwZXIgPSBuZXcgU3dpcGVyIChpbm5lclNsaWRlciwge1xyXG4gICAgICBcclxuICAgICAgZGlyZWN0aW9uOiAnaG9yaXpvbnRhbCcsXHJcbiAgICAgIGxvb3A6IHRydWUsXHJcbiAgICAgIHNwYWNlQmV0d2VlbjogMCxcclxuICAgICAgLy8gc2xpZGVzUGVyVmlldzogMyxcclxuICAgICAgc2xpZGVzUGVyVmlldzogJ2F1dG8nLFxyXG4gICAgICBsb29wZWRTbGlkZXM6IDcsXHJcbiAgICAgIGxvb3BBZGRpdGlvbmFsU2xpZGVzOiAxMCxcclxuICAgICAgY2VudGVyZWRTbGlkZXM6IHRydWUsXHJcbiAgICAgIHNwYWNlQmV0d2VlbjogMCxcclxuXHJcbiAgICAgIGVmZmVjdDogJ2NvdmVyZmxvdycsXHJcbiAgICAgIC8vIGdyYWJDdXJzb3I6IHRydWUsXHJcbiAgICAgIGNvdmVyZmxvd0VmZmVjdDoge1xyXG4gICAgICAgIHJvdGF0ZTogNDAsXHJcbiAgICAgICAgc3RyZXRjaDogMCxcclxuICAgICAgICBkZXB0aDogMTAwLFxyXG4gICAgICAgIG1vZGlmaWVyOiAxLFxyXG4gICAgICAgIHNsaWRlU2hhZG93cyA6IHRydWVcclxuICAgICAgfSxcclxuICAgICAgbm9ybWFsaXplU2xpZGVJbmRleDogdHJ1ZSxcclxuICAgICAgc2xpZGVUb0NsaWNrZWRTbGlkZTogdHJ1ZVxyXG5cclxuICAgIH0pO1xyXG5cclxuXHJcblxyXG5cclxuICAgIC8vIHN3aXBpbmcgY3VycmVudCBpbm5lclN3aXBlciBvbiBjbGlja3NcclxuICAgIFxyXG4gICAgdmFyIHNwZWVkID0gNDAwO1xyXG4gICAgdmFyIHRvdWNoO1xyXG4gICAgaW5uZXJTbGlkZXJOZXh0QnRuLmFkZChpbm5lclNsaWRlclByZXZCdG4pLm9uKCdjbGljayB0b3VjaHN0YXJ0JyxmdW5jdGlvbihlKXtcclxuICAgICAgdmFyICR0aGlzID0gJCh0aGlzKTtcclxuICAgICAgXHJcbiAgICAgIGlmIChlLnR5cGU9PSd0b3VjaHN0YXJ0Jykge1xyXG4gICAgICAgIHRvdWNoID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgdG91Y2ggPSBmYWxzZTtcclxuICAgICAgICB9LDQwMCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIHJldHVybiBpZiBjbGljayBmaXJlZCB3aXRoaW4gNDAwIG1zIGFmdGVyIHRvdWNoXHJcbiAgICAgIGlmICh0b3VjaCAmJiBlLnR5cGU9PSdjbGljaycpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHZhciBjdXJJbm5lclN3aXBlckNvbnQgPSBvdXRlclN3aXBlci5zbGlkZXNbY3VycmVudElubmVyU3dpcGVySW5kZXhdO1xyXG4gICAgICB2YXIgY3VySW5uZXJTd2lwZXIgPSAkKGN1cklubmVyU3dpcGVyQ29udCkuZmluZCgnLmlubmVyLXNsaWRlcicpWzBdO1xyXG4gICAgICB2YXIgY3VyU3dpcGVySW5zdGFuY2UgPSBjdXJJbm5lclN3aXBlci5zd2lwZXI7XHJcblxyXG4gICAgICBpZiAoJHRoaXMuaGFzQ2xhc3MoJ2lubmVyLXNsaWRlcl9fcHJldicpKSB7XHJcbiAgICAgICAgICBjdXJJbm5lclN3aXBlci5zd2lwZXIuc2xpZGVQcmV2KDQwMCk7XHJcbiAgICAgIH1lbHNle1xyXG4gICAgICAgICAgY3VySW5uZXJTd2lwZXIuc3dpcGVyLnNsaWRlTmV4dCg0MDApO1xyXG4gICAgICB9XHJcblxyXG4gICAgfSlcclxuXHJcbiAgICBcclxuXHJcblxyXG5cclxuXHJcblxyXG4gICAgLy8gZGV0ZWN0aW5nIG91dGVyU3dpcGVyIHRyYW5zaXRpb25FbmQgdG8gY2hhbmdlIGN1cnJlbnRJbm5lclN3aXBlckluZGV4XHJcblxyXG4gICAgdmFyIG91dGVyU3dpcGVyVHJpZ2dlciAsIGltbUZpcmVUaW1lb3V0ID0gMjAwO1xyXG4gICAgb3V0ZXJTd2lwZXIub24oJ3RyYW5zaXRpb25FbmQnLGZ1bmN0aW9uKCl7XHJcbiAgICAgIC8vIHN0b3BwaW5nIGl0IHRvIGV4ZWN1dGUgbXVsdGlwbGUgdGltZXMgY29uc2VjdXRpdmVseVxyXG4gICAgICBpZiAob3V0ZXJTd2lwZXJUcmlnZ2VyKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9ZWxzZXtcclxuICAgICAgICBvdXRlclN3aXBlclRyaWdnZXIgPSB0cnVlO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zb2xlLmxvZygnY2hhbmdlZCcpO1xyXG5cclxuICAgICAgY3VycmVudElubmVyU3dpcGVySW5kZXggPSBvdXRlclN3aXBlci5hY3RpdmVJbmRleDtcclxuICAgICAgY29uc29sZS5sb2coJ2N1cnJlbnRJbm5lclN3aXBlckluZGV4OiAnKyBjdXJyZW50SW5uZXJTd2lwZXJJbmRleCk7XHJcblxyXG5cclxuICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICBvdXRlclN3aXBlclRyaWdnZXIgPSB1bmRlZmluZWQ7XHJcbiAgICAgIH0saW1tRmlyZVRpbWVvdXQpOyAvLyBhbGxvd2luZyB0aGUgY2FsbGJhY2sgdG8gcnVuIGFmdGVyIGEgY2VydGFpbiB0aW1lXHJcblxyXG4gICAgfSk7XHJcblxyXG4gIH0gLy8gRU5EIG9mIHdvcmtTbGlkZXIgRnVuY1xyXG5cclxuICBcclxuXHJcbiAgZnVuY3Rpb24gdHJhbnNpdGlvbkxhYmVscygpIHtcclxuXHJcbiAgICBmb3JtRmllbGRzLmZvY3Vzb3V0KGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgICB2YXIgdGV4dFZhbCA9ICQodGhpcykudmFsKCk7XHJcblxyXG4gICAgICBpZiAodGV4dFZhbCA9PT0gXCJcIikge1xyXG4gICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoJ2hhcy12YWx1ZScpO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICQodGhpcykuYWRkQ2xhc3MoJ2hhcy12YWx1ZScpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBjb3JyZWN0IG1vYmlsZSBkZXZpY2Ugd2luZG93IHBvc2l0aW9uXHJcbiAgICAgIHdpbmRvdy5zY3JvbGxUbygwLCAwKTtcclxuXHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuXHJcbiAgZnVuY3Rpb24gc3RhcnRQcm9qZWN0Rm9ybSgpe1xyXG4gICAgICB2YXIgc3RhcnRQcm9qZWN0Rm9ybSA9ICQoJyNzdGFydFByb2plY3RGb3JtJyk7XHJcblxyXG4gICAgICB2YXIgbmFtZUZpZWxkID0gJCgnI25hbWVTUCcpO1xyXG4gICAgICB2YXIgZW1haWxGaWVsZCA9ICQoJyNlbWFpbFNQJyk7XHJcbiAgICAgIHZhciB3ZWJTZXJ2aWNlRmllbGQgPSAkKCcjc2VydmljZS13ZWInKTtcclxuICAgICAgdmFyIHNlcnZpY2VzQ29udCA9IHdlYlNlcnZpY2VGaWVsZC5jbG9zZXN0KCcud29yay1yZXF1ZXN0LS1zZXJ2aWNlcycpO1xyXG5cclxuXHJcbiAgICAgIC8vIGNoYW5nZSB2YWxpZGF0aW9uIG1lc3NhZ2VzIGFuZCBjdXN0b21pemUgb3B0aW9uc1xyXG5cclxuICAgICAgc3RhcnRQcm9qZWN0Rm9ybS5wYXJzbGV5KHtcclxuICAgICAgICByZXF1aXJlZE1lc3NhZ2U6ICdUaGlzIGZpZWxkIGlzIHJlcXVpcmVkJ1xyXG4gICAgICAgIFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGVtYWlsRmllbGQucGFyc2xleSh7XHJcbiAgICAgICAgdHlwZU1lc3NhZ2U6IFwiRW50ZXIgYSB2YWxpZCBlLW1haWwgYWRkcmVzc1wiXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgd2ViU2VydmljZUZpZWxkLnBhcnNsZXkoe1xyXG4gICAgICAgIHJlcXVpcmVkTWVzc2FnZTogXCJQbGVhc2Ugc2VsZWN0IHRoZSBkaWdpdGFsIHNlcnZpY2UvcyB5b3Ugd2FudCB1cyB0byB3b3JrIG9uXCIsIC8vIG9ubHkgd29ya3Mgd2hlbiB1c2luZyB0aGUgZmlyc3QgY2hlY2tib3ggaW4gdGhlIGdyb3VwXHJcbiAgICAgICAgZXJyb3JzQ29udGFpbmVyOiBmdW5jdGlvbiAoRmllbGQpIHtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgcmV0dXJuIHNlcnZpY2VzQ29udDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGNsYXNzSGFuZGxlcjogZnVuY3Rpb24gKEZpZWxkKSB7XHJcbiAgICAgICAgICByZXR1cm4gc2VydmljZXNDb250O1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcblxyXG5cclxuICAgICAgLy8gYWN0IHRvIHZhbGlkYXRpb24gZXJyb3JzIGFuZCBzdWNjZXNzIFxyXG5cclxuICAgICAgc3RhcnRQcm9qZWN0Rm9ybS5wYXJzbGV5KCkub24oJ2Zvcm06ZXJyb3InLGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgICAgICAgYWxlcnQoJ3ZhbGlkYXRpb24gZXJyb3JzJyk7ICBcclxuXHJcbiAgICAgIH0pLm9uKCdmb3JtOnN1Ym1pdCcsZnVuY3Rpb24oZSl7XHJcblxyXG4gICAgICAgICAgY29uc29sZS5sb2coJ0hpcmUgRm9ybSBTdWJtaXR0ZWQnKTtcclxuXHJcbiAgICAgICAgICAvLyB3cml0ZSBjb2RlIGJlbG93ICB0byBzdWJtaXQgdG8gREIgZm9yIGhpcmUgZm9ybVxyXG5cclxuICAgICAgICAgIC8vIHRpcDogaGlyZSBzZWN0aW9uIGlzIGNhY2hlZCBpbiB2YXJpYWJsZSBcclxuICAgICAgICAgIC8vIGFib3ZlIGxpa2UgdGhpcyBgIHZhciBoaXJlID0gYm9keS5maW5kKCcuaGlyZScpOyBgIFxyXG4gICAgICAgICAgLy8gc28gZmluZCB0aGUgZm9ybSBmaWVsZHMgIGxpa2UgdmFyIGZvcm1GaWVsZCA9IGhpcmUuZmluZCgnc29tZXRoaW5nJyk7XHJcblxyXG4gICAgICAgICAgXHJcblxyXG4gICAgICAgICAgcmV0dXJuIGZhbHNlOyAgXHJcblxyXG4gICAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBjb250YWN0Rm9ybSgpe1xyXG4gICAgLy8gYWxlcnQoKTtcclxuICAgIHZhciBwb3B1cCA9IGNvbnRhY3RQb3B1cDtcclxuICAgIHZhciBjbG9zZSA9IHBvcHVwLmZpbmQoJyNjbG9zZS1jb250YWN0LWZvcm0nKTtcclxuICAgIHZhciBjb250YWN0Rm9ybSAgPSBwb3B1cC5maW5kKCdmb3JtJyk7XHJcbiAgICB2YXIgZW1haWxGaWVsZCA9ICBwb3B1cC5maW5kKCcjZW1haWxDRicpO1xyXG5cclxuICAgIGNvbnNvbGUubG9nKHBvcHVwKTtcclxuXHJcbiAgICAvLyBkaXNhYmxpbmcgc3dpcGluZyBzbGlkZSB3aGVuIHBvcHVwIGlzIG9wZW5cclxuXHJcbiAgICBwb3B1cC5vbignbW91c2V3aGVlbCBET01Nb3VzZVNjcm9sbCcsZnVuY3Rpb24oZSl7XHJcbiAgICAgIGNvbnNvbGUubG9nKGUpO1xyXG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gIHN3aXBlIHN1cHBvcnQgZm9yIHRvdWNoIGRldmljZXNcclxuICAgIHZhciB0YXJnZXRFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ZpZXdwb3J0JyksXHJcbiAgICAgICAgbWMgPSBuZXcgSGFtbWVyKHRhcmdldEVsZW1lbnQpO1xyXG4gICAgbWMuZ2V0KCdzd2lwZScpLnNldCh7IGRpcmVjdGlvbjogSGFtbWVyLkRJUkVDVElPTl9WRVJUSUNBTCB9KTtcclxuICAgIG1jLm9uKCdzd2lwZXVwIHN3aXBlZG93bicsIGZ1bmN0aW9uKGUpIHtcclxuXHJcbiAgICAgIGNvbnNvbGUubG9nKGUpO1xyXG5cclxuICAgIH0pO1xyXG5cclxuICAgIGNsb3NlLm9uKCdjbGljaycsZnVuY3Rpb24oKXtcclxuICAgICAgcG9wdXAudG9nZ2xlQ2xhc3MoJ29mZicpO1xyXG4gICAgfSk7XHJcblxyXG5cclxuICAgIC8vIGNoYW5nZSB2YWxpZGF0aW9uIG1lc3NhZ2VzIGFuZCBjdXN0b21pemUgb3B0aW9uc1xyXG5cclxuICAgICAgY29udGFjdEZvcm0ucGFyc2xleSh7XHJcbiAgICAgICAgcmVxdWlyZWRNZXNzYWdlOiAnVGhpcyBmaWVsZCBpcyByZXF1aXJlZCdcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBlbWFpbEZpZWxkLnBhcnNsZXkoe1xyXG4gICAgICAgIHR5cGVNZXNzYWdlOiBcIkVudGVyIGEgdmFsaWQgZS1tYWlsIGFkZHJlc3NcIlxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIC8qd2ViU2VydmljZUZpZWxkLnBhcnNsZXkoe1xyXG4gICAgICAgIHJlcXVpcmVkTWVzc2FnZTogXCJQbGVhc2Ugc2VsZWN0IHRoZSBkaWdpdGFsIHNlcnZpY2UvcyB5b3Ugd2FudCB1cyB0byB3b3JrIG9uXCIsIC8vIG9ubHkgd29ya3Mgd2hlbiB1c2luZyB0aGUgZmlyc3QgY2hlY2tib3ggaW4gdGhlIGdyb3VwXHJcbiAgICAgICAgZXJyb3JzQ29udGFpbmVyOiBmdW5jdGlvbiAoRmllbGQpIHtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgcmV0dXJuIHNlcnZpY2VzQ29udDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGNsYXNzSGFuZGxlcjogZnVuY3Rpb24gKEZpZWxkKSB7XHJcbiAgICAgICAgICByZXR1cm4gc2VydmljZXNDb250O1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7Ki9cclxuXHJcblxyXG4gICAgICAvLyBhY3QgdG8gdmFsaWRhdGlvbiBlcnJvcnMgYW5kIHN1Y2Nlc3MgXHJcblxyXG4gICAgY29udGFjdEZvcm0ucGFyc2xleSgpLm9uKCdmb3JtOmVycm9yJyxmdW5jdGlvbigpe1xyXG5cclxuICAgICAgICAgIGFsZXJ0KCd2YWxpZGF0aW9uIGVycm9ycycpOyAgXHJcblxyXG4gICAgICB9KS5vbignZm9ybTpzdWJtaXQnLGZ1bmN0aW9uKGUpe1xyXG5cclxuICAgICAgICAgIGNvbnNvbGUubG9nKCdDb250YWN0IEZvcm0gU3VibWl0dGVkJyk7XHJcblxyXG4gICAgICAgICAgLy8gd3JpdGUgY29kZSBiZWxvdyAgdG8gc3VibWl0IHRvIERCIGZvciBjb250YWN0IGZvcm1cclxuICAgICAgICAgIC8vIHRpcDogY29udGFjdCBwb3B1cCBpcyBjYWNoZWQgaW4gdmFyaWFibGUgXHJcbiAgICAgICAgICAvLyBhYm92ZSBsaWtlIHRoaXMgYCB2YXIgY29udGFjdFBvcHVwID0gJCgnI2NvbnRhY3RfX3BvcHVwJyk7IGAgXHJcbiAgICAgICAgICAvLyBzbyB3ZSBjYW4gZmluZCB0aGUgZm9ybSBmaWVsZHMgbGlrZSB2YXIgZm9ybUZpZWxkID0gY29udGFjdFBvcHVwLmZpbmQoJ3NvbWV0aGluZycpO1xyXG5cclxuICAgICAgICAgIFxyXG5cclxuICAgICAgICAgIHJldHVybiBmYWxzZTsgIFxyXG4gICAgICAgICAgXHJcbiAgICAgIH0pO1xyXG5cclxuXHJcblxyXG4gIH1cclxuXHJcblxyXG5cclxuICBmdW5jdGlvbiBnZXRWaWV3cG9ydEJhc2VkSFcocGVyY2VudGFnZSx1bml0KXtcclxuICAgIHJldHVybiBwZXJjZW50YWdlLzEwMCAqIHdpbmRvd1t1bml0XTtcclxuXHJcbiAgfSAvKiBnZXRWaWV3cG9ydEJhc2VkSFcgRU5EUyAqL1xyXG5cclxuXHJcbiAgZnVuY3Rpb24gYXBwbHlWaWV3cG9ydEhlaWdodHMoKXtcclxuICAgIHZhciBsX3ZpZXdwb3J0ID0gIGJvZHkuZmluZCgnLmwtdmlld3BvcnQnKTsgXHJcblxyXG4gICAgdmFyIHdvcmtfX2xvY2t1cCA9IHdvcmsuZmluZCgnLndvcmtfX2xvY2t1cCcpOyAvLyBxdWVyaW5nIGZvciB1c2luZyBmdXJ0aGVyXHJcblxyXG4gICAgdmFyIG91dGVyU2xpZGVyID0gIHdvcmtfX2xvY2t1cC5maW5kKCcub3V0ZXItc2xpZGVyJyk7IFxyXG5cclxuICAgIHZhciBpbm5lclNsaWRlckl0ZW1JbWFnZUNvbnRhaW5lciA9ICBcclxuICAgIHdvcmtfX2xvY2t1cC5maW5kKCcuaW5uZXItc2xpZGVyX19pdGVtLWltYWdlLWNvbnRhaW5lcicpOyBcclxuXHJcblxyXG4gICAgbF92aWV3cG9ydC5jc3Moe1xyXG4gICAgICBoZWlnaHQ6IChnZXRWaWV3cG9ydEJhc2VkSFcoMTAwLCd2aCcpKSArICdweCcgLy8gaGVpZ2h0IG5lZWRzIHRvIGJlIDEwMHZoXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgb3V0ZXJTbGlkZXIuY3NzKHtcclxuICAgICAgaGVpZ2h0OiAoZ2V0Vmlld3BvcnRCYXNlZEhXKDc1LCd2bWluJykpICsgJ3B4JyAvLyBoZWlnaHQgbmVlZHMgdG8gYmUgNzV2bWluXHJcbiAgICB9KTtcclxuXHJcbiAgICBpbm5lclNsaWRlckl0ZW1JbWFnZUNvbnRhaW5lci5jc3Moe1xyXG4gICAgICBoZWlnaHQ6IChnZXRWaWV3cG9ydEJhc2VkSFcoNDAsJ3ZtaW4nKSkgKyAncHgnIC8vIGhlaWdodCBuZWVkcyB0byBiZSA0MHZtaW5cclxuICAgIH0pO1xyXG5cclxuICAgIC8qIFxyXG4gICAgICB1c2luZyBtaW4gd2lkdGhzICh3aGVuIGRlZmF1bHQgYXJlIGFscmVhZHkgYXBwbGllZCBcclxuICAgICAgYnV0IG5lZWRzIHRvIGJlIG92ZXJ3cml0dGVuIHdpdGggaW5jcmVhc2luZyB3aWR0aHMpXHJcbiAgICAqL1xyXG5cclxuICAgIGlmICh2dyA+IDc2Nykge1xyXG4gICAgICBpbm5lclNsaWRlckl0ZW1JbWFnZUNvbnRhaW5lci5jc3Moe1xyXG4gICAgICAgIGhlaWdodDogKGdldFZpZXdwb3J0QmFzZWRIVygyNSwndm1pbicpKSArICdweCcgLy8gaGVpZ2h0IG5lZWRzIHRvIGJlIDI1dm1pblxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAodncgPiA4OTkpIHtcclxuXHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmICh2dyA+IDExOTkpIHtcclxuICAgICAgb3V0ZXJTbGlkZXIuY3NzKHtcclxuICAgICAgICBoZWlnaHQ6IChnZXRWaWV3cG9ydEJhc2VkSFcoNTUsJ3ZtaW4nKSkgKyAncHgnIC8vIGhlaWdodCBuZWVkcyB0byBiZSA3NXZtaW5cclxuICAgICAgfSk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIFxyXG5cclxuICAgIFxyXG5cclxuXHJcbiAgICAvKiB1c2luZyBtYXggd2lkdGhzKi9cclxuXHJcbiAgICBpZiAodncgPCA0MDApIHtcclxuICAgICAgICBpbm5lclNsaWRlckl0ZW1JbWFnZUNvbnRhaW5lci5jc3Moe1xyXG4gICAgICAgICAgaGVpZ2h0OiAoZ2V0Vmlld3BvcnRCYXNlZEhXKDM1LCd2bWluJykpICsgJ3B4JyAvLyBoZWlnaHQgbmVlZHMgdG8gYmUgMzV2bWluXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyogdXNpbmcgbWF4IHdpZHRocyBhbmQgb3JpZW50YXRpb24qL1xyXG5cclxuICAgIGlmICh2dyA+IHZoKSB7XHJcblxyXG4gICAgICBpbm5lclNsaWRlckl0ZW1JbWFnZUNvbnRhaW5lci5jc3Moe1xyXG4gICAgICAgICdtaW4taGVpZ2h0JzogJ2F1dG8nIC8vIGhlaWdodCBuZWVkcyB0byBiZSAyNXZtaW5cclxuICAgICAgfSk7XHJcblxyXG4gICAgICBpZiAodncgPCAxMjAwICYmIHZ3ID4gdmgpIHtcclxuICAgICAgICAgIGlubmVyU2xpZGVySXRlbUltYWdlQ29udGFpbmVyLmNzcyh7XHJcbiAgICAgICAgICAgIGhlaWdodDogKGdldFZpZXdwb3J0QmFzZWRIVygzMCwndm1pbicpKSArICdweCcgLy8gaGVpZ2h0IG5lZWRzIHRvIGJlIDI1dm1pblxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gIH0gLyogYXBwbHlWaWV3cG9ydEhlaWdodHMgRU5EUyAqL1xyXG5cclxuXHJcbiAgZnVuY3Rpb24gc21hbGxTY3JlZW5PcHRpbWl6ZXJGb3JGb3Jtcygpe1xyXG5cclxuICAgICAgZm9ybUZpZWxkcy5vbignZm9jdXNpbicsZnVuY3Rpb24oKXtcclxuICAgICAgICBjb25zb2xlLmxvZygnZm9jdXNpbicpO1xyXG4gICAgICAgIGJvZHkuYWRkQ2xhc3MoJ2Zvcm0tZmllbGQtZm9jdXNlZCcpOyAvLyBhZGQgY2xhc3Mgb2YgZm9ybS1maWVsZC1mb2N1c2VkIHRvIGJvZHlcclxuXHJcbiAgICAgICAgaGlyZVdyYXBwZXIuY3NzKHtcclxuICAgICAgICAgIG1pbkhlaWdodDogaGlyZVdyYXBwZXJIZWlnaHQgICsgJ3B4J1xyXG4gICAgICAgIH0pO1xyXG5cclxuXHJcbiAgICAgICAgaGlyZS5vbignbW91c2V3aGVlbCBET01Nb3VzZVNjcm9sbCcsZnVuY3Rpb24oZSl7XHJcbiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgfSk7XHJcblxyXG5cclxuICAgICAgZm9ybUZpZWxkcy5vbignZm9jdXNvdXQnLGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ2ZvY3Vzb3V0Jyk7XHJcbiAgICAgICAgYm9keS5yZW1vdmVDbGFzcygnZm9ybS1maWVsZC1mb2N1c2VkJyk7IC8vIGFkZCBjbGFzcyBvZiBmb3JtLWZpZWxkLWZvY3VzZWQgdG8gYm9keVxyXG5cclxuICAgICAgICBoaXJlV3JhcHBlci5jc3Moe1xyXG4gICAgICAgICAgbWluSGVpZ2h0OiAnYXV0bydcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaGlyZS5vZmYoJ21vdXNld2hlZWwgRE9NTW91c2VTY3JvbGwnKTtcclxuXHJcbiAgICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG5cclxuXHJcbiAgJCh3aW5kb3cpLm9uKCdyZXNpemUnLGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgdmlld3BvcnREaW1lbnNpb25zKCk7XHJcbiAgICBhcHBseVZpZXdwb3J0SGVpZ2h0cygpO1xyXG5cclxuICB9KTsgLyogb24gcmVzaXplIEVORFMgKi9cclxuXHJcblxyXG4gICQod2luZG93KS5vbignbG9hZCcsZnVuY3Rpb24oKXtcclxuXHJcbiAgICB3aW5kb3cuaGlyZVdyYXBwZXJIZWlnaHQgPSBoaXJlV3JhcHBlci5oZWlnaHQoKTtcclxuICAgIHdpbmRvdy5zZXRJbnRlcnZhbChmdW5jdGlvbigpe1xyXG4gICAgICBjb25zb2xlLmxvZyhoaXJlV3JhcHBlckhlaWdodCk7XHJcbiAgICB9LDMwMDApO1xyXG5cclxuICB9KTtcclxuICBcclxuXHJcbi8qICBpZiAodHlwZW9mIHRvdWNoc3RhcnQpIHtcclxuICAgIGFsZXJ0KHRydWUpO1xyXG4gIH1cclxuXHJcbiAgaWYgKGRvY3VtZW50LmNsaWNrKSB7XHJcbiAgICBhbGVydChmYWxzZSk7XHJcbiAgfSovXHJcbiAgXHJcblxyXG5cclxuICBvdXRlck5hdigpO1xyXG4gIGFib3V0U2xpZGVyKCk7XHJcbiAgd29ya1NsaWRlcigpO1xyXG5cclxuICB0cmFuc2l0aW9uTGFiZWxzKCk7XHJcbiAgc21hbGxTY3JlZW5PcHRpbWl6ZXJGb3JGb3JtcygpO1xyXG5cclxuICBzdGFydFByb2plY3RGb3JtKCk7XHJcbiAgY29udGFjdEZvcm0oKTtcclxuXHJcbiAgYXBwbHlWaWV3cG9ydEhlaWdodHMoKTtcclxuXHJcblxyXG59KTtcclxuXHJcbiJdfQ==
