$(document).ready(function(){var e=this;function i(){window.vh=e.documentElement.clientHeight,window.vw=e.documentElement.clientWidth,window.vmin=vh>vw?vw:vh,window.vmax=vh<vw?vw:vh}i(),function(){var e=sessionStorage.getItem("activeSectionClass");if(!+e)return;var i=$(".side-nav").children().length-1,n=e;g(n),C(0,n,i)}();var n=$("body"),t=n.find(".work"),o=(n.find(".hire"),n.find(".about")),s=(n.find(".contact"),n.find("input, textarea"));$(".side-nav li, .outer-nav li").click(function(){if(!$(this).hasClass("is-active")){var e=$(this),i=e.parent().find(".is-active"),n=e.parent().children().index(i),t=e.parent().children().index(e),o=$(this).parent().children().length-1;g(t),C(n,t,o)}}),$(".cta").click(function(){var e=$(this);e.hasClass("cta--contact")?$("#contact__popup").removeClass("off"):e.hasClass("cta--about")?S(2):e.hasClass("cta--hire")&&S(4)});var r=!0,a=null;$(this).on("mousewheel DOMMouseScroll",function(e){if(!$(".outer-nav").hasClass("is-vis")){e.preventDefault();var i=e.originalEvent.wheelDelta?-e.originalEvent.wheelDelta:20*e.originalEvent.detail;i>50&&r?(r=!1,clearTimeout(a),a=setTimeout(function(){r=!0},1e3),w(1)):i<-50&&r&&(r=!1,clearTimeout(a),a=setTimeout(function(){r=!0},1e3),w(-1))}});var l,c,d,v,u,f,p,h=document.getElementById("viewport"),m=new Hammer(h);function w(e){var i=$(".side-nav").find(".is-active"),n=$(".side-nav").children().index(i),t=$(".side-nav").children().length-1,o=0;"swipeup"===e.type||40===e.keyCode||e>0?n!==t?(g(o=n+1),C(n,o,t)):(g(o),C(n,o,t)):("swipedown"===e.type||38===e.keyCode||e<0)&&(0!==n?(g(o=n-1),C(n,o,t)):(g(o=t),C(n,o,t)))}function g(e){$(".side-nav, .outer-nav").children().removeClass("is-active"),$(".side-nav").children().eq(e).addClass("is-active"),$(".outer-nav").children().eq(e).addClass("is-active")}function C(e,i,n){sessionStorage.setItem("activeSectionClass",i),$(".main-content").children().removeClass("section--is-active"),$(".main-content").children().eq(i).addClass("section--is-active"),$(".main-content .section").children().removeClass("section--next section--prev"),e===n&&0===i||0===e&&i===n?$(".main-content .section").children().removeClass("section--next section--prev"):e<i?$(".main-content").children().eq(e).children().addClass("section--next"):$(".main-content").children().eq(e).children().addClass("section--prev"),0!==i&&i!==n?$(".header--cta").addClass("is-active"):$(".header--cta").removeClass("is-active")}function S(e){var i=$(".side-nav").find(".is-active"),n=$(".side-nav").children().index(i),t=$(".side-nav").children().length-1,o=e;g(e),C(n,o,t)}function x(e,i){return e/100*window[i]}function I(){var e=n.find(".l-viewport"),i=t.find(".work__lockup"),o=i.find(".outer-slider"),s=i.find(".inner-slider__item-image-container");e.css({height:x(100,"vh")+"px"}),o.css({height:x(75,"vmin")+"px"}),s.css({height:x(40,"vmin")+"px"}),vw>767&&s.css({height:x(25,"vmin")+"px"}),vw,vw>1199&&o.css({height:x(55,"vmin")+"px"}),vw<400&&s.css({height:x(35,"vmin")+"px"}),vw>vh&&(s.css({"min-height":"auto"}),vw<1200&&vw>vh&&s.css({height:x(30,"vmin")+"px"}))}m.get("swipe").set({direction:Hammer.DIRECTION_VERTICAL}),m.on("swipeup swipedown",function(e){w(e)}),$(document).keyup(function(e){$(".outer-nav").hasClass("is-vis")||(e.preventDefault(),w(e))}),$(window).on("resize",function(){i(),I()}),$(".header--nav-toggle").click(function(){$(".perspective").addClass("perspective--modalview"),setTimeout(function(){$(".perspective").addClass("effect-rotate-left--animate")},25),$(".outer-nav, .outer-nav li, .outer-nav--return").addClass("is-vis")}),$(".outer-nav--return, .outer-nav li").click(function(){$(".perspective").removeClass("effect-rotate-left--animate"),setTimeout(function(){$(".perspective").removeClass("perspective--modalview")},400),$(".outer-nav, .outer-nav li, .outer-nav--return").removeClass("is-vis")}),l=o.find(".slider"),c=o.find(".about--options a"),d=new Swiper(l,{init:!0,loop:!0,loopedSlides:4,speed:1500,slidesPerView:"auto",centeredSlides:!0,normalizeSlideIndex:!0,direction:"horizontal",effect:"fade",normalizeSlideIndex:!0,fadeEffect:{crossFade:!0},controller:{by:"slide"}}),c.on("click",function(){var e=$(this).data("slide");d.slideTo(Number(e),1500)}),function(){var e,i=t.find(".outer-slider"),n=t.find(".inner-slider"),o=t.find(".inner-slider__nav--prev"),s=t.find(".inner-slider__nav--next"),r=t.find(".outer-slider__controls"),a=t.find(".outer-slider__nav--prev"),l=t.find(".outer-slider__nav--next"),c=new Swiper(i,{init:!1,loop:!0,loopedSlides:4,slidesPerView:"auto",centeredSlides:!0,normalizeSlideIndex:!0,direction:"vertical",allowTouchMove:!1,effect:"slide",normalizeSlideIndex:!0,controller:{by:"slide"}});c.on("init",function(){console.log("swiper initialized"),e=c.activeIndex,console.log("currentInnerSwiperIndex: "+e)}),c.init();var d,v,u=new Swiper(r,{effect:"slide",normalizeSlideIndex:!0,direction:"horizontal",centeredSlides:!0,loop:!0,loopedSlides:4,slidesPerView:"auto",spaceBetween:35,touchRatio:.2,slideToClickedSlide:!0,normalizeSlideIndex:!0,navigation:{nextEl:l,prevEl:a},controller:{by:"slide"},breakpoints:{700:{slidesPerView:"auto",spaceBetween:0}}});u.controller.control=c,c.controller.control=u,new Swiper(n,{direction:"horizontal",loop:!0,spaceBetween:0,slidesPerView:"auto",loopedSlides:7,loopAdditionalSlides:10,centeredSlides:!0,spaceBetween:0,effect:"coverflow",coverflowEffect:{rotate:40,stretch:0,depth:100,modifier:1,slideShadows:!0},normalizeSlideIndex:!0,slideToClickedSlide:!0}),s.add(o).on("click touchstart",function(i){var n=$(this);if("touchstart"==i.type&&(d=!0,setTimeout(function(){d=!1},400)),!d||"click"!=i.type){var t=c.slides[e],o=$(t).find(".inner-slider")[0];o.swiper,n.hasClass("inner-slider__prev")?o.swiper.slidePrev(400):o.swiper.slideNext(400)}}),c.on("transitionEnd",function(){v||(v=!0,console.log("changed"),e=c.activeIndex,console.log("currentInnerSwiperIndex: "+e),window.setTimeout(function(){v=void 0},200))})}(),s.focusout(function(){""===$(this).val()?$(this).removeClass("has-value"):$(this).addClass("has-value"),window.scrollTo(0,0)}),s.on("focusin",function(){console.log("focusin"),n.addClass("form-field-focused")}),s.on("focusout",function(){console.log("focusin"),n.removeClass("form-field-focused")}),v=$("#startProjectForm"),$("#nameSP"),u=$("#emailSP"),f=$("#service-web"),p=f.closest(".work-request--services"),v.parsley({requiredMessage:"This field is required"}),u.parsley({typeMessage:"Enter a valid e-mail address"}),f.parsley({requiredMessage:"Please select the digital service/s you want us to work on",errorsContainer:function(e){return p},classHandler:function(e){return p}}),v.parsley().on("form:error",function(){alert("validation errors")}).on("form:submit",function(e){return console.log("Form Submitted"),!1}),function(){var e=$("#contact__popup"),i=$("#close-contact-form");console.log(e),e.on("mousewheel DOMMouseScroll",function(e){console.log(e),e.stopPropagation()});var n=document.getElementById("viewport"),t=new Hammer(n);t.get("swipe").set({direction:Hammer.DIRECTION_VERTICAL}),t.on("swipeup swipedown",function(e){console.log(e)}),i.on("click",function(){e.toggleClass("off")})}(),I()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyJdLCJuYW1lcyI6WyIkIiwiZG9jdW1lbnQiLCJyZWFkeSIsIiRkb2N1bWVudCIsInRoaXMiLCJ2aWV3cG9ydERpbWVuc2lvbnMiLCJ3aW5kb3ciLCJ2aCIsImRvY3VtZW50RWxlbWVudCIsImNsaWVudEhlaWdodCIsInZ3IiwiY2xpZW50V2lkdGgiLCJ2bWluIiwidm1heCIsImxhc3RLbm93blBvcyIsInNlc3Npb25TdG9yYWdlIiwiZ2V0SXRlbSIsImxhc3RJdGVtIiwiY2hpbGRyZW4iLCJsZW5ndGgiLCJuZXh0UG9zIiwidXBkYXRlTmF2cyIsInVwZGF0ZUNvbnRlbnQiLCJ1cGRhdGVUb0xhc3RQb3MiLCJib2R5Iiwid29yayIsImZpbmQiLCJhYm91dCIsImZvcm1GaWVsZHMiLCJjbGljayIsImhhc0NsYXNzIiwiJHRoaXMiLCJjdXJBY3RpdmUiLCJwYXJlbnQiLCJjdXJQb3MiLCJpbmRleCIsInJlbW92ZUNsYXNzIiwiY2hhbmdlU2xpZGVUbyIsImNhblNjcm9sbCIsInNjcm9sbENvbnRyb2xsZXIiLCJvbiIsImUiLCJwcmV2ZW50RGVmYXVsdCIsImRlbHRhIiwib3JpZ2luYWxFdmVudCIsIndoZWVsRGVsdGEiLCJkZXRhaWwiLCJjbGVhclRpbWVvdXQiLCJzZXRUaW1lb3V0IiwidXBkYXRlSGVscGVyIiwiYWJvdXRTbGlkZXIiLCJvcHRpb25zIiwic3dpcGVyIiwic3RhcnRQcm9qZWN0Rm9ybSIsImVtYWlsRmllbGQiLCJ3ZWJTZXJ2aWNlRmllbGQiLCJzZXJ2aWNlc0NvbnQiLCJ0YXJnZXRFbGVtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJtYyIsIkhhbW1lciIsInBhcmFtIiwidHlwZSIsImtleUNvZGUiLCJlcSIsImFkZENsYXNzIiwic2V0SXRlbSIsInVwZGF0ZVRvIiwiZ2V0Vmlld3BvcnRCYXNlZEhXIiwicGVyY2VudGFnZSIsInVuaXQiLCJhcHBseVZpZXdwb3J0SGVpZ2h0cyIsImxfdmlld3BvcnQiLCJ3b3JrX19sb2NrdXAiLCJvdXRlclNsaWRlciIsImlubmVyU2xpZGVySXRlbUltYWdlQ29udGFpbmVyIiwiY3NzIiwiaGVpZ2h0IiwibWluLWhlaWdodCIsImdldCIsInNldCIsImRpcmVjdGlvbiIsIkRJUkVDVElPTl9WRVJUSUNBTCIsImtleXVwIiwiU3dpcGVyIiwiaW5pdCIsImxvb3AiLCJsb29wZWRTbGlkZXMiLCJzcGVlZCIsInNsaWRlc1BlclZpZXciLCJjZW50ZXJlZFNsaWRlcyIsIm5vcm1hbGl6ZVNsaWRlSW5kZXgiLCJlZmZlY3QiLCJmYWRlRWZmZWN0IiwiY3Jvc3NGYWRlIiwiY29udHJvbGxlciIsImJ5Iiwic2xpZGUiLCJkYXRhIiwic2xpZGVUbyIsIk51bWJlciIsImN1cnJlbnRJbm5lclN3aXBlckluZGV4IiwiaW5uZXJTbGlkZXIiLCJpbm5lclNsaWRlclByZXZCdG4iLCJpbm5lclNsaWRlck5leHRCdG4iLCJvdXRlclNsaWRlckNvbnRyb2xzIiwib3V0ZXJTbGlkZXJQcmV2QnRuIiwib3V0ZXJTbGlkZXJOZXh0QnRuIiwib3V0ZXJTd2lwZXIiLCJhbGxvd1RvdWNoTW92ZSIsImNvbnNvbGUiLCJsb2ciLCJhY3RpdmVJbmRleCIsInRvdWNoIiwib3V0ZXJTd2lwZXJUcmlnZ2VyIiwib3V0ZXJTd2lwZXJDb250cm9scyIsInNwYWNlQmV0d2VlbiIsInRvdWNoUmF0aW8iLCJzbGlkZVRvQ2xpY2tlZFNsaWRlIiwibmF2aWdhdGlvbiIsIm5leHRFbCIsInByZXZFbCIsImJyZWFrcG9pbnRzIiwiNzAwIiwiY29udHJvbCIsImxvb3BBZGRpdGlvbmFsU2xpZGVzIiwiY292ZXJmbG93RWZmZWN0Iiwicm90YXRlIiwic3RyZXRjaCIsImRlcHRoIiwibW9kaWZpZXIiLCJzbGlkZVNoYWRvd3MiLCJhZGQiLCJjdXJJbm5lclN3aXBlckNvbnQiLCJzbGlkZXMiLCJjdXJJbm5lclN3aXBlciIsInNsaWRlUHJldiIsInNsaWRlTmV4dCIsInVuZGVmaW5lZCIsIndvcmtTbGlkZXIiLCJmb2N1c291dCIsInZhbCIsInNjcm9sbFRvIiwiY2xvc2VzdCIsInBhcnNsZXkiLCJyZXF1aXJlZE1lc3NhZ2UiLCJ0eXBlTWVzc2FnZSIsImVycm9yc0NvbnRhaW5lciIsIkZpZWxkIiwiY2xhc3NIYW5kbGVyIiwiYWxlcnQiLCJwb3B1cCIsImNsb3NlIiwic3RvcFByb3BhZ2F0aW9uIiwidG9nZ2xlQ2xhc3MiLCJjb250YWN0Rm9ybSJdLCJtYXBwaW5ncyI6IkFBRUFBLEVBQUFDLFVBQUFDLE1BQUEsV0FFQSxJQUFBQyxFQUFBQyxLQU9BLFNBQUFDLElBRUFDLE9BQUFDLEdBQUFKLEVBQUFLLGdCQUFBQyxhQUNBSCxPQUFBSSxHQUFBUCxFQUFBSyxnQkFBQUcsWUFDQUwsT0FBQU0sS0FBQUwsR0FBQUcsR0FBQUEsR0FBQUgsR0FDQUQsT0FBQU8sS0FBQU4sR0FBQUcsR0FBQUEsR0FBQUgsR0FJQUYsSUEwR0EsV0FFQSxJQUFBUyxFQUFBQyxlQUFBQyxRQUFBLHNCQUVBLEtBQUFGLEVBQUEsT0FDQSxJQUNBRyxFQUFBakIsRUFBQSxhQUFBa0IsV0FBQUMsT0FBQSxFQUNBQyxFQUFBTixFQUlBTyxFQUFBRCxHQUNBRSxFQVBBLEVBT0FGLEVBQUFILEdBL0dBTSxHQUVBLElBQUFDLEVBQUF4QixFQUFBLFFBQ0F5QixFQUFBRCxFQUFBRSxLQUFBLFNBRUFDLEdBREFILEVBQUFFLEtBQUEsU0FDQUYsRUFBQUUsS0FBQSxXQUVBRSxHQURBSixFQUFBRSxLQUFBLFlBQ0FGLEVBQUFFLEtBQUEsb0JBR0ExQixFQUFBLCtCQUFBNkIsTUFBQSxXQUVBLElBQUE3QixFQUFBSSxNQUFBMEIsU0FBQSxhQUFBLENBRUEsSUFBQUMsRUFBQS9CLEVBQUFJLE1BQ0E0QixFQUFBRCxFQUFBRSxTQUFBUCxLQUFBLGNBQ0FRLEVBQUFILEVBQUFFLFNBQUFmLFdBQUFpQixNQUFBSCxHQUNBWixFQUFBVyxFQUFBRSxTQUFBZixXQUFBaUIsTUFBQUosR0FDQWQsRUFBQWpCLEVBQUFJLE1BQUE2QixTQUFBZixXQUFBQyxPQUFBLEVBRUFFLEVBQUFELEdBQ0FFLEVB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QUFBLG9CQUFBLFNBQUFDLEdBRUFxRSxRQUFBQyxJQUFBdEUsS0FJQStHLEVBQUFoSCxHQUFBLFFBQUEsV0FDQStHLEVBQUFHLFlBQUEsU0E4R0FDLEdBRUFwRiIsImZpbGUiOiJzY3JpcHQubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gQGNvZGVraXQtcHJlcGVuZCBcIi92ZW5kb3IvaGFtbWVyLTIuMC44LmpzXCI7XHJcblxyXG4kKCBkb2N1bWVudCApLnJlYWR5KGZ1bmN0aW9uKCkge1xyXG5cclxuICB2YXIgJGRvY3VtZW50ID0gdGhpcztcclxuXHJcbiAgLypzZXRJbnRlcnZhbChmdW5jdGlvbigpe1xyXG4gICAgYWxlcnQoXCIkKGRvY3VtZW50KS5jbGllbnRIZWlnaHQ6IFwiICsgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCk7XHJcbiAgICBhbGVydChcIiQoZG9jdW1lbnQpLmlubmVySGVpZ2h0OiBcIiArICQoZG9jdW1lbnQpLmlubmVySGVpZ2h0KCkpO1xyXG4gIH0sNTAwMCk7Ki9cclxuXHJcbiAgZnVuY3Rpb24gdmlld3BvcnREaW1lbnNpb25zKCl7XHJcblxyXG4gICAgd2luZG93LnZoID0gJGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQ7XHJcbiAgICB3aW5kb3cudncgPSAkZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoO1xyXG4gICAgd2luZG93LnZtaW4gPSB2aCA+IHZ3ID8gdncgOiB2aDtcclxuICAgIHdpbmRvdy52bWF4ID0gdmggPCB2dyA/IHZ3IDogdmg7XHJcblxyXG4gIH1cclxuXHJcbiAgdmlld3BvcnREaW1lbnNpb25zKCk7XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbiAgdXBkYXRlVG9MYXN0UG9zKCk7IC8vIHVwZGF0ZSB0byB0aGUgbGFzdCBrbm93biBzZWN0aW9uXHJcblxyXG4gIHZhciBib2R5ID0gJCgnYm9keScpO1xyXG4gIHZhciB3b3JrID0gYm9keS5maW5kKCcud29yaycpO1xyXG4gIHZhciBoaXJlID0gYm9keS5maW5kKCcuaGlyZScpO1xyXG4gIHZhciBhYm91dCA9IGJvZHkuZmluZCgnLmFib3V0Jyk7XHJcbiAgdmFyIGNvbnRhY3QgPSBib2R5LmZpbmQoJy5jb250YWN0Jyk7XHJcbiAgdmFyIGZvcm1GaWVsZHMgPSBib2R5LmZpbmQoJ2lucHV0LCB0ZXh0YXJlYScpO1xyXG5cclxuICAvLyBuYXYgbWVudSBsaW5rcyBjbGljayBoYW5kbGVyXHJcbiAgJCgnLnNpZGUtbmF2IGxpLCAub3V0ZXItbmF2IGxpJykuY2xpY2soZnVuY3Rpb24oKXtcclxuXHJcbiAgICBpZiAoISgkKHRoaXMpLmhhc0NsYXNzKCdpcy1hY3RpdmUnKSkpIHtcclxuXHJcbiAgICAgIHZhciAkdGhpcyA9ICQodGhpcyksXHJcbiAgICAgICAgICBjdXJBY3RpdmUgPSAkdGhpcy5wYXJlbnQoKS5maW5kKCcuaXMtYWN0aXZlJyksXHJcbiAgICAgICAgICBjdXJQb3MgPSAkdGhpcy5wYXJlbnQoKS5jaGlsZHJlbigpLmluZGV4KGN1ckFjdGl2ZSksXHJcbiAgICAgICAgICBuZXh0UG9zID0gJHRoaXMucGFyZW50KCkuY2hpbGRyZW4oKS5pbmRleCgkdGhpcyksXHJcbiAgICAgICAgICBsYXN0SXRlbSA9ICQodGhpcykucGFyZW50KCkuY2hpbGRyZW4oKS5sZW5ndGggLSAxO1xyXG5cclxuICAgICAgdXBkYXRlTmF2cyhuZXh0UG9zKTtcclxuICAgICAgdXBkYXRlQ29udGVudChjdXJQb3MsIG5leHRQb3MsIGxhc3RJdGVtKTtcclxuXHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIC8vIGN0YSBidXR0b25zXHJcbiAgJCgnLmN0YScpLmNsaWNrKGZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgJHRoaXMgPSAkKHRoaXMpO1xyXG5cclxuICAgIGlmICgkdGhpcy5oYXNDbGFzcygnY3RhLS1jb250YWN0JykpIHtcclxuICAgICAgdmFyIGNvbnRhY3RQb3B1cCA9ICQoJyNjb250YWN0X19wb3B1cCcpO1xyXG5cclxuICAgICAgY29udGFjdFBvcHVwLnJlbW92ZUNsYXNzKCdvZmYnKTtcclxuXHJcbiAgICB9ZWxzZSBpZigkdGhpcy5oYXNDbGFzcygnY3RhLS1hYm91dCcpKXtcclxuICAgICAgY2hhbmdlU2xpZGVUbygyKTsgLy8gYWJvdXQgc2VjdGlvbiBpcyBvbiBpbmRleCAtIDJcclxuICAgIH1lbHNlIGlmKCR0aGlzLmhhc0NsYXNzKCdjdGEtLWhpcmUnKSl7XHJcbiAgICAgIGNoYW5nZVNsaWRlVG8oNCk7IC8vIGhpcmUgdXMgc2VjdGlvbiBpcyBvbiBpbmRleCAtIDRcclxuICAgIH1cclxuXHJcbiAgfSk7XHJcblxyXG5cclxuICAvKiBTVEFSVCAtIGZ1bmN0aW9ucyBmb3IgbmF2aWdhdGluZyB0aHJvdWdoIHNsaWRlcyAqL1xyXG5cclxuICAvLyBET01Nb3VzZVNjcm9sbCBpbmNsdWRlZCBmb3IgZmlyZWZveCBzdXBwb3J0XHJcbiAgdmFyIGNhblNjcm9sbCA9IHRydWUsXHJcbiAgICAgIHNjcm9sbENvbnRyb2xsZXIgPSBudWxsO1xyXG5cclxuICAkKHRoaXMpLm9uKCdtb3VzZXdoZWVsIERPTU1vdXNlU2Nyb2xsJywgZnVuY3Rpb24oZSl7XHJcblxyXG4gICAgaWYgKCEoJCgnLm91dGVyLW5hdicpLmhhc0NsYXNzKCdpcy12aXMnKSkpIHtcclxuXHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgIHZhciBkZWx0YSA9IChlLm9yaWdpbmFsRXZlbnQud2hlZWxEZWx0YSkgPyAtZS5vcmlnaW5hbEV2ZW50LndoZWVsRGVsdGEgOiBlLm9yaWdpbmFsRXZlbnQuZGV0YWlsICogMjA7XHJcblxyXG4gICAgICBpZiAoZGVsdGEgPiA1MCAmJiBjYW5TY3JvbGwpIHtcclxuICAgICAgICBjYW5TY3JvbGwgPSBmYWxzZTtcclxuICAgICAgICBjbGVhclRpbWVvdXQoc2Nyb2xsQ29udHJvbGxlcik7XHJcbiAgICAgICAgc2Nyb2xsQ29udHJvbGxlciA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgIGNhblNjcm9sbCA9IHRydWU7XHJcbiAgICAgICAgfSwgMTAwMCk7XHJcbiAgICAgICAgdXBkYXRlSGVscGVyKDEpO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2UgaWYgKGRlbHRhIDwgLTUwICYmIGNhblNjcm9sbCkge1xyXG4gICAgICAgIGNhblNjcm9sbCA9IGZhbHNlO1xyXG4gICAgICAgIGNsZWFyVGltZW91dChzY3JvbGxDb250cm9sbGVyKTtcclxuICAgICAgICBzY3JvbGxDb250cm9sbGVyID0gc2V0VGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgY2FuU2Nyb2xsID0gdHJ1ZTtcclxuICAgICAgICB9LCAxMDAwKTtcclxuICAgICAgICB1cGRhdGVIZWxwZXIoLTEpO1xyXG4gICAgICB9XHJcblxyXG4gICAgfVxyXG4gIH0pO1xyXG4gIFxyXG5cclxuXHJcbiAgLy8gc3dpcGUgc3VwcG9ydCBmb3IgdG91Y2ggZGV2aWNlc1xyXG4gIHZhciB0YXJnZXRFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ZpZXdwb3J0JyksXHJcbiAgICAgIG1jID0gbmV3IEhhbW1lcih0YXJnZXRFbGVtZW50KTtcclxuICBtYy5nZXQoJ3N3aXBlJykuc2V0KHsgZGlyZWN0aW9uOiBIYW1tZXIuRElSRUNUSU9OX1ZFUlRJQ0FMIH0pO1xyXG4gIG1jLm9uKCdzd2lwZXVwIHN3aXBlZG93bicsIGZ1bmN0aW9uKGUpIHtcclxuXHJcbiAgICB1cGRhdGVIZWxwZXIoZSk7XHJcblxyXG4gIH0pO1xyXG5cclxuICAkKGRvY3VtZW50KS5rZXl1cChmdW5jdGlvbihlKXtcclxuXHJcbiAgICBpZiAoISgkKCcub3V0ZXItbmF2JykuaGFzQ2xhc3MoJ2lzLXZpcycpKSkge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHVwZGF0ZUhlbHBlcihlKTtcclxuICAgIH1cclxuXHJcbiAgfSk7XHJcblxyXG4gIGZ1bmN0aW9uIHVwZGF0ZVRvTGFzdFBvcygpe1xyXG4gICAgXHJcbiAgICB2YXIgbGFzdEtub3duUG9zID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgnYWN0aXZlU2VjdGlvbkNsYXNzJyk7XHJcbiAgICBcclxuICAgIGlmICghKCtsYXN0S25vd25Qb3MpKSByZXR1cm47XHJcbiAgICB2YXIgY3VyUG9zID0gMCxcclxuICAgICAgICBsYXN0SXRlbSA9ICQoJy5zaWRlLW5hdicpLmNoaWxkcmVuKCkubGVuZ3RoIC0gMSxcclxuICAgICAgICBuZXh0UG9zID0gbGFzdEtub3duUG9zO1xyXG5cclxuICAgICAgLyppZiAoY3VyUG9zID09IDApe1xyXG4gICAgICAgIG5leHRQb3MgPSBjdXJQb3MgLSAxOyovXHJcbiAgICAgICAgdXBkYXRlTmF2cyhuZXh0UG9zKTtcclxuICAgICAgICB1cGRhdGVDb250ZW50KGN1clBvcywgbmV4dFBvcywgbGFzdEl0ZW0pO1xyXG4gICAgICAvKn1cclxuICAgICAgZWxzZSBpZiAoY3VyUG9zICE9PSBsYXN0SXRlbSkge1xyXG4gICAgICAgIG5leHRQb3MgPSBjdXJQb3MgKyAxO1xyXG4gICAgICAgIHVwZGF0ZU5hdnMobmV4dFBvcyk7XHJcbiAgICAgICAgdXBkYXRlQ29udGVudChjdXJQb3MsIG5leHRQb3MsIGxhc3RJdGVtKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICB1cGRhdGVOYXZzKG5leHRQb3MpO1xyXG4gICAgICAgIHVwZGF0ZUNvbnRlbnQoY3VyUG9zLCBuZXh0UG9zLCBsYXN0SXRlbSk7XHJcbiAgICAgIH0qL1xyXG4gICAgICAgXHJcbiAgfVxyXG5cclxuICAvLyBkZXRlcm1pbmUgc2Nyb2xsLCBzd2lwZSwgYW5kIGFycm93IGtleSBkaXJlY3Rpb25cclxuICBmdW5jdGlvbiB1cGRhdGVIZWxwZXIocGFyYW0pIHtcclxuXHJcbiAgICB2YXIgY3VyQWN0aXZlID0gJCgnLnNpZGUtbmF2JykuZmluZCgnLmlzLWFjdGl2ZScpLFxyXG4gICAgICAgIGN1clBvcyA9ICQoJy5zaWRlLW5hdicpLmNoaWxkcmVuKCkuaW5kZXgoY3VyQWN0aXZlKSxcclxuICAgICAgICBsYXN0SXRlbSA9ICQoJy5zaWRlLW5hdicpLmNoaWxkcmVuKCkubGVuZ3RoIC0gMSxcclxuICAgICAgICBuZXh0UG9zID0gMDtcclxuXHJcbiAgICBpZiAocGFyYW0udHlwZSA9PT0gXCJzd2lwZXVwXCIgfHwgcGFyYW0ua2V5Q29kZSA9PT0gNDAgfHwgcGFyYW0gPiAwKSB7XHJcbiAgICAgIGlmIChjdXJQb3MgIT09IGxhc3RJdGVtKSB7XHJcbiAgICAgICAgbmV4dFBvcyA9IGN1clBvcyArIDE7XHJcbiAgICAgICAgdXBkYXRlTmF2cyhuZXh0UG9zKTtcclxuICAgICAgICB1cGRhdGVDb250ZW50KGN1clBvcywgbmV4dFBvcywgbGFzdEl0ZW0pO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgIHVwZGF0ZU5hdnMobmV4dFBvcyk7XHJcbiAgICAgICAgdXBkYXRlQ29udGVudChjdXJQb3MsIG5leHRQb3MsIGxhc3RJdGVtKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAocGFyYW0udHlwZSA9PT0gXCJzd2lwZWRvd25cIiB8fCBwYXJhbS5rZXlDb2RlID09PSAzOCB8fCBwYXJhbSA8IDApe1xyXG4gICAgICBpZiAoY3VyUG9zICE9PSAwKXtcclxuICAgICAgICBuZXh0UG9zID0gY3VyUG9zIC0gMTtcclxuICAgICAgICB1cGRhdGVOYXZzKG5leHRQb3MpO1xyXG4gICAgICAgIHVwZGF0ZUNvbnRlbnQoY3VyUG9zLCBuZXh0UG9zLCBsYXN0SXRlbSk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgbmV4dFBvcyA9IGxhc3RJdGVtO1xyXG4gICAgICAgIHVwZGF0ZU5hdnMobmV4dFBvcyk7XHJcbiAgICAgICAgdXBkYXRlQ29udGVudChjdXJQb3MsIG5leHRQb3MsIGxhc3RJdGVtKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICB9XHJcblxyXG5cclxuXHJcbiAgLy8gc3luYyBzaWRlIGFuZCBvdXRlciBuYXZpZ2F0aW9uc1xyXG4gIGZ1bmN0aW9uIHVwZGF0ZU5hdnMobmV4dFBvcykge1xyXG5cclxuICAgICQoJy5zaWRlLW5hdiwgLm91dGVyLW5hdicpLmNoaWxkcmVuKCkucmVtb3ZlQ2xhc3MoJ2lzLWFjdGl2ZScpO1xyXG4gICAgJCgnLnNpZGUtbmF2JykuY2hpbGRyZW4oKS5lcShuZXh0UG9zKS5hZGRDbGFzcygnaXMtYWN0aXZlJyk7XHJcbiAgICAkKCcub3V0ZXItbmF2JykuY2hpbGRyZW4oKS5lcShuZXh0UG9zKS5hZGRDbGFzcygnaXMtYWN0aXZlJyk7XHJcblxyXG4gIH1cclxuXHJcblxyXG4gIC8vIHVwZGF0ZSBtYWluIGNvbnRlbnQgYXJlYVxyXG4gIGZ1bmN0aW9uIHVwZGF0ZUNvbnRlbnQoY3VyUG9zLCBuZXh0UG9zLCBsYXN0SXRlbSkge1xyXG5cclxuICAgIC8vIHNhdmUgdGhlIG5leHQgYWN0aXZlIHNlY3Rpb24gZm9yIHRoZSBzZXNzaW9uIHRvIHJlc3RvcmUgb24gcmVsb2FkXHJcbiAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKCdhY3RpdmVTZWN0aW9uQ2xhc3MnLG5leHRQb3MpOyBcclxuXHJcbiAgICAkKCcubWFpbi1jb250ZW50JykuY2hpbGRyZW4oKS5yZW1vdmVDbGFzcygnc2VjdGlvbi0taXMtYWN0aXZlJyk7XHJcbiAgICAkKCcubWFpbi1jb250ZW50JykuY2hpbGRyZW4oKS5lcShuZXh0UG9zKS5hZGRDbGFzcygnc2VjdGlvbi0taXMtYWN0aXZlJyk7XHJcbiAgICAkKCcubWFpbi1jb250ZW50IC5zZWN0aW9uJykuY2hpbGRyZW4oKS5yZW1vdmVDbGFzcygnc2VjdGlvbi0tbmV4dCBzZWN0aW9uLS1wcmV2Jyk7XHJcblxyXG4gICAgaWYgKGN1clBvcyA9PT0gbGFzdEl0ZW0gJiYgbmV4dFBvcyA9PT0gMCB8fCBjdXJQb3MgPT09IDAgJiYgbmV4dFBvcyA9PT0gbGFzdEl0ZW0pIHtcclxuICAgICAgJCgnLm1haW4tY29udGVudCAuc2VjdGlvbicpLmNoaWxkcmVuKCkucmVtb3ZlQ2xhc3MoJ3NlY3Rpb24tLW5leHQgc2VjdGlvbi0tcHJldicpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoY3VyUG9zIDwgbmV4dFBvcykge1xyXG4gICAgICAkKCcubWFpbi1jb250ZW50JykuY2hpbGRyZW4oKS5lcShjdXJQb3MpLmNoaWxkcmVuKCkuYWRkQ2xhc3MoJ3NlY3Rpb24tLW5leHQnKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAkKCcubWFpbi1jb250ZW50JykuY2hpbGRyZW4oKS5lcShjdXJQb3MpLmNoaWxkcmVuKCkuYWRkQ2xhc3MoJ3NlY3Rpb24tLXByZXYnKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAobmV4dFBvcyAhPT0gMCAmJiBuZXh0UG9zICE9PSBsYXN0SXRlbSkge1xyXG4gICAgICAkKCcuaGVhZGVyLS1jdGEnKS5hZGRDbGFzcygnaXMtYWN0aXZlJyk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgJCgnLmhlYWRlci0tY3RhJykucmVtb3ZlQ2xhc3MoJ2lzLWFjdGl2ZScpO1xyXG4gICAgfVxyXG5cclxuICB9XHJcblxyXG5cclxuICBmdW5jdGlvbiBvdXRlck5hdigpIHtcclxuXHJcbiAgICAvKiBPcGVucyB0aGUgbmF2aWdhdGlvbiBtZW51ICovXHJcbiAgICAkKCcuaGVhZGVyLS1uYXYtdG9nZ2xlJykuY2xpY2soZnVuY3Rpb24oKXtcclxuXHJcbiAgICAgICQoJy5wZXJzcGVjdGl2ZScpLmFkZENsYXNzKCdwZXJzcGVjdGl2ZS0tbW9kYWx2aWV3Jyk7XHJcbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAkKCcucGVyc3BlY3RpdmUnKS5hZGRDbGFzcygnZWZmZWN0LXJvdGF0ZS1sZWZ0LS1hbmltYXRlJyk7XHJcbiAgICAgIH0sIDI1KTtcclxuICAgICAgJCgnLm91dGVyLW5hdiwgLm91dGVyLW5hdiBsaSwgLm91dGVyLW5hdi0tcmV0dXJuJykuYWRkQ2xhc3MoJ2lzLXZpcycpO1xyXG5cclxuICAgIH0pO1xyXG5cclxuICAgIC8qIENsb3NlcyB0aGUgbmF2aWdhdGlvbiBtZW51IG9uIGNsaWNrIG9mIGFuIGl0ZW0qLyAgICBcclxuICAgICQoJy5vdXRlci1uYXYtLXJldHVybiwgLm91dGVyLW5hdiBsaScpLmNsaWNrKGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgICAkKCcucGVyc3BlY3RpdmUnKS5yZW1vdmVDbGFzcygnZWZmZWN0LXJvdGF0ZS1sZWZ0LS1hbmltYXRlJyk7XHJcbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAkKCcucGVyc3BlY3RpdmUnKS5yZW1vdmVDbGFzcygncGVyc3BlY3RpdmUtLW1vZGFsdmlldycpO1xyXG4gICAgICB9LCA0MDApO1xyXG4gICAgICAkKCcub3V0ZXItbmF2LCAub3V0ZXItbmF2IGxpLCAub3V0ZXItbmF2LS1yZXR1cm4nKS5yZW1vdmVDbGFzcygnaXMtdmlzJyk7XHJcblxyXG4gICAgfSk7XHJcblxyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gY2hhbmdlU2xpZGVUbyh1cGRhdGVUbyl7XHJcblxyXG4gICAgICB2YXIgY3VyQWN0aXZlID0gJCgnLnNpZGUtbmF2JykuZmluZCgnLmlzLWFjdGl2ZScpLFxyXG4gICAgICAgICAgY3VyUG9zID0gJCgnLnNpZGUtbmF2JykuY2hpbGRyZW4oKS5pbmRleChjdXJBY3RpdmUpLFxyXG4gICAgICAgICAgbGFzdEl0ZW0gPSAkKCcuc2lkZS1uYXYnKS5jaGlsZHJlbigpLmxlbmd0aCAtIDEsXHJcbiAgICAgICAgICBuZXh0UG9zID0gdXBkYXRlVG87XHJcblxyXG4gICAgICAvKmNvbnNvbGUubG9nKCdjdXJBY3RpdmU6ICcgKyBjdXJBY3RpdmUpO1xyXG4gICAgICBjb25zb2xlLmxvZygnY3VyUG9zOiAnK2N1clBvcyk7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdsYXN0SXRlbTogJytsYXN0SXRlbSk7XHJcbiAgICAgIGNvbnNvbGUubG9nKCduZXh0UG9zOiAnK25leHRQb3MpOyovXHJcbiAgICAgIHVwZGF0ZU5hdnModXBkYXRlVG8pO1xyXG4gICAgICB1cGRhdGVDb250ZW50KGN1clBvcywgbmV4dFBvcywgbGFzdEl0ZW0pO1xyXG5cclxuICB9XHJcblxyXG5cclxuICAvKiBFTkQgLSAgZnVuY3Rpb25zIGZvciBuYXZpZ2F0aW5nIHRocm91Z2ggc2xpZGVzICovXHJcblxyXG5cclxuICBmdW5jdGlvbiBhYm91dFNsaWRlcigpIHtcclxuXHJcbiAgICB2YXIgYWJvdXRTbGlkZXIgPSBhYm91dC5maW5kKCcuc2xpZGVyJyk7XHJcbiAgICB2YXIgb3B0aW9ucyA9IGFib3V0LmZpbmQoJy5hYm91dC0tb3B0aW9ucyBhJyk7XHJcblxyXG4gICAgdmFyIHNsaWRpbmdTcGVlZCA9IDE1MDA7XHJcblxyXG4gICAgLypcclxuICAgIHZhciBvdXRlclNsaWRlclByZXZCdG4gPSBvdXRlclNsaWRlci5zaWJsaW5ncygnLnNsaWRlci0tcHJldicpO1xyXG4gICAgdmFyIG91dGVyU2xpZGVyTmV4dEJ0biA9IG91dGVyU2xpZGVyLnNpYmxpbmdzKCcuc2xpZGVyLS1uZXh0Jyk7XHJcbiAgICAqL1xyXG5cclxuICAgIC8qIHZhciBpbm5lclNsaWRlciA9IHdvcmsuZmluZCgnLmlubmVyLXNsaWRlcicpO1xyXG5cclxuICAgIHZhciBpbm5lclNsaWRlclByZXZCdG4gPSB3b3JrLmZpbmQoJy5pbm5lci1zbGlkZXJfX25hdi0tcHJldicpO1xyXG4gICAgdmFyIGlubmVyU2xpZGVyTmV4dEJ0biA9IHdvcmsuZmluZCgnLmlubmVyLXNsaWRlcl9fbmF2LS1uZXh0Jyk7XHJcblxyXG4gICAgdmFyIG91dGVyU2xpZGVyQ29udHJvbHMgPSB3b3JrLmZpbmQoJy5vdXRlci1zbGlkZXJfX2NvbnRyb2xzJyk7XHJcblxyXG4gICAgdmFyIG91dGVyU2xpZGVyUHJldkJ0biA9IHdvcmsuZmluZCgnLm91dGVyLXNsaWRlcl9fbmF2LS1wcmV2Jyk7XHJcbiAgICB2YXIgb3V0ZXJTbGlkZXJOZXh0QnRuID0gd29yay5maW5kKCcub3V0ZXItc2xpZGVyX19uYXYtLW5leHQnKTtcclxuXHJcbiAgICAqL1xyXG5cclxuICAgIC8vIGluaXQgc3dpcGVyIHNsaWRlciBmb3Igb3V0ZXIgc2xpZGVzXHJcbiAgICB2YXIgc3dpcGVyID0gbmV3IFN3aXBlciAoYWJvdXRTbGlkZXIsIHtcclxuICAgICAgaW5pdDogdHJ1ZSxcclxuICAgICAgbG9vcDogdHJ1ZSxcclxuICAgICAgbG9vcGVkU2xpZGVzOiA0LFxyXG4gICAgICBzcGVlZDogc2xpZGluZ1NwZWVkLFxyXG4gICAgICBzbGlkZXNQZXJWaWV3OiAnYXV0bycsXHJcbiAgICAgIGNlbnRlcmVkU2xpZGVzOiB0cnVlLFxyXG4gICAgICBub3JtYWxpemVTbGlkZUluZGV4OiB0cnVlLFxyXG4gICAgICBkaXJlY3Rpb246ICdob3Jpem9udGFsJyxcclxuICAgICAgZWZmZWN0OiAnZmFkZScsXHJcbiAgICAgIG5vcm1hbGl6ZVNsaWRlSW5kZXg6IHRydWUsXHJcbiAgICAgIGZhZGVFZmZlY3Q6IHtcclxuICAgICAgICBjcm9zc0ZhZGU6IHRydWVcclxuICAgICAgfSxcclxuICAgICAgY29udHJvbGxlcjp7XHJcbiAgICAgICAgYnk6ICdzbGlkZSdcclxuICAgICAgfVxyXG4gICAgICAvKixcclxuICAgICAgaGFzaE5hdmlnYXRpb246IHRydWUsXHJcbiAgICAgIGhhc2hOYXZpZ2F0aW9uOiB7XHJcbiAgICAgICAgd2F0Y2hTdGF0ZTogdHJ1ZVxyXG4gICAgICB9Ki9cclxuICAgIH0pO1xyXG5cclxuXHJcbiAgICBvcHRpb25zLm9uKCdjbGljaycsZnVuY3Rpb24oKXtcclxuICAgICAgdmFyICR0aGlzID0gJCh0aGlzKTtcclxuICAgICAgdmFyIHNsaWRlID0gJHRoaXMuZGF0YSgnc2xpZGUnKTtcclxuXHJcbiAgICAgIHN3aXBlci5zbGlkZVRvKE51bWJlcihzbGlkZSksIHNsaWRpbmdTcGVlZCk7XHJcblxyXG5cclxuICAgIH0pO1xyXG5cclxuXHJcbiAgfSAvLyBFTkQgb2YgYWJvdXRTbGlkZXIgRnVuY1xyXG5cclxuXHJcblxyXG5cclxuICBmdW5jdGlvbiB3b3JrU2xpZGVyKCkge1xyXG4gICAgdmFyIGFjdGl2ZUlubmVyU2xpZGVyO1xyXG5cclxuICAgIHZhciBvdXRlclNsaWRlciA9IHdvcmsuZmluZCgnLm91dGVyLXNsaWRlcicpO1xyXG4gICAgICAvKnZhciBvdXRlclNsaWRlclByZXZCdG4gPSBvdXRlclNsaWRlci5zaWJsaW5ncygnLnNsaWRlci0tcHJldicpO1xyXG4gICAgICB2YXIgb3V0ZXJTbGlkZXJOZXh0QnRuID0gb3V0ZXJTbGlkZXIuc2libGluZ3MoJy5zbGlkZXItLW5leHQnKTtcclxuICAgICAgKi9cclxuICAgIHZhciBpbm5lclNsaWRlciA9IHdvcmsuZmluZCgnLmlubmVyLXNsaWRlcicpO1xyXG5cclxuICAgIHZhciBpbm5lclNsaWRlclByZXZCdG4gPSB3b3JrLmZpbmQoJy5pbm5lci1zbGlkZXJfX25hdi0tcHJldicpO1xyXG4gICAgdmFyIGlubmVyU2xpZGVyTmV4dEJ0biA9IHdvcmsuZmluZCgnLmlubmVyLXNsaWRlcl9fbmF2LS1uZXh0Jyk7XHJcblxyXG4gICAgdmFyIG91dGVyU2xpZGVyQ29udHJvbHMgPSB3b3JrLmZpbmQoJy5vdXRlci1zbGlkZXJfX2NvbnRyb2xzJyk7XHJcblxyXG4gICAgdmFyIG91dGVyU2xpZGVyUHJldkJ0biA9IHdvcmsuZmluZCgnLm91dGVyLXNsaWRlcl9fbmF2LS1wcmV2Jyk7XHJcbiAgICB2YXIgb3V0ZXJTbGlkZXJOZXh0QnRuID0gd29yay5maW5kKCcub3V0ZXItc2xpZGVyX19uYXYtLW5leHQnKTtcclxuXHJcbiAgICBcclxuXHJcbiAgICAvLyBpbml0IHN3aXBlciBzbGlkZXIgZm9yIG91dGVyIHNsaWRlc1xyXG4gICAgdmFyIG91dGVyU3dpcGVyID0gbmV3IFN3aXBlciAob3V0ZXJTbGlkZXIsIHtcclxuICAgICAgaW5pdDogZmFsc2UsXHJcbiAgICAgIGxvb3A6IHRydWUsXHJcbiAgICAgIGxvb3BlZFNsaWRlczogNCxcclxuICAgICAgc2xpZGVzUGVyVmlldzogJ2F1dG8nLFxyXG4gICAgICBjZW50ZXJlZFNsaWRlczogdHJ1ZSxcclxuICAgICAgbm9ybWFsaXplU2xpZGVJbmRleDogdHJ1ZSxcclxuICAgICAgZGlyZWN0aW9uOiAndmVydGljYWwnLFxyXG4gICAgICBhbGxvd1RvdWNoTW92ZTogZmFsc2UsXHJcbiAgICAgIGVmZmVjdDogJ3NsaWRlJyxcclxuICAgICAgbm9ybWFsaXplU2xpZGVJbmRleDogdHJ1ZSxcclxuICAgICAgLypmYWRlRWZmZWN0OiB7XHJcbiAgICAgICAgY3Jvc3NGYWRlOiB0cnVlXHJcbiAgICAgIH0sKi9cclxuICAgICAgY29udHJvbGxlcjp7XHJcbiAgICAgICAgYnk6ICdzbGlkZSdcclxuICAgICAgfVxyXG4gICAgICAvKixcclxuICAgICAgaGFzaE5hdmlnYXRpb246IHRydWUsXHJcbiAgICAgIGhhc2hOYXZpZ2F0aW9uOiB7XHJcbiAgICAgICAgd2F0Y2hTdGF0ZTogdHJ1ZVxyXG4gICAgICB9Ki9cclxuICAgIH0pO1xyXG5cclxuXHJcbiAgICAvLyBkZXRlcm1pbmluZyBjdXJyZW50IGlubmVyIHN3aXBlciBpbmRleFxyXG4gICAgdmFyIGN1cnJlbnRJbm5lclN3aXBlckluZGV4O1xyXG4gICAgb3V0ZXJTd2lwZXIub24oJ2luaXQnLGZ1bmN0aW9uICgpIHtcclxuICAgICAgY29uc29sZS5sb2coJ3N3aXBlciBpbml0aWFsaXplZCcpO1xyXG4gICAgICBjdXJyZW50SW5uZXJTd2lwZXJJbmRleCA9IG91dGVyU3dpcGVyLmFjdGl2ZUluZGV4O1xyXG4gICAgICBjb25zb2xlLmxvZygnY3VycmVudElubmVyU3dpcGVySW5kZXg6ICcrIGN1cnJlbnRJbm5lclN3aXBlckluZGV4KTtcclxuICAgIH0pLFxyXG5cclxuICAgIG91dGVyU3dpcGVyLmluaXQoKTsgLy8gaW5pdCBvdXRlclN3aXBlclxyXG5cclxuICAgIHZhciBvdXRlclN3aXBlckNvbnRyb2xzID0gbmV3IFN3aXBlcihvdXRlclNsaWRlckNvbnRyb2xzLCB7XHJcbiAgICAgIGVmZmVjdDogJ3NsaWRlJyxcclxuICAgICAgbm9ybWFsaXplU2xpZGVJbmRleDogdHJ1ZSxcclxuICAgICAgZGlyZWN0aW9uOiAnaG9yaXpvbnRhbCcsXHJcbiAgICAgIGNlbnRlcmVkU2xpZGVzOiB0cnVlLFxyXG4gICAgICBsb29wOiB0cnVlLFxyXG4gICAgICBsb29wZWRTbGlkZXM6IDQsXHJcbiAgICAgIHNsaWRlc1BlclZpZXc6ICdhdXRvJyxcclxuICAgICAgc3BhY2VCZXR3ZWVuOiAzNSxcclxuICAgICAgdG91Y2hSYXRpbzogMC4yLFxyXG4gICAgICBzbGlkZVRvQ2xpY2tlZFNsaWRlOiB0cnVlLFxyXG4gICAgICBub3JtYWxpemVTbGlkZUluZGV4OiB0cnVlLFxyXG4gICAgICBuYXZpZ2F0aW9uOiB7XHJcbiAgICAgICAgbmV4dEVsOiBvdXRlclNsaWRlck5leHRCdG4sXHJcbiAgICAgICAgcHJldkVsOiBvdXRlclNsaWRlclByZXZCdG5cclxuICAgICAgfSxcclxuICAgICAgY29udHJvbGxlcjp7XHJcbiAgICAgICAgYnk6ICdzbGlkZSdcclxuICAgICAgfSxcclxuICAgICAgYnJlYWtwb2ludHM6e1xyXG4gICAgICAgIDcwMDp7XHJcbiAgICAgICAgICBzbGlkZXNQZXJWaWV3OiAnYXV0bycsXHJcbiAgICAgICAgICBzcGFjZUJldHdlZW46IDBcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgfVxyXG5cclxuICAgIH0pO1xyXG5cclxuXHJcbiAgICBvdXRlclN3aXBlckNvbnRyb2xzLmNvbnRyb2xsZXIuY29udHJvbCA9IG91dGVyU3dpcGVyO1xyXG4gICAgb3V0ZXJTd2lwZXIuY29udHJvbGxlci5jb250cm9sID0gb3V0ZXJTd2lwZXJDb250cm9scztcclxuXHJcblxyXG4gICAgLy8gaW5pdCBzd2lwZXIgc2xpZGVyIGZvciBvdXRlciBzbGlkZXNcclxuICAgIHZhciBpbm5lclN3aXBlciA9IG5ldyBTd2lwZXIgKGlubmVyU2xpZGVyLCB7XHJcbiAgICAgIFxyXG4gICAgICBkaXJlY3Rpb246ICdob3Jpem9udGFsJyxcclxuICAgICAgbG9vcDogdHJ1ZSxcclxuICAgICAgc3BhY2VCZXR3ZWVuOiAwLFxyXG4gICAgICAvLyBzbGlkZXNQZXJWaWV3OiAzLFxyXG4gICAgICBzbGlkZXNQZXJWaWV3OiAnYXV0bycsXHJcbiAgICAgIGxvb3BlZFNsaWRlczogNyxcclxuICAgICAgbG9vcEFkZGl0aW9uYWxTbGlkZXM6IDEwLFxyXG4gICAgICBjZW50ZXJlZFNsaWRlczogdHJ1ZSxcclxuICAgICAgc3BhY2VCZXR3ZWVuOiAwLFxyXG5cclxuICAgICAgZWZmZWN0OiAnY292ZXJmbG93JyxcclxuICAgICAgLy8gZ3JhYkN1cnNvcjogdHJ1ZSxcclxuICAgICAgY292ZXJmbG93RWZmZWN0OiB7XHJcbiAgICAgICAgcm90YXRlOiA0MCxcclxuICAgICAgICBzdHJldGNoOiAwLFxyXG4gICAgICAgIGRlcHRoOiAxMDAsXHJcbiAgICAgICAgbW9kaWZpZXI6IDEsXHJcbiAgICAgICAgc2xpZGVTaGFkb3dzIDogdHJ1ZVxyXG4gICAgICB9LFxyXG4gICAgICBub3JtYWxpemVTbGlkZUluZGV4OiB0cnVlLFxyXG4gICAgICBzbGlkZVRvQ2xpY2tlZFNsaWRlOiB0cnVlXHJcblxyXG4gICAgfSk7XHJcblxyXG5cclxuXHJcblxyXG4gICAgLy8gc3dpcGluZyBjdXJyZW50IGlubmVyU3dpcGVyIG9uIGNsaWNrc1xyXG4gICAgXHJcbiAgICB2YXIgc3BlZWQgPSA0MDA7XHJcbiAgICB2YXIgdG91Y2g7XHJcbiAgICBpbm5lclNsaWRlck5leHRCdG4uYWRkKGlubmVyU2xpZGVyUHJldkJ0bikub24oJ2NsaWNrIHRvdWNoc3RhcnQnLGZ1bmN0aW9uKGUpe1xyXG4gICAgICB2YXIgJHRoaXMgPSAkKHRoaXMpO1xyXG4gICAgICBcclxuICAgICAgaWYgKGUudHlwZT09J3RvdWNoc3RhcnQnKSB7XHJcbiAgICAgICAgdG91Y2ggPSB0cnVlO1xyXG5cclxuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICB0b3VjaCA9IGZhbHNlO1xyXG4gICAgICAgIH0sNDAwKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gcmV0dXJuIGlmIGNsaWNrIGZpcmVkIHdpdGhpbiA0MDAgbXMgYWZ0ZXIgdG91Y2hcclxuICAgICAgaWYgKHRvdWNoICYmIGUudHlwZT09J2NsaWNrJykge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuICAgICAgdmFyIGN1cklubmVyU3dpcGVyQ29udCA9IG91dGVyU3dpcGVyLnNsaWRlc1tjdXJyZW50SW5uZXJTd2lwZXJJbmRleF07XHJcbiAgICAgIHZhciBjdXJJbm5lclN3aXBlciA9ICQoY3VySW5uZXJTd2lwZXJDb250KS5maW5kKCcuaW5uZXItc2xpZGVyJylbMF07XHJcbiAgICAgIHZhciBjdXJTd2lwZXJJbnN0YW5jZSA9IGN1cklubmVyU3dpcGVyLnN3aXBlcjtcclxuXHJcbiAgICAgIGlmICgkdGhpcy5oYXNDbGFzcygnaW5uZXItc2xpZGVyX19wcmV2JykpIHtcclxuICAgICAgICAgIGN1cklubmVyU3dpcGVyLnN3aXBlci5zbGlkZVByZXYoNDAwKTtcclxuICAgICAgfWVsc2V7XHJcbiAgICAgICAgICBjdXJJbm5lclN3aXBlci5zd2lwZXIuc2xpZGVOZXh0KDQwMCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICB9KVxyXG5cclxuICAgIFxyXG5cclxuXHJcblxyXG5cclxuXHJcbiAgICAvLyBkZXRlY3Rpbmcgb3V0ZXJTd2lwZXIgdHJhbnNpdGlvbkVuZCB0byBjaGFuZ2UgY3VycmVudElubmVyU3dpcGVySW5kZXhcclxuXHJcbiAgICB2YXIgb3V0ZXJTd2lwZXJUcmlnZ2VyICwgaW1tRmlyZVRpbWVvdXQgPSAyMDA7XHJcbiAgICBvdXRlclN3aXBlci5vbigndHJhbnNpdGlvbkVuZCcsZnVuY3Rpb24oKXtcclxuICAgICAgLy8gc3RvcHBpbmcgaXQgdG8gZXhlY3V0ZSBtdWx0aXBsZSB0aW1lcyBjb25zZWN1dGl2ZWx5XHJcbiAgICAgIGlmIChvdXRlclN3aXBlclRyaWdnZXIpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1lbHNle1xyXG4gICAgICAgIG91dGVyU3dpcGVyVHJpZ2dlciA9IHRydWU7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnNvbGUubG9nKCdjaGFuZ2VkJyk7XHJcblxyXG4gICAgICBjdXJyZW50SW5uZXJTd2lwZXJJbmRleCA9IG91dGVyU3dpcGVyLmFjdGl2ZUluZGV4O1xyXG4gICAgICBjb25zb2xlLmxvZygnY3VycmVudElubmVyU3dpcGVySW5kZXg6ICcrIGN1cnJlbnRJbm5lclN3aXBlckluZGV4KTtcclxuXHJcblxyXG4gICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgIG91dGVyU3dpcGVyVHJpZ2dlciA9IHVuZGVmaW5lZDtcclxuICAgICAgfSxpbW1GaXJlVGltZW91dCk7IC8vIGFsbG93aW5nIHRoZSBjYWxsYmFjayB0byBydW4gYWZ0ZXIgYSBjZXJ0YWluIHRpbWVcclxuXHJcbiAgICB9KTtcclxuXHJcbiAgfSAvLyBFTkQgb2Ygd29ya1NsaWRlciBGdW5jXHJcblxyXG4gIFxyXG5cclxuICBmdW5jdGlvbiB0cmFuc2l0aW9uTGFiZWxzKCkge1xyXG5cclxuICAgIGZvcm1GaWVsZHMuZm9jdXNvdXQoZnVuY3Rpb24oKXtcclxuXHJcbiAgICAgIHZhciB0ZXh0VmFsID0gJCh0aGlzKS52YWwoKTtcclxuXHJcbiAgICAgIGlmICh0ZXh0VmFsID09PSBcIlwiKSB7XHJcbiAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcygnaGFzLXZhbHVlJyk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgJCh0aGlzKS5hZGRDbGFzcygnaGFzLXZhbHVlJyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIGNvcnJlY3QgbW9iaWxlIGRldmljZSB3aW5kb3cgcG9zaXRpb25cclxuICAgICAgd2luZG93LnNjcm9sbFRvKDAsIDApO1xyXG5cclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG5cclxuICBmdW5jdGlvbiBzbWFsbFNjcmVlbk9wdGltaXplckZvckZvcm1zKCl7XHJcblxyXG4gICAgICBmb3JtRmllbGRzLm9uKCdmb2N1c2luJyxmdW5jdGlvbigpe1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdmb2N1c2luJyk7XHJcbiAgICAgICAgYm9keS5hZGRDbGFzcygnZm9ybS1maWVsZC1mb2N1c2VkJyk7IC8vIGFkZCBjbGFzcyBvZiBmb3JtLWZpZWxkLWZvY3VzZWQgdG8gYm9keVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGZvcm1GaWVsZHMub24oJ2ZvY3Vzb3V0JyxmdW5jdGlvbigpe1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdmb2N1c2luJyk7XHJcbiAgICAgICAgYm9keS5yZW1vdmVDbGFzcygnZm9ybS1maWVsZC1mb2N1c2VkJyk7IC8vIGFkZCBjbGFzcyBvZiBmb3JtLWZpZWxkLWZvY3VzZWQgdG8gYm9keVxyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG5cclxuICBmdW5jdGlvbiBzdGFydFByb2plY3RGb3JtKCl7XHJcbiAgICAgIHZhciBzdGFydFByb2plY3RGb3JtID0gJCgnI3N0YXJ0UHJvamVjdEZvcm0nKTtcclxuXHJcbiAgICAgIHZhciBuYW1lRmllbGQgPSAkKCcjbmFtZVNQJyk7XHJcbiAgICAgIHZhciBlbWFpbEZpZWxkID0gJCgnI2VtYWlsU1AnKTtcclxuICAgICAgdmFyIHdlYlNlcnZpY2VGaWVsZCA9ICQoJyNzZXJ2aWNlLXdlYicpO1xyXG4gICAgICB2YXIgc2VydmljZXNDb250ID0gd2ViU2VydmljZUZpZWxkLmNsb3Nlc3QoJy53b3JrLXJlcXVlc3QtLXNlcnZpY2VzJyk7XHJcblxyXG5cclxuICAgICAgLy8gY2hhbmdlIHZhbGlkYXRpb24gbWVzc2FnZXMgYW5kIGN1c3RvbWl6ZSBvcHRpb25zXHJcblxyXG4gICAgICBzdGFydFByb2plY3RGb3JtLnBhcnNsZXkoe1xyXG4gICAgICAgIHJlcXVpcmVkTWVzc2FnZTogJ1RoaXMgZmllbGQgaXMgcmVxdWlyZWQnXHJcbiAgICAgICAgXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgZW1haWxGaWVsZC5wYXJzbGV5KHtcclxuICAgICAgICB0eXBlTWVzc2FnZTogXCJFbnRlciBhIHZhbGlkIGUtbWFpbCBhZGRyZXNzXCJcclxuICAgICAgfSk7XHJcblxyXG4gICAgICB3ZWJTZXJ2aWNlRmllbGQucGFyc2xleSh7XHJcbiAgICAgICAgcmVxdWlyZWRNZXNzYWdlOiBcIlBsZWFzZSBzZWxlY3QgdGhlIGRpZ2l0YWwgc2VydmljZS9zIHlvdSB3YW50IHVzIHRvIHdvcmsgb25cIiwgLy8gb25seSB3b3JrcyB3aGVuIHVzaW5nIHRoZSBmaXJzdCBjaGVja2JveCBpbiB0aGUgZ3JvdXBcclxuICAgICAgICBlcnJvcnNDb250YWluZXI6IGZ1bmN0aW9uIChGaWVsZCkge1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICByZXR1cm4gc2VydmljZXNDb250O1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgY2xhc3NIYW5kbGVyOiBmdW5jdGlvbiAoRmllbGQpIHtcclxuICAgICAgICAgIHJldHVybiBzZXJ2aWNlc0NvbnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuXHJcblxyXG4gICAgICAvLyBhY3QgdG8gdmFsaWRhdGlvbiBlcnJvcnMgYW5kIHN1Y2Nlc3MgXHJcblxyXG4gICAgICBzdGFydFByb2plY3RGb3JtLnBhcnNsZXkoKS5vbignZm9ybTplcnJvcicsZnVuY3Rpb24oKXtcclxuXHJcbiAgICAgICAgICBhbGVydCgndmFsaWRhdGlvbiBlcnJvcnMnKTsgIFxyXG5cclxuICAgICAgfSkub24oJ2Zvcm06c3VibWl0JyxmdW5jdGlvbihlKXtcclxuXHJcbiAgICAgICAgICBjb25zb2xlLmxvZygnRm9ybSBTdWJtaXR0ZWQnKTtcclxuXHJcbiAgICAgICAgICAvLyB3cml0ZSBjb2RlIGhlcmUgdG8gc3VibWl0IHRvIERCXHJcblxyXG4gICAgICAgICAgXHJcblxyXG4gICAgICAgICAgcmV0dXJuIGZhbHNlOyAgXHJcbiAgICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGNvbnRhY3RGb3JtKCl7XHJcbiAgICAvLyBhbGVydCgpO1xyXG4gICAgdmFyIHBvcHVwID0gJCgnI2NvbnRhY3RfX3BvcHVwJyk7XHJcbiAgICB2YXIgY2xvc2UgPSAkKCcjY2xvc2UtY29udGFjdC1mb3JtJyk7XHJcblxyXG4gICAgY29uc29sZS5sb2cocG9wdXApO1xyXG5cclxuICAgIC8vIGRpc2FibGluZyBzd2lwaW5nIHNsaWRlIHdoZW4gcG9wdXAgaXMgb3BlblxyXG5cclxuICAgIHBvcHVwLm9uKCdtb3VzZXdoZWVsIERPTU1vdXNlU2Nyb2xsJyxmdW5jdGlvbihlKXtcclxuICAgICAgY29uc29sZS5sb2coZSk7XHJcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBzd2lwZSBzdXBwb3J0IGZvciB0b3VjaCBkZXZpY2VzXHJcbiAgICB2YXIgdGFyZ2V0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2aWV3cG9ydCcpLFxyXG4gICAgICAgIG1jID0gbmV3IEhhbW1lcih0YXJnZXRFbGVtZW50KTtcclxuICAgIG1jLmdldCgnc3dpcGUnKS5zZXQoeyBkaXJlY3Rpb246IEhhbW1lci5ESVJFQ1RJT05fVkVSVElDQUwgfSk7XHJcbiAgICBtYy5vbignc3dpcGV1cCBzd2lwZWRvd24nLCBmdW5jdGlvbihlKSB7XHJcblxyXG4gICAgICBjb25zb2xlLmxvZyhlKTtcclxuXHJcbiAgICB9KTtcclxuXHJcbiAgICBjbG9zZS5vbignY2xpY2snLGZ1bmN0aW9uKCl7XHJcbiAgICAgIHBvcHVwLnRvZ2dsZUNsYXNzKCdvZmYnKTtcclxuICAgIH0pO1xyXG5cclxuXHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBnZXRWaWV3cG9ydEJhc2VkSFcocGVyY2VudGFnZSx1bml0KXtcclxuXHJcbiAgICByZXR1cm4gcGVyY2VudGFnZS8xMDAgKiB3aW5kb3dbdW5pdF07XHJcblxyXG4gIH0gLyogZ2V0Vmlld3BvcnRCYXNlZEhXIEVORFMgKi9cclxuXHJcblxyXG4gIGZ1bmN0aW9uIGFwcGx5Vmlld3BvcnRIZWlnaHRzKCl7XHJcbiAgICB2YXIgbF92aWV3cG9ydCA9ICBib2R5LmZpbmQoJy5sLXZpZXdwb3J0Jyk7IFxyXG5cclxuICAgIHZhciB3b3JrX19sb2NrdXAgPSB3b3JrLmZpbmQoJy53b3JrX19sb2NrdXAnKTsgLy8gcXVlcmluZyBmb3IgdXNpbmcgZnVydGhlclxyXG5cclxuICAgIHZhciBvdXRlclNsaWRlciA9ICB3b3JrX19sb2NrdXAuZmluZCgnLm91dGVyLXNsaWRlcicpOyBcclxuXHJcbiAgICB2YXIgaW5uZXJTbGlkZXJJdGVtSW1hZ2VDb250YWluZXIgPSAgXHJcbiAgICB3b3JrX19sb2NrdXAuZmluZCgnLmlubmVyLXNsaWRlcl9faXRlbS1pbWFnZS1jb250YWluZXInKTsgXHJcblxyXG5cclxuICAgIGxfdmlld3BvcnQuY3NzKHtcclxuICAgICAgaGVpZ2h0OiAoZ2V0Vmlld3BvcnRCYXNlZEhXKDEwMCwndmgnKSkgKyAncHgnIC8vIGhlaWdodCBuZWVkcyB0byBiZSAxMDB2aFxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIG91dGVyU2xpZGVyLmNzcyh7XHJcbiAgICAgIGhlaWdodDogKGdldFZpZXdwb3J0QmFzZWRIVyg3NSwndm1pbicpKSArICdweCcgLy8gaGVpZ2h0IG5lZWRzIHRvIGJlIDc1dm1pblxyXG4gICAgfSk7XHJcblxyXG4gICAgaW5uZXJTbGlkZXJJdGVtSW1hZ2VDb250YWluZXIuY3NzKHtcclxuICAgICAgaGVpZ2h0OiAoZ2V0Vmlld3BvcnRCYXNlZEhXKDQwLCd2bWluJykpICsgJ3B4JyAvLyBoZWlnaHQgbmVlZHMgdG8gYmUgNDB2bWluXHJcbiAgICB9KTtcclxuXHJcbiAgICAvKiBcclxuICAgICAgdXNpbmcgbWluIHdpZHRocyAod2hlbiBkZWZhdWx0IGFyZSBhbHJlYWR5IGFwcGxpZWQgXHJcbiAgICAgIGJ1dCBuZWVkcyB0byBiZSBvdmVyd3JpdHRlbiB3aXRoIGluY3JlYXNpbmcgd2lkdGhzKVxyXG4gICAgKi9cclxuXHJcbiAgICBpZiAodncgPiA3NjcpIHtcclxuICAgICAgaW5uZXJTbGlkZXJJdGVtSW1hZ2VDb250YWluZXIuY3NzKHtcclxuICAgICAgICBoZWlnaHQ6IChnZXRWaWV3cG9ydEJhc2VkSFcoMjUsJ3ZtaW4nKSkgKyAncHgnIC8vIGhlaWdodCBuZWVkcyB0byBiZSAyNXZtaW5cclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHZ3ID4gODk5KSB7XHJcblxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBpZiAodncgPiAxMTk5KSB7XHJcbiAgICAgIG91dGVyU2xpZGVyLmNzcyh7XHJcbiAgICAgICAgaGVpZ2h0OiAoZ2V0Vmlld3BvcnRCYXNlZEhXKDU1LCd2bWluJykpICsgJ3B4JyAvLyBoZWlnaHQgbmVlZHMgdG8gYmUgNzV2bWluXHJcbiAgICAgIH0pO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBcclxuXHJcbiAgICBcclxuXHJcblxyXG4gICAgLyogdXNpbmcgbWF4IHdpZHRocyovXHJcblxyXG4gICAgaWYgKHZ3IDwgNDAwKSB7XHJcbiAgICAgICAgaW5uZXJTbGlkZXJJdGVtSW1hZ2VDb250YWluZXIuY3NzKHtcclxuICAgICAgICAgIGhlaWdodDogKGdldFZpZXdwb3J0QmFzZWRIVygzNSwndm1pbicpKSArICdweCcgLy8gaGVpZ2h0IG5lZWRzIHRvIGJlIDM1dm1pblxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qIHVzaW5nIG1heCB3aWR0aHMgYW5kIG9yaWVudGF0aW9uKi9cclxuXHJcbiAgICBpZiAodncgPiB2aCkge1xyXG5cclxuICAgICAgaW5uZXJTbGlkZXJJdGVtSW1hZ2VDb250YWluZXIuY3NzKHtcclxuICAgICAgICAnbWluLWhlaWdodCc6ICdhdXRvJyAvLyBoZWlnaHQgbmVlZHMgdG8gYmUgMjV2bWluXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgaWYgKHZ3IDwgMTIwMCAmJiB2dyA+IHZoKSB7XHJcbiAgICAgICAgICBpbm5lclNsaWRlckl0ZW1JbWFnZUNvbnRhaW5lci5jc3Moe1xyXG4gICAgICAgICAgICBoZWlnaHQ6IChnZXRWaWV3cG9ydEJhc2VkSFcoMzAsJ3ZtaW4nKSkgKyAncHgnIC8vIGhlaWdodCBuZWVkcyB0byBiZSAyNXZtaW5cclxuICAgICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuXHJcblxyXG5cclxuXHJcbiAgfSAvKiBhcHBseVZpZXdwb3J0SGVpZ2h0cyBFTkRTICovXHJcblxyXG5cclxuXHJcbiAgJCh3aW5kb3cpLm9uKCdyZXNpemUnLGZ1bmN0aW9uKCl7XHJcbiAgICB2aWV3cG9ydERpbWVuc2lvbnMoKTtcclxuICAgIGFwcGx5Vmlld3BvcnRIZWlnaHRzKCk7XHJcbiAgfSk7IC8qIG9uIHJlc2l6ZSBFTkRTICovXHJcbiAgXHJcblxyXG5cclxuICBvdXRlck5hdigpO1xyXG4gIGFib3V0U2xpZGVyKCk7XHJcbiAgd29ya1NsaWRlcigpO1xyXG5cclxuICB0cmFuc2l0aW9uTGFiZWxzKCk7XHJcbiAgc21hbGxTY3JlZW5PcHRpbWl6ZXJGb3JGb3JtcygpO1xyXG5cclxuICBzdGFydFByb2plY3RGb3JtKCk7XHJcbiAgY29udGFjdEZvcm0oKTtcclxuXHJcbiAgYXBwbHlWaWV3cG9ydEhlaWdodHMoKTtcclxuXHJcblxyXG59KTtcclxuXHJcblxyXG5cclxuXHJcblxyXG4vKiBcclxuXHJcbiAkKCcuc2xpZGVyLS1wcmV2LCAuc2xpZGVyLS1uZXh0JykuY2xpY2soZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICB2YXIgJHRoaXMgPSAkKHRoaXMpLFxyXG4gICAgICAgICAgY3VyTGVmdCA9ICQoJy5zbGlkZXInKS5maW5kKCcuc2xpZGVyLS1pdGVtLWxlZnQnKSxcclxuICAgICAgICAgIGN1ckxlZnRQb3MgPSAkKCcuc2xpZGVyJykuY2hpbGRyZW4oKS5pbmRleChjdXJMZWZ0KSxcclxuICAgICAgICAgIGN1ckNlbnRlciA9ICQoJy5zbGlkZXInKS5maW5kKCcuc2xpZGVyLS1pdGVtLWNlbnRlcicpLFxyXG4gICAgICAgICAgY3VyQ2VudGVyUG9zID0gJCgnLnNsaWRlcicpLmNoaWxkcmVuKCkuaW5kZXgoY3VyQ2VudGVyKSxcclxuICAgICAgICAgIGN1clJpZ2h0ID0gJCgnLnNsaWRlcicpLmZpbmQoJy5zbGlkZXItLWl0ZW0tcmlnaHQnKSxcclxuICAgICAgICAgIGN1clJpZ2h0UG9zID0gJCgnLnNsaWRlcicpLmNoaWxkcmVuKCkuaW5kZXgoY3VyUmlnaHQpLFxyXG4gICAgICAgICAgdG90YWxXb3JrcyA9ICQoJy5zbGlkZXInKS5jaGlsZHJlbigpLmxlbmd0aCxcclxuICAgICAgICAgICRsZWZ0ID0gJCgnLnNsaWRlci0taXRlbS1sZWZ0JyksXHJcbiAgICAgICAgICAkY2VudGVyID0gJCgnLnNsaWRlci0taXRlbS1jZW50ZXInKSxcclxuICAgICAgICAgICRyaWdodCA9ICQoJy5zbGlkZXItLWl0ZW0tcmlnaHQnKSxcclxuICAgICAgICAgICRpdGVtID0gJCgnLnNsaWRlci0taXRlbScpO1xyXG5cclxuICAgICAgJCgnLnNsaWRlcicpLmFuaW1hdGUoeyBvcGFjaXR5IDogMCB9LCA0MDApO1xyXG5cclxuICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xyXG5cclxuICAgICAgaWYgKCR0aGlzLmhhc0NsYXNzKCdzbGlkZXItLW5leHQnKSkge1xyXG4gICAgICAgIGlmIChjdXJMZWZ0UG9zIDwgdG90YWxXb3JrcyAtIDEgJiYgY3VyQ2VudGVyUG9zIDwgdG90YWxXb3JrcyAtIDEgJiYgY3VyUmlnaHRQb3MgPCB0b3RhbFdvcmtzIC0gMSkge1xyXG4gICAgICAgICAgJGxlZnQucmVtb3ZlQ2xhc3MoJ3NsaWRlci0taXRlbS1sZWZ0JykubmV4dCgpLmFkZENsYXNzKCdzbGlkZXItLWl0ZW0tbGVmdCcpO1xyXG4gICAgICAgICAgJGNlbnRlci5yZW1vdmVDbGFzcygnc2xpZGVyLS1pdGVtLWNlbnRlcicpLm5leHQoKS5hZGRDbGFzcygnc2xpZGVyLS1pdGVtLWNlbnRlcicpO1xyXG4gICAgICAgICAgJHJpZ2h0LnJlbW92ZUNsYXNzKCdzbGlkZXItLWl0ZW0tcmlnaHQnKS5uZXh0KCkuYWRkQ2xhc3MoJ3NsaWRlci0taXRlbS1yaWdodCcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgIGlmIChjdXJMZWZ0UG9zID09PSB0b3RhbFdvcmtzIC0gMSkge1xyXG4gICAgICAgICAgICAkaXRlbS5yZW1vdmVDbGFzcygnc2xpZGVyLS1pdGVtLWxlZnQnKS5maXJzdCgpLmFkZENsYXNzKCdzbGlkZXItLWl0ZW0tbGVmdCcpO1xyXG4gICAgICAgICAgICAkY2VudGVyLnJlbW92ZUNsYXNzKCdzbGlkZXItLWl0ZW0tY2VudGVyJykubmV4dCgpLmFkZENsYXNzKCdzbGlkZXItLWl0ZW0tY2VudGVyJyk7XHJcbiAgICAgICAgICAgICRyaWdodC5yZW1vdmVDbGFzcygnc2xpZGVyLS1pdGVtLXJpZ2h0JykubmV4dCgpLmFkZENsYXNzKCdzbGlkZXItLWl0ZW0tcmlnaHQnKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGVsc2UgaWYgKGN1ckNlbnRlclBvcyA9PT0gdG90YWxXb3JrcyAtIDEpIHtcclxuICAgICAgICAgICAgJGxlZnQucmVtb3ZlQ2xhc3MoJ3NsaWRlci0taXRlbS1sZWZ0JykubmV4dCgpLmFkZENsYXNzKCdzbGlkZXItLWl0ZW0tbGVmdCcpO1xyXG4gICAgICAgICAgICAkaXRlbS5yZW1vdmVDbGFzcygnc2xpZGVyLS1pdGVtLWNlbnRlcicpLmZpcnN0KCkuYWRkQ2xhc3MoJ3NsaWRlci0taXRlbS1jZW50ZXInKTtcclxuICAgICAgICAgICAgJHJpZ2h0LnJlbW92ZUNsYXNzKCdzbGlkZXItLWl0ZW0tcmlnaHQnKS5uZXh0KCkuYWRkQ2xhc3MoJ3NsaWRlci0taXRlbS1yaWdodCcpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICRsZWZ0LnJlbW92ZUNsYXNzKCdzbGlkZXItLWl0ZW0tbGVmdCcpLm5leHQoKS5hZGRDbGFzcygnc2xpZGVyLS1pdGVtLWxlZnQnKTtcclxuICAgICAgICAgICAgJGNlbnRlci5yZW1vdmVDbGFzcygnc2xpZGVyLS1pdGVtLWNlbnRlcicpLm5leHQoKS5hZGRDbGFzcygnc2xpZGVyLS1pdGVtLWNlbnRlcicpO1xyXG4gICAgICAgICAgICAkaXRlbS5yZW1vdmVDbGFzcygnc2xpZGVyLS1pdGVtLXJpZ2h0JykuZmlyc3QoKS5hZGRDbGFzcygnc2xpZGVyLS1pdGVtLXJpZ2h0Jyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgIGlmIChjdXJMZWZ0UG9zICE9PSAwICYmIGN1ckNlbnRlclBvcyAhPT0gMCAmJiBjdXJSaWdodFBvcyAhPT0gMCkge1xyXG4gICAgICAgICAgJGxlZnQucmVtb3ZlQ2xhc3MoJ3NsaWRlci0taXRlbS1sZWZ0JykucHJldigpLmFkZENsYXNzKCdzbGlkZXItLWl0ZW0tbGVmdCcpO1xyXG4gICAgICAgICAgJGNlbnRlci5yZW1vdmVDbGFzcygnc2xpZGVyLS1pdGVtLWNlbnRlcicpLnByZXYoKS5hZGRDbGFzcygnc2xpZGVyLS1pdGVtLWNlbnRlcicpO1xyXG4gICAgICAgICAgJHJpZ2h0LnJlbW92ZUNsYXNzKCdzbGlkZXItLWl0ZW0tcmlnaHQnKS5wcmV2KCkuYWRkQ2xhc3MoJ3NsaWRlci0taXRlbS1yaWdodCcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgIGlmIChjdXJMZWZ0UG9zID09PSAwKSB7XHJcbiAgICAgICAgICAgICRpdGVtLnJlbW92ZUNsYXNzKCdzbGlkZXItLWl0ZW0tbGVmdCcpLmxhc3QoKS5hZGRDbGFzcygnc2xpZGVyLS1pdGVtLWxlZnQnKTtcclxuICAgICAgICAgICAgJGNlbnRlci5yZW1vdmVDbGFzcygnc2xpZGVyLS1pdGVtLWNlbnRlcicpLnByZXYoKS5hZGRDbGFzcygnc2xpZGVyLS1pdGVtLWNlbnRlcicpO1xyXG4gICAgICAgICAgICAkcmlnaHQucmVtb3ZlQ2xhc3MoJ3NsaWRlci0taXRlbS1yaWdodCcpLnByZXYoKS5hZGRDbGFzcygnc2xpZGVyLS1pdGVtLXJpZ2h0Jyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBlbHNlIGlmIChjdXJDZW50ZXJQb3MgPT09IDApIHtcclxuICAgICAgICAgICAgJGxlZnQucmVtb3ZlQ2xhc3MoJ3NsaWRlci0taXRlbS1sZWZ0JykucHJldigpLmFkZENsYXNzKCdzbGlkZXItLWl0ZW0tbGVmdCcpO1xyXG4gICAgICAgICAgICAkaXRlbS5yZW1vdmVDbGFzcygnc2xpZGVyLS1pdGVtLWNlbnRlcicpLmxhc3QoKS5hZGRDbGFzcygnc2xpZGVyLS1pdGVtLWNlbnRlcicpO1xyXG4gICAgICAgICAgICAkcmlnaHQucmVtb3ZlQ2xhc3MoJ3NsaWRlci0taXRlbS1yaWdodCcpLnByZXYoKS5hZGRDbGFzcygnc2xpZGVyLS1pdGVtLXJpZ2h0Jyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgJGxlZnQucmVtb3ZlQ2xhc3MoJ3NsaWRlci0taXRlbS1sZWZ0JykucHJldigpLmFkZENsYXNzKCdzbGlkZXItLWl0ZW0tbGVmdCcpO1xyXG4gICAgICAgICAgICAkY2VudGVyLnJlbW92ZUNsYXNzKCdzbGlkZXItLWl0ZW0tY2VudGVyJykucHJldigpLmFkZENsYXNzKCdzbGlkZXItLWl0ZW0tY2VudGVyJyk7XHJcbiAgICAgICAgICAgICRpdGVtLnJlbW92ZUNsYXNzKCdzbGlkZXItLWl0ZW0tcmlnaHQnKS5sYXN0KCkuYWRkQ2xhc3MoJ3NsaWRlci0taXRlbS1yaWdodCcpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgIH0sIDQwMCk7XHJcblxyXG4gICAgJCgnLnNsaWRlcicpLmFuaW1hdGUoeyBvcGFjaXR5IDogMSB9LCA0MDApO1xyXG5cclxuICAgIH0pO1xyXG5cclxuXHJcblxyXG4qLyJdfQ==
