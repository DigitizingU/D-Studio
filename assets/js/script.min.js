$(document).ready(function(){var e=$(".work"),i=($(".hire"),!0),n=null;$(this).on("mousewheel DOMMouseScroll",function(e){if(!$(".outer-nav").hasClass("is-vis")){e.preventDefault();var t=e.originalEvent.wheelDelta?-e.originalEvent.wheelDelta:20*e.originalEvent.detail;t>50&&i?(i=!1,clearTimeout(n),n=setTimeout(function(){i=!0},800),d(1)):t<-50&&i&&(i=!1,clearTimeout(n),n=setTimeout(function(){i=!0},800),d(-1))}}),$(".side-nav li, .outer-nav li").click(function(){if(!$(this).hasClass("is-active")){var e=$(this),i=e.parent().find(".is-active"),n=e.parent().children().index(i),t=e.parent().children().index(e),r=$(this).parent().children().length-1;c(t),v(n,t,r)}}),$(".cta").click(function(){var e=$(".side-nav").find(".is-active"),i=$(".side-nav").children().index(e),n=$(".side-nav").children().length-1,t=n;c(n),v(i,t,n)});var t,r,o,s,a=document.getElementById("viewport"),l=new Hammer(a);function d(e){var i=$(".side-nav").find(".is-active"),n=$(".side-nav").children().index(i),t=$(".side-nav").children().length-1,r=0;"swipeup"===e.type||40===e.keyCode||e>0?n!==t?(c(r=n+1),v(n,r,t)):(c(r),v(n,r,t)):("swipedown"===e.type||38===e.keyCode||e<0)&&(0!==n?(c(r=n-1),v(n,r,t)):(c(r=t),v(n,r,t)))}function c(e){$(".side-nav, .outer-nav").children().removeClass("is-active"),$(".side-nav").children().eq(e).addClass("is-active"),$(".outer-nav").children().eq(e).addClass("is-active")}function v(e,i,n){$(".main-content").children().removeClass("section--is-active"),$(".main-content").children().eq(i).addClass("section--is-active"),$(".main-content .section").children().removeClass("section--next section--prev"),e===n&&0===i||0===e&&i===n?$(".main-content .section").children().removeClass("section--next section--prev"):e<i?$(".main-content").children().eq(e).children().addClass("section--next"):$(".main-content").children().eq(e).children().addClass("section--prev"),0!==i&&i!==n?$(".header--cta").addClass("is-active"):$(".header--cta").removeClass("is-active")}l.get("swipe").set({direction:Hammer.DIRECTION_VERTICAL}),l.on("swipeup swipedown",function(e){d(e)}),$(document).keyup(function(e){$(".outer-nav").hasClass("is-vis")||(e.preventDefault(),d(e))}),$(".header--nav-toggle").click(function(){$(".perspective").addClass("perspective--modalview"),setTimeout(function(){$(".perspective").addClass("effect-rotate-left--animate")},25),$(".outer-nav, .outer-nav li, .outer-nav--return").addClass("is-vis")}),$(".outer-nav--return, .outer-nav li").click(function(){$(".perspective").removeClass("effect-rotate-left--animate"),setTimeout(function(){$(".perspective").removeClass("perspective--modalview")},400),$(".outer-nav, .outer-nav li, .outer-nav--return").removeClass("is-vis")}),function(){var i,n=e.find(".outer-slider"),t=e.find(".inner-slider"),r=e.find(".inner-slider__nav--prev"),o=e.find(".inner-slider__nav--next"),s=e.find(".outer-slider__controls"),a=e.find(".outer-slider__nav--prev"),l=e.find(".outer-slider__nav--next"),d=new Swiper(n,{init:!1,loop:!0,loopedSlides:4,slidesPerView:"auto",centeredSlides:!0,normalizeSlideIndex:!0,direction:"vertical",allowTouchMove:!1,effect:"slide",normalizeSlideIndex:!0,controller:{by:"slide"}});d.on("init",function(){console.log("swiper initialized"),i=d.activeIndex,console.log("currentInnerSwiperIndex: "+i)}),d.init();var c,v,u=new Swiper(s,{effect:"slide",normalizeSlideIndex:!0,direction:"horizontal",centeredSlides:!0,loop:!0,loopedSlides:4,slidesPerView:"auto",spaceBetween:35,touchRatio:.2,slideToClickedSlide:!0,normalizeSlideIndex:!0,navigation:{nextEl:l,prevEl:a},controller:{by:"slide"},breakpoints:{700:{slidesPerView:"auto",spaceBetween:0}}});u.controller.control=d,d.controller.control=u,new Swiper(t,{direction:"horizontal",loop:!0,spaceBetween:0,slidesPerView:"auto",loopedSlides:7,loopAdditionalSlides:10,centeredSlides:!0,spaceBetween:0,effect:"coverflow",coverflowEffect:{rotate:40,stretch:0,depth:100,modifier:1,slideShadows:!0},normalizeSlideIndex:!0,slideToClickedSlide:!0}),o.add(r).on("click touchstart",function(e){var n=$(this);if("touchstart"==e.type&&(c=!0,setTimeout(function(){c=!1},400)),!c||"click"!=e.type){var t=d.slides[i],r=$(t).find(".inner-slider")[0];r.swiper,n.hasClass("inner-slider__prev")?r.swiper.slidePrev(400):r.swiper.slideNext(400)}}),d.on("transitionEnd",function(){v||(v=!0,console.log("changed"),i=d.activeIndex,console.log("currentInnerSwiperIndex: "+i),window.setTimeout(function(){v=void 0},200))})}(),$(".work-request--information input").focusout(function(){""===$(this).val()?$(this).removeClass("has-value"):$(this).addClass("has-value"),window.scrollTo(0,0)}),t=$("#startProjectForm"),$("#nameSP"),r=$("#emailSP"),o=$("#service-web"),s=o.closest(".work-request--services"),t.parsley({requiredMessage:"This field is required"}),r.parsley({typeMessage:"Enter a valid e-mail address"}),o.parsley({requiredMessage:"Please select the digital service/s you want us to work on",errorsContainer:function(e){return s},classHandler:function(e){return s}}),t.parsley().on("form:error",function(){alert("validation errors")}).on("form:submit",function(e){return console.log("Form Submitted"),!1})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyJdLCJuYW1lcyI6WyIkIiwiZG9jdW1lbnQiLCJyZWFkeSIsIndvcmsiLCJjYW5TY3JvbGwiLCJzY3JvbGxDb250cm9sbGVyIiwidGhpcyIsIm9uIiwiZSIsImhhc0NsYXNzIiwicHJldmVudERlZmF1bHQiLCJkZWx0YSIsIm9yaWdpbmFsRXZlbnQiLCJ3aGVlbERlbHRhIiwiZGV0YWlsIiwiY2xlYXJUaW1lb3V0Iiwic2V0VGltZW91dCIsInVwZGF0ZUhlbHBlciIsImNsaWNrIiwiJHRoaXMiLCJjdXJBY3RpdmUiLCJwYXJlbnQiLCJmaW5kIiwiY3VyUG9zIiwiY2hpbGRyZW4iLCJpbmRleCIsIm5leHRQb3MiLCJsYXN0SXRlbSIsImxlbmd0aCIsInVwZGF0ZU5hdnMiLCJ1cGRhdGVDb250ZW50Iiwic3RhcnRQcm9qZWN0Rm9ybSIsImVtYWlsRmllbGQiLCJ3ZWJTZXJ2aWNlRmllbGQiLCJzZXJ2aWNlc0NvbnQiLCJ0YXJnZXRFbGVtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJtYyIsIkhhbW1lciIsInBhcmFtIiwidHlwZSIsImtleUNvZGUiLCJyZW1vdmVDbGFzcyIsImVxIiwiYWRkQ2xhc3MiLCJnZXQiLCJzZXQiLCJkaXJlY3Rpb24iLCJESVJFQ1RJT05fVkVSVElDQUwiLCJrZXl1cCIsImN1cnJlbnRJbm5lclN3aXBlckluZGV4Iiwib3V0ZXJTbGlkZXIiLCJpbm5lclNsaWRlciIsImlubmVyU2xpZGVyUHJldkJ0biIsImlubmVyU2xpZGVyTmV4dEJ0biIsIm91dGVyU2xpZGVyQ29udHJvbHMiLCJvdXRlclNsaWRlclByZXZCdG4iLCJvdXRlclNsaWRlck5leHRCdG4iLCJvdXRlclN3aXBlciIsIlN3aXBlciIsImluaXQiLCJsb29wIiwibG9vcGVkU2xpZGVzIiwic2xpZGVzUGVyVmlldyIsImNlbnRlcmVkU2xpZGVzIiwibm9ybWFsaXplU2xpZGVJbmRleCIsImFsbG93VG91Y2hNb3ZlIiwiZWZmZWN0IiwiY29udHJvbGxlciIsImJ5IiwiY29uc29sZSIsImxvZyIsImFjdGl2ZUluZGV4IiwidG91Y2giLCJvdXRlclN3aXBlclRyaWdnZXIiLCJvdXRlclN3aXBlckNvbnRyb2xzIiwic3BhY2VCZXR3ZWVuIiwidG91Y2hSYXRpbyIsInNsaWRlVG9DbGlja2VkU2xpZGUiLCJuYXZpZ2F0aW9uIiwibmV4dEVsIiwicHJldkVsIiwiYnJlYWtwb2ludHMiLCI3MDAiLCJjb250cm9sIiwibG9vcEFkZGl0aW9uYWxTbGlkZXMiLCJjb3ZlcmZsb3dFZmZlY3QiLCJyb3RhdGUiLCJzdHJldGNoIiwiZGVwdGgiLCJtb2RpZmllciIsInNsaWRlU2hhZG93cyIsImFkZCIsImN1cklubmVyU3dpcGVyQ29udCIsInNsaWRlcyIsImN1cklubmVyU3dpcGVyIiwic3dpcGVyIiwic2xpZGVQcmV2Iiwic2xpZGVOZXh0Iiwid2luZG93IiwidW5kZWZpbmVkIiwid29ya1NsaWRlciIsImZvY3Vzb3V0IiwidmFsIiwic2Nyb2xsVG8iLCJjbG9zZXN0IiwicGFyc2xleSIsInJlcXVpcmVkTWVzc2FnZSIsInR5cGVNZXNzYWdlIiwiZXJyb3JzQ29udGFpbmVyIiwiRmllbGQiLCJjbGFzc0hhbmRsZXIiLCJhbGVydCJdLCJtYXBwaW5ncyI6IkFBRUFBLEVBQUFDLFVBQUFDLE1BQUEsV0FFQSxJQUFBQyxFQUFBSCxFQUFBLFNBSUFJLEdBSEFKLEVBQUEsVUFHQSxHQUNBSyxFQUFBLEtBQ0FMLEVBQUFNLE1BQUFDLEdBQUEsNEJBQUEsU0FBQUMsR0FFQSxJQUFBUixFQUFBLGNBQUFTLFNBQUEsVUFBQSxDQUVBRCxFQUFBRSxpQkFFQSxJQUFBQyxFQUFBSCxFQUFBSSxjQUFBLFlBQUFKLEVBQUFJLGNBQUFDLFdBQUEsR0FBQUwsRUFBQUksY0FBQUUsT0FFQUgsRUFBQSxJQUFBUCxHQUNBQSxHQUFBLEVBQ0FXLGFBQUFWLEdBQ0FBLEVBQUFXLFdBQUEsV0FDQVosR0FBQSxHQUNBLEtBQ0FhLEVBQUEsSUFFQU4sR0FBQSxJQUFBUCxJQUNBQSxHQUFBLEVBQ0FXLGFBQUFW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d0UsUUFBQSwyQkFLQTFFLEVBQUEyRSxTQUNBQyxnQkFBQSwyQkFJQTNFLEVBQUEwRSxTQUNBRSxZQUFBLGlDQUdBM0UsRUFBQXlFLFNBQ0FDLGdCQUFBLDZEQUNBRSxnQkFBQSxTQUFBQyxHQUVBLE9BQUE1RSxHQUVBNkUsYUFBQSxTQUFBRCxHQUNBLE9BQUE1RSxLQU9BSCxFQUFBMkUsVUFBQW5HLEdBQUEsYUFBQSxXQUVBeUcsTUFBQSx1QkFFQXpHLEdBQUEsY0FBQSxTQUFBQyxHQVFBLE9BTkE4RCxRQUFBQyxJQUFBLG1CQU1BIiwiZmlsZSI6InNjcmlwdC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBAY29kZWtpdC1wcmVwZW5kIFwiL3ZlbmRvci9oYW1tZXItMi4wLjguanNcIjtcclxuXHJcbiQoIGRvY3VtZW50ICkucmVhZHkoZnVuY3Rpb24oKSB7XHJcblxyXG4gIHZhciB3b3JrID0gJCgnLndvcmsnKTtcclxuICB2YXIgaGlyZSA9ICQoJy5oaXJlJyk7XHJcblxyXG4gIC8vIERPTU1vdXNlU2Nyb2xsIGluY2x1ZGVkIGZvciBmaXJlZm94IHN1cHBvcnRcclxuICB2YXIgY2FuU2Nyb2xsID0gdHJ1ZSxcclxuICAgICAgc2Nyb2xsQ29udHJvbGxlciA9IG51bGw7XHJcbiAgJCh0aGlzKS5vbignbW91c2V3aGVlbCBET01Nb3VzZVNjcm9sbCcsIGZ1bmN0aW9uKGUpe1xyXG5cclxuICAgIGlmICghKCQoJy5vdXRlci1uYXYnKS5oYXNDbGFzcygnaXMtdmlzJykpKSB7XHJcblxyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgICB2YXIgZGVsdGEgPSAoZS5vcmlnaW5hbEV2ZW50LndoZWVsRGVsdGEpID8gLWUub3JpZ2luYWxFdmVudC53aGVlbERlbHRhIDogZS5vcmlnaW5hbEV2ZW50LmRldGFpbCAqIDIwO1xyXG5cclxuICAgICAgaWYgKGRlbHRhID4gNTAgJiYgY2FuU2Nyb2xsKSB7XHJcbiAgICAgICAgY2FuU2Nyb2xsID0gZmFsc2U7XHJcbiAgICAgICAgY2xlYXJUaW1lb3V0KHNjcm9sbENvbnRyb2xsZXIpO1xyXG4gICAgICAgIHNjcm9sbENvbnRyb2xsZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICBjYW5TY3JvbGwgPSB0cnVlO1xyXG4gICAgICAgIH0sIDgwMCk7XHJcbiAgICAgICAgdXBkYXRlSGVscGVyKDEpO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2UgaWYgKGRlbHRhIDwgLTUwICYmIGNhblNjcm9sbCkge1xyXG4gICAgICAgIGNhblNjcm9sbCA9IGZhbHNlO1xyXG4gICAgICAgIGNsZWFyVGltZW91dChzY3JvbGxDb250cm9sbGVyKTtcclxuICAgICAgICBzY3JvbGxDb250cm9sbGVyID0gc2V0VGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgY2FuU2Nyb2xsID0gdHJ1ZTtcclxuICAgICAgICB9LCA4MDApO1xyXG4gICAgICAgIHVwZGF0ZUhlbHBlcigtMSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gIH0pO1xyXG5cclxuICAkKCcuc2lkZS1uYXYgbGksIC5vdXRlci1uYXYgbGknKS5jbGljayhmdW5jdGlvbigpe1xyXG5cclxuICAgIGlmICghKCQodGhpcykuaGFzQ2xhc3MoJ2lzLWFjdGl2ZScpKSkge1xyXG5cclxuICAgICAgdmFyICR0aGlzID0gJCh0aGlzKSxcclxuICAgICAgICAgIGN1ckFjdGl2ZSA9ICR0aGlzLnBhcmVudCgpLmZpbmQoJy5pcy1hY3RpdmUnKSxcclxuICAgICAgICAgIGN1clBvcyA9ICR0aGlzLnBhcmVudCgpLmNoaWxkcmVuKCkuaW5kZXgoY3VyQWN0aXZlKSxcclxuICAgICAgICAgIG5leHRQb3MgPSAkdGhpcy5wYXJlbnQoKS5jaGlsZHJlbigpLmluZGV4KCR0aGlzKSxcclxuICAgICAgICAgIGxhc3RJdGVtID0gJCh0aGlzKS5wYXJlbnQoKS5jaGlsZHJlbigpLmxlbmd0aCAtIDE7XHJcblxyXG4gICAgICB1cGRhdGVOYXZzKG5leHRQb3MpO1xyXG4gICAgICB1cGRhdGVDb250ZW50KGN1clBvcywgbmV4dFBvcywgbGFzdEl0ZW0pO1xyXG5cclxuICAgIH1cclxuXHJcbiAgfSk7XHJcblxyXG4gICQoJy5jdGEnKS5jbGljayhmdW5jdGlvbigpe1xyXG5cclxuICAgIHZhciBjdXJBY3RpdmUgPSAkKCcuc2lkZS1uYXYnKS5maW5kKCcuaXMtYWN0aXZlJyksXHJcbiAgICAgICAgY3VyUG9zID0gJCgnLnNpZGUtbmF2JykuY2hpbGRyZW4oKS5pbmRleChjdXJBY3RpdmUpLFxyXG4gICAgICAgIGxhc3RJdGVtID0gJCgnLnNpZGUtbmF2JykuY2hpbGRyZW4oKS5sZW5ndGggLSAxLFxyXG4gICAgICAgIG5leHRQb3MgPSBsYXN0SXRlbTtcclxuXHJcbiAgICB1cGRhdGVOYXZzKGxhc3RJdGVtKTtcclxuICAgIHVwZGF0ZUNvbnRlbnQoY3VyUG9zLCBuZXh0UG9zLCBsYXN0SXRlbSk7XHJcblxyXG4gIH0pO1xyXG5cclxuICAvLyBzd2lwZSBzdXBwb3J0IGZvciB0b3VjaCBkZXZpY2VzXHJcbiAgdmFyIHRhcmdldEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndmlld3BvcnQnKSxcclxuICAgICAgbWMgPSBuZXcgSGFtbWVyKHRhcmdldEVsZW1lbnQpO1xyXG4gIG1jLmdldCgnc3dpcGUnKS5zZXQoeyBkaXJlY3Rpb246IEhhbW1lci5ESVJFQ1RJT05fVkVSVElDQUwgfSk7XHJcbiAgbWMub24oJ3N3aXBldXAgc3dpcGVkb3duJywgZnVuY3Rpb24oZSkge1xyXG5cclxuICAgIHVwZGF0ZUhlbHBlcihlKTtcclxuXHJcbiAgfSk7XHJcblxyXG4gICQoZG9jdW1lbnQpLmtleXVwKGZ1bmN0aW9uKGUpe1xyXG5cclxuICAgIGlmICghKCQoJy5vdXRlci1uYXYnKS5oYXNDbGFzcygnaXMtdmlzJykpKSB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdXBkYXRlSGVscGVyKGUpO1xyXG4gICAgfVxyXG5cclxuICB9KTtcclxuXHJcbiAgLy8gZGV0ZXJtaW5lIHNjcm9sbCwgc3dpcGUsIGFuZCBhcnJvdyBrZXkgZGlyZWN0aW9uXHJcbiAgZnVuY3Rpb24gdXBkYXRlSGVscGVyKHBhcmFtKSB7XHJcblxyXG4gICAgdmFyIGN1ckFjdGl2ZSA9ICQoJy5zaWRlLW5hdicpLmZpbmQoJy5pcy1hY3RpdmUnKSxcclxuICAgICAgICBjdXJQb3MgPSAkKCcuc2lkZS1uYXYnKS5jaGlsZHJlbigpLmluZGV4KGN1ckFjdGl2ZSksXHJcbiAgICAgICAgbGFzdEl0ZW0gPSAkKCcuc2lkZS1uYXYnKS5jaGlsZHJlbigpLmxlbmd0aCAtIDEsXHJcbiAgICAgICAgbmV4dFBvcyA9IDA7XHJcblxyXG4gICAgaWYgKHBhcmFtLnR5cGUgPT09IFwic3dpcGV1cFwiIHx8IHBhcmFtLmtleUNvZGUgPT09IDQwIHx8IHBhcmFtID4gMCkge1xyXG4gICAgICBpZiAoY3VyUG9zICE9PSBsYXN0SXRlbSkge1xyXG4gICAgICAgIG5leHRQb3MgPSBjdXJQb3MgKyAxO1xyXG4gICAgICAgIHVwZGF0ZU5hdnMobmV4dFBvcyk7XHJcbiAgICAgICAgdXBkYXRlQ29udGVudChjdXJQb3MsIG5leHRQb3MsIGxhc3RJdGVtKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICB1cGRhdGVOYXZzKG5leHRQb3MpO1xyXG4gICAgICAgIHVwZGF0ZUNvbnRlbnQoY3VyUG9zLCBuZXh0UG9zLCBsYXN0SXRlbSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2UgaWYgKHBhcmFtLnR5cGUgPT09IFwic3dpcGVkb3duXCIgfHwgcGFyYW0ua2V5Q29kZSA9PT0gMzggfHwgcGFyYW0gPCAwKXtcclxuICAgICAgaWYgKGN1clBvcyAhPT0gMCl7XHJcbiAgICAgICAgbmV4dFBvcyA9IGN1clBvcyAtIDE7XHJcbiAgICAgICAgdXBkYXRlTmF2cyhuZXh0UG9zKTtcclxuICAgICAgICB1cGRhdGVDb250ZW50KGN1clBvcywgbmV4dFBvcywgbGFzdEl0ZW0pO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgIG5leHRQb3MgPSBsYXN0SXRlbTtcclxuICAgICAgICB1cGRhdGVOYXZzKG5leHRQb3MpO1xyXG4gICAgICAgIHVwZGF0ZUNvbnRlbnQoY3VyUG9zLCBuZXh0UG9zLCBsYXN0SXRlbSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgfVxyXG5cclxuICAvLyBzeW5jIHNpZGUgYW5kIG91dGVyIG5hdmlnYXRpb25zXHJcbiAgZnVuY3Rpb24gdXBkYXRlTmF2cyhuZXh0UG9zKSB7XHJcblxyXG4gICAgJCgnLnNpZGUtbmF2LCAub3V0ZXItbmF2JykuY2hpbGRyZW4oKS5yZW1vdmVDbGFzcygnaXMtYWN0aXZlJyk7XHJcbiAgICAkKCcuc2lkZS1uYXYnKS5jaGlsZHJlbigpLmVxKG5leHRQb3MpLmFkZENsYXNzKCdpcy1hY3RpdmUnKTtcclxuICAgICQoJy5vdXRlci1uYXYnKS5jaGlsZHJlbigpLmVxKG5leHRQb3MpLmFkZENsYXNzKCdpcy1hY3RpdmUnKTtcclxuXHJcbiAgfVxyXG5cclxuICAvLyB1cGRhdGUgbWFpbiBjb250ZW50IGFyZWFcclxuICBmdW5jdGlvbiB1cGRhdGVDb250ZW50KGN1clBvcywgbmV4dFBvcywgbGFzdEl0ZW0pIHtcclxuXHJcbiAgICAkKCcubWFpbi1jb250ZW50JykuY2hpbGRyZW4oKS5yZW1vdmVDbGFzcygnc2VjdGlvbi0taXMtYWN0aXZlJyk7XHJcbiAgICAkKCcubWFpbi1jb250ZW50JykuY2hpbGRyZW4oKS5lcShuZXh0UG9zKS5hZGRDbGFzcygnc2VjdGlvbi0taXMtYWN0aXZlJyk7XHJcbiAgICAkKCcubWFpbi1jb250ZW50IC5zZWN0aW9uJykuY2hpbGRyZW4oKS5yZW1vdmVDbGFzcygnc2VjdGlvbi0tbmV4dCBzZWN0aW9uLS1wcmV2Jyk7XHJcblxyXG4gICAgaWYgKGN1clBvcyA9PT0gbGFzdEl0ZW0gJiYgbmV4dFBvcyA9PT0gMCB8fCBjdXJQb3MgPT09IDAgJiYgbmV4dFBvcyA9PT0gbGFzdEl0ZW0pIHtcclxuICAgICAgJCgnLm1haW4tY29udGVudCAuc2VjdGlvbicpLmNoaWxkcmVuKCkucmVtb3ZlQ2xhc3MoJ3NlY3Rpb24tLW5leHQgc2VjdGlvbi0tcHJldicpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoY3VyUG9zIDwgbmV4dFBvcykge1xyXG4gICAgICAkKCcubWFpbi1jb250ZW50JykuY2hpbGRyZW4oKS5lcShjdXJQb3MpLmNoaWxkcmVuKCkuYWRkQ2xhc3MoJ3NlY3Rpb24tLW5leHQnKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAkKCcubWFpbi1jb250ZW50JykuY2hpbGRyZW4oKS5lcShjdXJQb3MpLmNoaWxkcmVuKCkuYWRkQ2xhc3MoJ3NlY3Rpb24tLXByZXYnKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAobmV4dFBvcyAhPT0gMCAmJiBuZXh0UG9zICE9PSBsYXN0SXRlbSkge1xyXG4gICAgICAkKCcuaGVhZGVyLS1jdGEnKS5hZGRDbGFzcygnaXMtYWN0aXZlJyk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgJCgnLmhlYWRlci0tY3RhJykucmVtb3ZlQ2xhc3MoJ2lzLWFjdGl2ZScpO1xyXG4gICAgfVxyXG5cclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIG91dGVyTmF2KCkge1xyXG5cclxuICAgICQoJy5oZWFkZXItLW5hdi10b2dnbGUnKS5jbGljayhmdW5jdGlvbigpe1xyXG5cclxuICAgICAgJCgnLnBlcnNwZWN0aXZlJykuYWRkQ2xhc3MoJ3BlcnNwZWN0aXZlLS1tb2RhbHZpZXcnKTtcclxuICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgICQoJy5wZXJzcGVjdGl2ZScpLmFkZENsYXNzKCdlZmZlY3Qtcm90YXRlLWxlZnQtLWFuaW1hdGUnKTtcclxuICAgICAgfSwgMjUpO1xyXG4gICAgICAkKCcub3V0ZXItbmF2LCAub3V0ZXItbmF2IGxpLCAub3V0ZXItbmF2LS1yZXR1cm4nKS5hZGRDbGFzcygnaXMtdmlzJyk7XHJcblxyXG4gICAgfSk7XHJcblxyXG4gICAgJCgnLm91dGVyLW5hdi0tcmV0dXJuLCAub3V0ZXItbmF2IGxpJykuY2xpY2soZnVuY3Rpb24oKXtcclxuXHJcbiAgICAgICQoJy5wZXJzcGVjdGl2ZScpLnJlbW92ZUNsYXNzKCdlZmZlY3Qtcm90YXRlLWxlZnQtLWFuaW1hdGUnKTtcclxuICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgICQoJy5wZXJzcGVjdGl2ZScpLnJlbW92ZUNsYXNzKCdwZXJzcGVjdGl2ZS0tbW9kYWx2aWV3Jyk7XHJcbiAgICAgIH0sIDQwMCk7XHJcbiAgICAgICQoJy5vdXRlci1uYXYsIC5vdXRlci1uYXYgbGksIC5vdXRlci1uYXYtLXJldHVybicpLnJlbW92ZUNsYXNzKCdpcy12aXMnKTtcclxuXHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiB3b3JrU2xpZGVyKCkge1xyXG4gICAgdmFyIGFjdGl2ZUlubmVyU2xpZGVyO1xyXG5cclxuICAgIHZhciBvdXRlclNsaWRlciA9IHdvcmsuZmluZCgnLm91dGVyLXNsaWRlcicpO1xyXG4gICAgICAvKnZhciBvdXRlclNsaWRlclByZXZCdG4gPSBvdXRlclNsaWRlci5zaWJsaW5ncygnLnNsaWRlci0tcHJldicpO1xyXG4gICAgICB2YXIgb3V0ZXJTbGlkZXJOZXh0QnRuID0gb3V0ZXJTbGlkZXIuc2libGluZ3MoJy5zbGlkZXItLW5leHQnKTtcclxuICAgICAgKi9cclxuICAgIHZhciBpbm5lclNsaWRlciA9IHdvcmsuZmluZCgnLmlubmVyLXNsaWRlcicpO1xyXG5cclxuICAgIHZhciBpbm5lclNsaWRlclByZXZCdG4gPSB3b3JrLmZpbmQoJy5pbm5lci1zbGlkZXJfX25hdi0tcHJldicpO1xyXG4gICAgdmFyIGlubmVyU2xpZGVyTmV4dEJ0biA9IHdvcmsuZmluZCgnLmlubmVyLXNsaWRlcl9fbmF2LS1uZXh0Jyk7XHJcblxyXG4gICAgdmFyIG91dGVyU2xpZGVyQ29udHJvbHMgPSB3b3JrLmZpbmQoJy5vdXRlci1zbGlkZXJfX2NvbnRyb2xzJyk7XHJcblxyXG4gICAgdmFyIG91dGVyU2xpZGVyUHJldkJ0biA9IHdvcmsuZmluZCgnLm91dGVyLXNsaWRlcl9fbmF2LS1wcmV2Jyk7XHJcbiAgICB2YXIgb3V0ZXJTbGlkZXJOZXh0QnRuID0gd29yay5maW5kKCcub3V0ZXItc2xpZGVyX19uYXYtLW5leHQnKTtcclxuXHJcbiAgICBcclxuXHJcbiAgICAvLyBpbml0IHN3aXBlciBzbGlkZXIgZm9yIG91dGVyIHNsaWRlc1xyXG4gICAgdmFyIG91dGVyU3dpcGVyID0gbmV3IFN3aXBlciAob3V0ZXJTbGlkZXIsIHtcclxuICAgICAgaW5pdDogZmFsc2UsXHJcbiAgICAgIGxvb3A6IHRydWUsXHJcbiAgICAgIGxvb3BlZFNsaWRlczogNCxcclxuICAgICAgc2xpZGVzUGVyVmlldzogJ2F1dG8nLFxyXG4gICAgICBjZW50ZXJlZFNsaWRlczogdHJ1ZSxcclxuICAgICAgbm9ybWFsaXplU2xpZGVJbmRleDogdHJ1ZSxcclxuICAgICAgZGlyZWN0aW9uOiAndmVydGljYWwnLFxyXG4gICAgICBhbGxvd1RvdWNoTW92ZTogZmFsc2UsXHJcbiAgICAgIGVmZmVjdDogJ3NsaWRlJyxcclxuICAgICAgbm9ybWFsaXplU2xpZGVJbmRleDogdHJ1ZSxcclxuICAgICAgLypmYWRlRWZmZWN0OiB7XHJcbiAgICAgICAgY3Jvc3NGYWRlOiB0cnVlXHJcbiAgICAgIH0sKi9cclxuICAgICAgY29udHJvbGxlcjp7XHJcbiAgICAgICAgYnk6ICdzbGlkZSdcclxuICAgICAgfVxyXG4gICAgICAvKixcclxuICAgICAgaGFzaE5hdmlnYXRpb246IHRydWUsXHJcbiAgICAgIGhhc2hOYXZpZ2F0aW9uOiB7XHJcbiAgICAgICAgd2F0Y2hTdGF0ZTogdHJ1ZVxyXG4gICAgICB9Ki9cclxuICAgIH0pO1xyXG5cclxuXHJcbiAgICAvLyBkZXRlcm1pbmluZyBjdXJyZW50IGlubmVyIHN3aXBlciBpbmRleFxyXG4gICAgdmFyIGN1cnJlbnRJbm5lclN3aXBlckluZGV4O1xyXG4gICAgb3V0ZXJTd2lwZXIub24oJ2luaXQnLGZ1bmN0aW9uICgpIHtcclxuICAgICAgY29uc29sZS5sb2coJ3N3aXBlciBpbml0aWFsaXplZCcpO1xyXG4gICAgICBjdXJyZW50SW5uZXJTd2lwZXJJbmRleCA9IG91dGVyU3dpcGVyLmFjdGl2ZUluZGV4O1xyXG4gICAgICBjb25zb2xlLmxvZygnY3VycmVudElubmVyU3dpcGVySW5kZXg6ICcrIGN1cnJlbnRJbm5lclN3aXBlckluZGV4KTtcclxuICAgIH0pLFxyXG5cclxuICAgIG91dGVyU3dpcGVyLmluaXQoKTsgLy8gaW5pdCBvdXRlclN3aXBlclxyXG5cclxuICAgIHZhciBvdXRlclN3aXBlckNvbnRyb2xzID0gbmV3IFN3aXBlcihvdXRlclNsaWRlckNvbnRyb2xzLCB7XHJcbiAgICAgIGVmZmVjdDogJ3NsaWRlJyxcclxuICAgICAgbm9ybWFsaXplU2xpZGVJbmRleDogdHJ1ZSxcclxuICAgICAgZGlyZWN0aW9uOiAnaG9yaXpvbnRhbCcsXHJcbiAgICAgIGNlbnRlcmVkU2xpZGVzOiB0cnVlLFxyXG4gICAgICBsb29wOiB0cnVlLFxyXG4gICAgICBsb29wZWRTbGlkZXM6IDQsXHJcbiAgICAgIHNsaWRlc1BlclZpZXc6ICdhdXRvJyxcclxuICAgICAgc3BhY2VCZXR3ZWVuOiAzNSxcclxuICAgICAgdG91Y2hSYXRpbzogMC4yLFxyXG4gICAgICBzbGlkZVRvQ2xpY2tlZFNsaWRlOiB0cnVlLFxyXG4gICAgICBub3JtYWxpemVTbGlkZUluZGV4OiB0cnVlLFxyXG4gICAgICBuYXZpZ2F0aW9uOiB7XHJcbiAgICAgICAgbmV4dEVsOiBvdXRlclNsaWRlck5leHRCdG4sXHJcbiAgICAgICAgcHJldkVsOiBvdXRlclNsaWRlclByZXZCdG5cclxuICAgICAgfSxcclxuICAgICAgY29udHJvbGxlcjp7XHJcbiAgICAgICAgYnk6ICdzbGlkZSdcclxuICAgICAgfSxcclxuICAgICAgYnJlYWtwb2ludHM6e1xyXG4gICAgICAgIDcwMDp7XHJcbiAgICAgICAgICBzbGlkZXNQZXJWaWV3OiAnYXV0bycsXHJcbiAgICAgICAgICBzcGFjZUJldHdlZW46IDBcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgfVxyXG5cclxuICAgIH0pO1xyXG5cclxuXHJcbiAgICBvdXRlclN3aXBlckNvbnRyb2xzLmNvbnRyb2xsZXIuY29udHJvbCA9IG91dGVyU3dpcGVyO1xyXG4gICAgb3V0ZXJTd2lwZXIuY29udHJvbGxlci5jb250cm9sID0gb3V0ZXJTd2lwZXJDb250cm9scztcclxuXHJcblxyXG4gICAgLy8gaW5pdCBzd2lwZXIgc2xpZGVyIGZvciBvdXRlciBzbGlkZXNcclxuICAgIHZhciBpbm5lclN3aXBlciA9IG5ldyBTd2lwZXIgKGlubmVyU2xpZGVyLCB7XHJcbiAgICAgIFxyXG4gICAgICBkaXJlY3Rpb246ICdob3Jpem9udGFsJyxcclxuICAgICAgbG9vcDogdHJ1ZSxcclxuICAgICAgc3BhY2VCZXR3ZWVuOiAwLFxyXG4gICAgICAvLyBzbGlkZXNQZXJWaWV3OiAzLFxyXG4gICAgICBzbGlkZXNQZXJWaWV3OiAnYXV0bycsXHJcbiAgICAgIGxvb3BlZFNsaWRlczogNyxcclxuICAgICAgbG9vcEFkZGl0aW9uYWxTbGlkZXM6IDEwLFxyXG4gICAgICBjZW50ZXJlZFNsaWRlczogdHJ1ZSxcclxuICAgICAgc3BhY2VCZXR3ZWVuOiAwLFxyXG5cclxuICAgICAgZWZmZWN0OiAnY292ZXJmbG93JyxcclxuICAgICAgLy8gZ3JhYkN1cnNvcjogdHJ1ZSxcclxuICAgICAgY292ZXJmbG93RWZmZWN0OiB7XHJcbiAgICAgICAgcm90YXRlOiA0MCxcclxuICAgICAgICBzdHJldGNoOiAwLFxyXG4gICAgICAgIGRlcHRoOiAxMDAsXHJcbiAgICAgICAgbW9kaWZpZXI6IDEsXHJcbiAgICAgICAgc2xpZGVTaGFkb3dzIDogdHJ1ZVxyXG4gICAgICB9LFxyXG4gICAgICBub3JtYWxpemVTbGlkZUluZGV4OiB0cnVlLFxyXG4gICAgICBzbGlkZVRvQ2xpY2tlZFNsaWRlOiB0cnVlXHJcblxyXG4gICAgfSk7XHJcblxyXG5cclxuXHJcblxyXG4gICAgLy8gc3dpcGluZyBjdXJyZW50IGlubmVyU3dpcGVyIG9uIGNsaWNrc1xyXG4gICAgXHJcbiAgICB2YXIgc3BlZWQgPSA0MDA7XHJcbiAgICB2YXIgdG91Y2g7XHJcbiAgICBpbm5lclNsaWRlck5leHRCdG4uYWRkKGlubmVyU2xpZGVyUHJldkJ0bikub24oJ2NsaWNrIHRvdWNoc3RhcnQnLGZ1bmN0aW9uKGUpe1xyXG4gICAgICB2YXIgJHRoaXMgPSAkKHRoaXMpO1xyXG4gICAgICBcclxuICAgICAgaWYgKGUudHlwZT09J3RvdWNoc3RhcnQnKSB7XHJcbiAgICAgICAgdG91Y2ggPSB0cnVlO1xyXG5cclxuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICB0b3VjaCA9IGZhbHNlO1xyXG4gICAgICAgIH0sNDAwKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gcmV0dXJuIGlmIGNsaWNrIGZpcmVkIHdpdGhpbiA0MDAgbXMgYWZ0ZXIgdG91Y2hcclxuICAgICAgaWYgKHRvdWNoICYmIGUudHlwZT09J2NsaWNrJykge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuICAgICAgdmFyIGN1cklubmVyU3dpcGVyQ29udCA9IG91dGVyU3dpcGVyLnNsaWRlc1tjdXJyZW50SW5uZXJTd2lwZXJJbmRleF07XHJcbiAgICAgIHZhciBjdXJJbm5lclN3aXBlciA9ICQoY3VySW5uZXJTd2lwZXJDb250KS5maW5kKCcuaW5uZXItc2xpZGVyJylbMF07XHJcbiAgICAgIHZhciBjdXJTd2lwZXJJbnN0YW5jZSA9IGN1cklubmVyU3dpcGVyLnN3aXBlcjtcclxuXHJcbiAgICAgIGlmICgkdGhpcy5oYXNDbGFzcygnaW5uZXItc2xpZGVyX19wcmV2JykpIHtcclxuICAgICAgICAgIGN1cklubmVyU3dpcGVyLnN3aXBlci5zbGlkZVByZXYoNDAwKTtcclxuICAgICAgfWVsc2V7XHJcbiAgICAgICAgICBjdXJJbm5lclN3aXBlci5zd2lwZXIuc2xpZGVOZXh0KDQwMCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICB9KVxyXG5cclxuICAgIFxyXG5cclxuXHJcblxyXG5cclxuXHJcbiAgICAvLyBkZXRlY3Rpbmcgb3V0ZXJTd2lwZXIgdHJhbnNpdGlvbkVuZCB0byBjaGFuZ2UgY3VycmVudElubmVyU3dpcGVySW5kZXhcclxuXHJcbiAgICB2YXIgb3V0ZXJTd2lwZXJUcmlnZ2VyICwgaW1tRmlyZVRpbWVvdXQgPSAyMDA7XHJcbiAgICBvdXRlclN3aXBlci5vbigndHJhbnNpdGlvbkVuZCcsZnVuY3Rpb24oKXtcclxuICAgICAgLy8gc3RvcHBpbmcgaXQgdG8gZXhlY3V0ZSBtdWx0aXBsZSB0aW1lcyBjb25zZWN1dGl2ZWx5XHJcbiAgICAgIGlmIChvdXRlclN3aXBlclRyaWdnZXIpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1lbHNle1xyXG4gICAgICAgIG91dGVyU3dpcGVyVHJpZ2dlciA9IHRydWU7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnNvbGUubG9nKCdjaGFuZ2VkJyk7XHJcblxyXG4gICAgICBjdXJyZW50SW5uZXJTd2lwZXJJbmRleCA9IG91dGVyU3dpcGVyLmFjdGl2ZUluZGV4O1xyXG4gICAgICBjb25zb2xlLmxvZygnY3VycmVudElubmVyU3dpcGVySW5kZXg6ICcrIGN1cnJlbnRJbm5lclN3aXBlckluZGV4KTtcclxuXHJcblxyXG4gICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgIG91dGVyU3dpcGVyVHJpZ2dlciA9IHVuZGVmaW5lZDtcclxuICAgICAgfSxpbW1GaXJlVGltZW91dCk7IC8vIGFsbG93aW5nIHRoZSBjYWxsYmFjayB0byBydW4gYWZ0ZXIgYSBjZXJ0YWluIHRpbWVcclxuXHJcbiAgICB9KTtcclxuXHJcblxyXG5cclxuICB9IC8vIEVORCBvZiB3b3JrU2xpZGVyIEZ1bmNcclxuXHJcbiAgXHJcblxyXG4gIGZ1bmN0aW9uIHRyYW5zaXRpb25MYWJlbHMoKSB7XHJcblxyXG4gICAgJCgnLndvcmstcmVxdWVzdC0taW5mb3JtYXRpb24gaW5wdXQnKS5mb2N1c291dChmdW5jdGlvbigpe1xyXG5cclxuICAgICAgdmFyIHRleHRWYWwgPSAkKHRoaXMpLnZhbCgpO1xyXG5cclxuICAgICAgaWYgKHRleHRWYWwgPT09IFwiXCIpIHtcclxuICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKCdoYXMtdmFsdWUnKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAkKHRoaXMpLmFkZENsYXNzKCdoYXMtdmFsdWUnKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gY29ycmVjdCBtb2JpbGUgZGV2aWNlIHdpbmRvdyBwb3NpdGlvblxyXG4gICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgMCk7XHJcblxyXG4gICAgfSk7XHJcblxyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gc3RhcnRQcm9qZWN0Rm9ybSgpe1xyXG4gICAgICB2YXIgc3RhcnRQcm9qZWN0Rm9ybSA9ICQoJyNzdGFydFByb2plY3RGb3JtJyk7XHJcblxyXG4gICAgICB2YXIgbmFtZUZpZWxkID0gJCgnI25hbWVTUCcpO1xyXG4gICAgICB2YXIgZW1haWxGaWVsZCA9ICQoJyNlbWFpbFNQJyk7XHJcbiAgICAgIHZhciB3ZWJTZXJ2aWNlRmllbGQgPSAkKCcjc2VydmljZS13ZWInKTtcclxuICAgICAgdmFyIHNlcnZpY2VzQ29udCA9IHdlYlNlcnZpY2VGaWVsZC5jbG9zZXN0KCcud29yay1yZXF1ZXN0LS1zZXJ2aWNlcycpO1xyXG5cclxuXHJcbiAgICAgIC8vIGNoYW5nZSB2YWxpZGF0aW9uIG1lc3NhZ2VzIGFuZCBjdXN0b21pemUgb3B0aW9uc1xyXG5cclxuICAgICAgc3RhcnRQcm9qZWN0Rm9ybS5wYXJzbGV5KHtcclxuICAgICAgICByZXF1aXJlZE1lc3NhZ2U6ICdUaGlzIGZpZWxkIGlzIHJlcXVpcmVkJ1xyXG4gICAgICAgIFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGVtYWlsRmllbGQucGFyc2xleSh7XHJcbiAgICAgICAgdHlwZU1lc3NhZ2U6IFwiRW50ZXIgYSB2YWxpZCBlLW1haWwgYWRkcmVzc1wiXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgd2ViU2VydmljZUZpZWxkLnBhcnNsZXkoe1xyXG4gICAgICAgIHJlcXVpcmVkTWVzc2FnZTogXCJQbGVhc2Ugc2VsZWN0IHRoZSBkaWdpdGFsIHNlcnZpY2UvcyB5b3Ugd2FudCB1cyB0byB3b3JrIG9uXCIsIC8vIG9ubHkgd29ya3Mgd2hlbiB1c2luZyB0aGUgZmlyc3QgY2hlY2tib3ggaW4gdGhlIGdyb3VwXHJcbiAgICAgICAgZXJyb3JzQ29udGFpbmVyOiBmdW5jdGlvbiAoRmllbGQpIHtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgcmV0dXJuIHNlcnZpY2VzQ29udDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGNsYXNzSGFuZGxlcjogZnVuY3Rpb24gKEZpZWxkKSB7XHJcbiAgICAgICAgICByZXR1cm4gc2VydmljZXNDb250O1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcblxyXG5cclxuICAgICAgLy8gYWN0IHRvIHZhbGlkYXRpb24gZXJyb3JzIGFuZCBzdWNjZXNzIFxyXG5cclxuICAgICAgc3RhcnRQcm9qZWN0Rm9ybS5wYXJzbGV5KCkub24oJ2Zvcm06ZXJyb3InLGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgICAgICAgYWxlcnQoJ3ZhbGlkYXRpb24gZXJyb3JzJyk7ICBcclxuXHJcbiAgICAgIH0pLm9uKCdmb3JtOnN1Ym1pdCcsZnVuY3Rpb24oZSl7XHJcblxyXG4gICAgICAgICAgY29uc29sZS5sb2coJ0Zvcm0gU3VibWl0dGVkJyk7XHJcblxyXG4gICAgICAgICAgLy8gd3JpdGUgY29kZSBoZXJlIHRvIHN1Ym1pdCB0byBEQlxyXG5cclxuICAgICAgICAgIFxyXG5cclxuICAgICAgICAgIHJldHVybiBmYWxzZTsgIFxyXG4gICAgICB9KTtcclxuXHJcblxyXG5cclxuXHJcbiAgfVxyXG5cclxuICBvdXRlck5hdigpO1xyXG4gIHdvcmtTbGlkZXIoKTtcclxuICB0cmFuc2l0aW9uTGFiZWxzKCk7XHJcblxyXG4gIHN0YXJ0UHJvamVjdEZvcm0oKTtcclxuXHJcbn0pO1xyXG5cclxuXHJcblxyXG5cclxuXHJcbi8qIFxyXG5cclxuICQoJy5zbGlkZXItLXByZXYsIC5zbGlkZXItLW5leHQnKS5jbGljayhmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgIHZhciAkdGhpcyA9ICQodGhpcyksXHJcbiAgICAgICAgICBjdXJMZWZ0ID0gJCgnLnNsaWRlcicpLmZpbmQoJy5zbGlkZXItLWl0ZW0tbGVmdCcpLFxyXG4gICAgICAgICAgY3VyTGVmdFBvcyA9ICQoJy5zbGlkZXInKS5jaGlsZHJlbigpLmluZGV4KGN1ckxlZnQpLFxyXG4gICAgICAgICAgY3VyQ2VudGVyID0gJCgnLnNsaWRlcicpLmZpbmQoJy5zbGlkZXItLWl0ZW0tY2VudGVyJyksXHJcbiAgICAgICAgICBjdXJDZW50ZXJQb3MgPSAkKCcuc2xpZGVyJykuY2hpbGRyZW4oKS5pbmRleChjdXJDZW50ZXIpLFxyXG4gICAgICAgICAgY3VyUmlnaHQgPSAkKCcuc2xpZGVyJykuZmluZCgnLnNsaWRlci0taXRlbS1yaWdodCcpLFxyXG4gICAgICAgICAgY3VyUmlnaHRQb3MgPSAkKCcuc2xpZGVyJykuY2hpbGRyZW4oKS5pbmRleChjdXJSaWdodCksXHJcbiAgICAgICAgICB0b3RhbFdvcmtzID0gJCgnLnNsaWRlcicpLmNoaWxkcmVuKCkubGVuZ3RoLFxyXG4gICAgICAgICAgJGxlZnQgPSAkKCcuc2xpZGVyLS1pdGVtLWxlZnQnKSxcclxuICAgICAgICAgICRjZW50ZXIgPSAkKCcuc2xpZGVyLS1pdGVtLWNlbnRlcicpLFxyXG4gICAgICAgICAgJHJpZ2h0ID0gJCgnLnNsaWRlci0taXRlbS1yaWdodCcpLFxyXG4gICAgICAgICAgJGl0ZW0gPSAkKCcuc2xpZGVyLS1pdGVtJyk7XHJcblxyXG4gICAgICAkKCcuc2xpZGVyJykuYW5pbWF0ZSh7IG9wYWNpdHkgOiAwIH0sIDQwMCk7XHJcblxyXG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgICBpZiAoJHRoaXMuaGFzQ2xhc3MoJ3NsaWRlci0tbmV4dCcpKSB7XHJcbiAgICAgICAgaWYgKGN1ckxlZnRQb3MgPCB0b3RhbFdvcmtzIC0gMSAmJiBjdXJDZW50ZXJQb3MgPCB0b3RhbFdvcmtzIC0gMSAmJiBjdXJSaWdodFBvcyA8IHRvdGFsV29ya3MgLSAxKSB7XHJcbiAgICAgICAgICAkbGVmdC5yZW1vdmVDbGFzcygnc2xpZGVyLS1pdGVtLWxlZnQnKS5uZXh0KCkuYWRkQ2xhc3MoJ3NsaWRlci0taXRlbS1sZWZ0Jyk7XHJcbiAgICAgICAgICAkY2VudGVyLnJlbW92ZUNsYXNzKCdzbGlkZXItLWl0ZW0tY2VudGVyJykubmV4dCgpLmFkZENsYXNzKCdzbGlkZXItLWl0ZW0tY2VudGVyJyk7XHJcbiAgICAgICAgICAkcmlnaHQucmVtb3ZlQ2xhc3MoJ3NsaWRlci0taXRlbS1yaWdodCcpLm5leHQoKS5hZGRDbGFzcygnc2xpZGVyLS1pdGVtLXJpZ2h0Jyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgaWYgKGN1ckxlZnRQb3MgPT09IHRvdGFsV29ya3MgLSAxKSB7XHJcbiAgICAgICAgICAgICRpdGVtLnJlbW92ZUNsYXNzKCdzbGlkZXItLWl0ZW0tbGVmdCcpLmZpcnN0KCkuYWRkQ2xhc3MoJ3NsaWRlci0taXRlbS1sZWZ0Jyk7XHJcbiAgICAgICAgICAgICRjZW50ZXIucmVtb3ZlQ2xhc3MoJ3NsaWRlci0taXRlbS1jZW50ZXInKS5uZXh0KCkuYWRkQ2xhc3MoJ3NsaWRlci0taXRlbS1jZW50ZXInKTtcclxuICAgICAgICAgICAgJHJpZ2h0LnJlbW92ZUNsYXNzKCdzbGlkZXItLWl0ZW0tcmlnaHQnKS5uZXh0KCkuYWRkQ2xhc3MoJ3NsaWRlci0taXRlbS1yaWdodCcpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgZWxzZSBpZiAoY3VyQ2VudGVyUG9zID09PSB0b3RhbFdvcmtzIC0gMSkge1xyXG4gICAgICAgICAgICAkbGVmdC5yZW1vdmVDbGFzcygnc2xpZGVyLS1pdGVtLWxlZnQnKS5uZXh0KCkuYWRkQ2xhc3MoJ3NsaWRlci0taXRlbS1sZWZ0Jyk7XHJcbiAgICAgICAgICAgICRpdGVtLnJlbW92ZUNsYXNzKCdzbGlkZXItLWl0ZW0tY2VudGVyJykuZmlyc3QoKS5hZGRDbGFzcygnc2xpZGVyLS1pdGVtLWNlbnRlcicpO1xyXG4gICAgICAgICAgICAkcmlnaHQucmVtb3ZlQ2xhc3MoJ3NsaWRlci0taXRlbS1yaWdodCcpLm5leHQoKS5hZGRDbGFzcygnc2xpZGVyLS1pdGVtLXJpZ2h0Jyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgJGxlZnQucmVtb3ZlQ2xhc3MoJ3NsaWRlci0taXRlbS1sZWZ0JykubmV4dCgpLmFkZENsYXNzKCdzbGlkZXItLWl0ZW0tbGVmdCcpO1xyXG4gICAgICAgICAgICAkY2VudGVyLnJlbW92ZUNsYXNzKCdzbGlkZXItLWl0ZW0tY2VudGVyJykubmV4dCgpLmFkZENsYXNzKCdzbGlkZXItLWl0ZW0tY2VudGVyJyk7XHJcbiAgICAgICAgICAgICRpdGVtLnJlbW92ZUNsYXNzKCdzbGlkZXItLWl0ZW0tcmlnaHQnKS5maXJzdCgpLmFkZENsYXNzKCdzbGlkZXItLWl0ZW0tcmlnaHQnKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgaWYgKGN1ckxlZnRQb3MgIT09IDAgJiYgY3VyQ2VudGVyUG9zICE9PSAwICYmIGN1clJpZ2h0UG9zICE9PSAwKSB7XHJcbiAgICAgICAgICAkbGVmdC5yZW1vdmVDbGFzcygnc2xpZGVyLS1pdGVtLWxlZnQnKS5wcmV2KCkuYWRkQ2xhc3MoJ3NsaWRlci0taXRlbS1sZWZ0Jyk7XHJcbiAgICAgICAgICAkY2VudGVyLnJlbW92ZUNsYXNzKCdzbGlkZXItLWl0ZW0tY2VudGVyJykucHJldigpLmFkZENsYXNzKCdzbGlkZXItLWl0ZW0tY2VudGVyJyk7XHJcbiAgICAgICAgICAkcmlnaHQucmVtb3ZlQ2xhc3MoJ3NsaWRlci0taXRlbS1yaWdodCcpLnByZXYoKS5hZGRDbGFzcygnc2xpZGVyLS1pdGVtLXJpZ2h0Jyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgaWYgKGN1ckxlZnRQb3MgPT09IDApIHtcclxuICAgICAgICAgICAgJGl0ZW0ucmVtb3ZlQ2xhc3MoJ3NsaWRlci0taXRlbS1sZWZ0JykubGFzdCgpLmFkZENsYXNzKCdzbGlkZXItLWl0ZW0tbGVmdCcpO1xyXG4gICAgICAgICAgICAkY2VudGVyLnJlbW92ZUNsYXNzKCdzbGlkZXItLWl0ZW0tY2VudGVyJykucHJldigpLmFkZENsYXNzKCdzbGlkZXItLWl0ZW0tY2VudGVyJyk7XHJcbiAgICAgICAgICAgICRyaWdodC5yZW1vdmVDbGFzcygnc2xpZGVyLS1pdGVtLXJpZ2h0JykucHJldigpLmFkZENsYXNzKCdzbGlkZXItLWl0ZW0tcmlnaHQnKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGVsc2UgaWYgKGN1ckNlbnRlclBvcyA9PT0gMCkge1xyXG4gICAgICAgICAgICAkbGVmdC5yZW1vdmVDbGFzcygnc2xpZGVyLS1pdGVtLWxlZnQnKS5wcmV2KCkuYWRkQ2xhc3MoJ3NsaWRlci0taXRlbS1sZWZ0Jyk7XHJcbiAgICAgICAgICAgICRpdGVtLnJlbW92ZUNsYXNzKCdzbGlkZXItLWl0ZW0tY2VudGVyJykubGFzdCgpLmFkZENsYXNzKCdzbGlkZXItLWl0ZW0tY2VudGVyJyk7XHJcbiAgICAgICAgICAgICRyaWdodC5yZW1vdmVDbGFzcygnc2xpZGVyLS1pdGVtLXJpZ2h0JykucHJldigpLmFkZENsYXNzKCdzbGlkZXItLWl0ZW0tcmlnaHQnKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAkbGVmdC5yZW1vdmVDbGFzcygnc2xpZGVyLS1pdGVtLWxlZnQnKS5wcmV2KCkuYWRkQ2xhc3MoJ3NsaWRlci0taXRlbS1sZWZ0Jyk7XHJcbiAgICAgICAgICAgICRjZW50ZXIucmVtb3ZlQ2xhc3MoJ3NsaWRlci0taXRlbS1jZW50ZXInKS5wcmV2KCkuYWRkQ2xhc3MoJ3NsaWRlci0taXRlbS1jZW50ZXInKTtcclxuICAgICAgICAgICAgJGl0ZW0ucmVtb3ZlQ2xhc3MoJ3NsaWRlci0taXRlbS1yaWdodCcpLmxhc3QoKS5hZGRDbGFzcygnc2xpZGVyLS1pdGVtLXJpZ2h0Jyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgfSwgNDAwKTtcclxuXHJcbiAgICAkKCcuc2xpZGVyJykuYW5pbWF0ZSh7IG9wYWNpdHkgOiAxIH0sIDQwMCk7XHJcblxyXG4gICAgfSk7XHJcblxyXG5cclxuXHJcbiovIl19
